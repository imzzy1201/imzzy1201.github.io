{"posts":[{"title":"20200715 æ ¡å†…æµ‹è¯•è®¢æ­£","content":" Some people seem to have everything. In fact, they do have everything. 1. æ¦‚å†µ T1 53pt æˆ‘ sb äº†ã€‚ T2 44pt æˆ‘ sb äº†ã€‚ T3 0pt å®Œå…¨ä¸ä¼šã€‚ğŸ™ƒ æ€»åˆ†è¿ä¸‰ä½æ•°éƒ½æ²¡æœ‰ï¼Œsb å®é”¤ã€‚ 2. é¢˜è§£ æµ‹è¯•èµ„æºé“¾æ¥ï¼ˆæ ¡å†…é¢˜åº“ï¼Œä¸å…¬å¼€å¯†ç ï¼‰ T1 ç®€å•æ£‹ç›˜é—®é¢˜ é¢˜é¢ï¼ˆæš‚æ— ï¼‰ æ€è·¯ è€ƒè™‘åˆ°å…¶ç›¸å½“äºæ±‚æ‰€æœ‰å›½ç‹åˆ°ç›®æ ‡ä½ç½®çš„åˆ‡æ¯”é›ªå¤«è·ç¦»ï¼Œè€Œæˆ‘ä»¬çŸ¥é“åˆ‡æ¯”é›ªå¤«è·ç¦»æ˜¯å¯ä»¥è½¬åŒ–ä¸ºæ›¼å“ˆé¡¿è·ç¦»çš„ã€‚ ä¸¾ä¸ªä¾‹å­ä¸‹é¢åæ ‡ç³»ä¸­æœ‰ A,BA,BA,B ä¸¤ç‚¹ï¼š é‚£ä¹ˆä»–ä»¬çš„åˆ‡æ¯”é›ªå¤«è·ç¦»å°±æ˜¯ maxâ¡(âˆ£xAâˆ’xBâˆ£,âˆ£yAâˆ’yBâˆ£)=maxâ¡(âˆ£1âˆ’5âˆ£,âˆ£4âˆ’2âˆ£)=4\\max(|x_A-x_B|,|y_A-y_B|)=\\max(|1-5|,|4-2|)=4max(âˆ£xAâ€‹âˆ’xBâ€‹âˆ£,âˆ£yAâ€‹âˆ’yBâ€‹âˆ£)=max(âˆ£1âˆ’5âˆ£,âˆ£4âˆ’2âˆ£)=4ï¼ˆå³çº¢æ©™ä¸¤æ®µä¸­è¾ƒé•¿çš„æ©™çº¿æ®µçš„é•¿åº¦ï¼‰ å®ƒä»¬çš„æ›¼å“ˆé¡¿è·ç¦»åˆ™ä¸º âˆ£xAâˆ’xBâˆ£+âˆ£yAâˆ’yBâˆ£=âˆ£1âˆ’5âˆ£+âˆ£4âˆ’2âˆ£=6|x_A-x_B|+|y_A-y_B|=|1-5|+|4-2|=6âˆ£xAâ€‹âˆ’xBâ€‹âˆ£+âˆ£yAâ€‹âˆ’yBâ€‹âˆ£=âˆ£1âˆ’5âˆ£+âˆ£4âˆ’2âˆ£=6ï¼ˆå³çº¢æ©™ä¸¤çº¿æ®µé•¿åº¦å’Œ è¿™ä¸¤ç§è·ç¦»çœ‹èµ·æ¥æ²¡å•¥å…³ç³»ï¼Œå…¶å®å´æœ‰å¾ˆå¤§çš„è”ç³»ã€‚ è€ƒè™‘æ—‹è½¬åæ ‡è½´ï¼Œé€†æ—¶é’ˆé¥¶åŸç‚¹æ—‹è½¬ 45Â°ï¼Œä¹Ÿå°±æ˜¯è½¬åˆ°äº†è¿™é‡Œï¼š åœ¨æ–°çš„åæ ‡è½´ä¸Šæˆ‘ä»¬å¯¹ä¸¤ç‚¹æ±‚æ›¼å“ˆé¡¿è·ç¦»ï¼ˆå³ç´«è‰²æŠ˜çº¿çš„æ€»çš„é•¿åº¦ï¼‰ æˆ‘ä»¬å‘ç°æ­¤æ—¶çš„æ›¼å“ˆé¡¿è·ç¦» 424\\sqrt{2}42â€‹ æ­£å¥½æ˜¯åŸæ¥çš„åˆ‡æ¯”é›ªå¤«è·ç¦» 444 çš„ 2\\sqrt{2}2â€‹ å€ã€‚ å¤šè¯•å‡ ä¸ªç‚¹å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªç»“è®ºæ˜¯æ’æˆç«‹çš„ã€‚è¿™ä¸ªç»“è®ºä¹Ÿä¸éš¾è¯æ˜ï¼Œå¸¦å…¥åæ ‡æ¨å¼å­å³å¯è¯´æ˜æ­£ç¡®æ€§ã€‚ä¸‹é¢ä¸»è¦è¯´çš„æ˜¯å®ç°æ–¹æ³•ã€‚ å®ç°çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥å°†æ‰€æœ‰ç‚¹ï¼ˆåŒ…æ‹¬è¯¢é—®çš„ç‚¹ï¼‰çš„åæ ‡ (x,y)(x,y)(x,y) æ”¹æˆ (x+y,xâˆ’y)(x+y,x-y)(x+y,xâˆ’y)ï¼Œç„¶åæ±‚æ›¼å“ˆé¡¿è·ç¦»å’Œå³å¯ã€‚æ³¨æ„æœ€ç»ˆç­”æ¡ˆæ˜¯è¿™ä¸ªè·ç¦»å’Œçš„ä¸€åŠã€‚ å…³äºæ±‚æ³•çš„è¯ï¼Œå¯ä»¥ç¦»æ•£åŒ–åç”¨æ ‘çŠ¶æ•°ç»„å¯¹æ¨ªçºµåæ ‡å„ç»´æŠ¤ä¸¤ä¸ªå€¼ï¼šåŒºé—´å†…çš„ç‚¹æ•°å’ŒåŒºé—´åæ ‡å’Œã€‚ç»Ÿè®¡ç­”æ¡ˆæ—¶åˆ†åˆ«æ±‚å¤§äºå’Œå°äºå½“å‰è¯¢é—®åæ ‡çš„ç­”æ¡ˆå³å¯ã€‚ä»£ç åº”è¯¥å¾ˆå¥½æ‡‚ï¼š Code #include&lt;bits/stdc++.h&gt; #define rgi register int #define ll long long class fastin{ private: int _ch,_f; public: inline fastin&amp; operator&gt;&gt;(char&amp;c) {c=getchar(); return *this;} template&lt;typename _Tp&gt; inline fastin&amp; operator&gt;&gt;(_Tp&amp;_x){ _x=0; while(!isdigit(_ch)) _f|=(_ch==45),_ch=getchar(); while(isdigit(_ch)) _x=(_x&lt;&lt;1)+(_x&lt;&lt;3)+(_ch^48),_ch=getchar(); _f&amp;&amp;(_x=-_x,_f=0); return *this;} fastin() {_ch=_f=0;} }fin; class fastout{ #define endl '\\n' private: int _num[32],_head; public: inline fastout&amp; operator&lt;&lt;(char c) {putchar(c); return *this;} template&lt;typename _Tp&gt; inline fastout&amp; operator&lt;&lt;(_Tp _x){ _Tp _k; if(_x==0) {putchar('0'); return *this;} if(_x&lt;0) putchar('-'),_x=-_x; while(_x&gt;0) _k=_x/10,++_head,_num[_head]=(_x-(_k&lt;&lt;1)-(_k&lt;&lt;3))^48,_x=_k; while(_head&gt;0) putchar(_num[_head]),--_head; return *this;} fastout() {_head=0;} }fout; // ---------------------------- // #define int ll // using namespace std; const int maxn=1000004; const int mod=998244353,inf=1000000007; struct POINT{int x,y;}p[maxn]; int val0[maxn],cnt0,val1[maxn],cnt1; // ç¦»æ•£åŒ–ç”¨çš„æ•°ç»„ class BIT{ // æ ‘çŠ¶æ•°ç»„ private: ll size,val[maxn]; public: inline int lowbit(int x) {return x&amp;-x;} inline void update(int p,ll x) {while(p&lt;=size) val[p]+=x,p+=lowbit(p);} inline ll query(int p) {ll res=0; while(p&gt;0) res+=val[p],p-=lowbit(p); return res;} inline ll query(int l,int r) {return query(r)-query(l-1);} inline void build(int s) {size=s; memset(val,0,sizeof(ll)*(size+2));} }B[2],C[2]; // B è®°å½•åæ ‡å’Œï¼ŒC ç‚¹çš„ä¸ªæ•° // ä¸Šé¢é‚£äº›å˜é‡ 0 æŒ‡æ¨ªåæ ‡ï¼Œ1 æŒ‡çºµåæ ‡ signed main() { // freopen(&quot;chess.in&quot;,&quot;r&quot;,stdin); // freopen(&quot;chess.out&quot;,&quot;w&quot;,stdout); int n,x,y,qx,qy; ll ans=0; rgi T,q; fin&gt;&gt;T; while(T--) { cnt0=cnt1=0,fin&gt;&gt;n&gt;&gt;q; for(rgi i=1;i&lt;=n;++i) fin&gt;&gt;p[i].x&gt;&gt;p[i].y,val0[++cnt0]=p[i].x+p[i].y,val1[++cnt1]=p[i].x-p[i].y; std::sort(val0+1,val0+1+cnt0),cnt0=std::unique(val0+1,val0+1+cnt0)-val0-1; std::sort(val1+1,val1+1+cnt1),cnt1=std::unique(val1+1,val1+1+cnt1)-val1-1; B[0].build(cnt0),C[0].build(cnt0); B[1].build(cnt1),C[1].build(cnt1); // ä¸Šä¸ºç¦»æ•£åŒ– for(rgi i=1,t3,t4;i&lt;=n;++i) { t3=std::lower_bound(val0+1,val0+1+cnt0,p[i].x+p[i].y)-val0; t4=std::lower_bound(val1+1,val1+1+cnt1,p[i].x-p[i].y)-val1; B[0].update(t3,p[i].x+p[i].y),C[0].update(t3,1); B[1].update(t4,p[i].x-p[i].y),C[1].update(t4,1); } // æ’å…¥æ ‘çŠ¶æ•°ç»„ while(q--) { fin&gt;&gt;x&gt;&gt;y,ans=0; qx=std::lower_bound(val0+1,val0+1+cnt0,x+y)-val0; qy=std::lower_bound(val1+1,val1+1+cnt1,x-y)-val1; ans+=C[0].query(qx-1)*(x+y)-B[0].query(qx-1); ans+=B[0].query(qx,cnt0)-C[0].query(qx,cnt0)*(x+y); // ç»Ÿè®¡æ¨ªåæ ‡ ans+=C[1].query(qy-1)*(x-y)-B[1].query(qy-1); ans+=B[1].query(qy,cnt1)-C[1].query(qy,cnt1)*(x-y); // ç»Ÿè®¡çºµåæ ‡ fout&lt;&lt;ans/2&lt;&lt;endl; } } return 0; } // ---------------------------- // by imzzy T2 ç®€å•æ•°æ®ç»“æ„ é¢˜é¢ï¼ˆæš‚æ— ï¼‰ æ€è·¯ èœåˆ°è¿çº¿æ®µæ ‘éƒ½å†™æŒ‚ï¼ˆé›¾ è€ƒè™‘ç”¨çº¿æ®µæ ‘æš´åŠ›ç»´æŠ¤åŒºé—´æœ€å°å€¼ï¼Œç„¶åæŸ¥è¯¢çš„æ—¶å€™æ¯æ¬¡å–å‡ºåŒºé—´é‡Œçš„æœ€å°å€¼ï¼Œæ”¾å…¥ç­”æ¡ˆé˜Ÿåˆ—ï¼Œç„¶ååˆ æ‰è¿™ä¸ªä½ç½®çš„å€¼ï¼ˆå³èµ‹å€¼ä¸º infâ¡\\infinfï¼‰å¦‚æœå–åˆ°æŸä¸ªæ—¶å€™å‘ç°å–å‡ºæ¥çš„æ•°æ¯” xxx è¿˜å¤§äº†å°±è¯´æ˜æ­¤æ¬¡è¯¢é—®æ— è§£ã€‚ å¤æ‚åº¦åº”è¯¥æ˜¯ [m+âˆ‘K]logâ¡n[m+\\sum K]\\log n[m+âˆ‘K]lognï¼Œå¤§æ¦‚æ˜¯ 10810^8108 çº§åˆ«çš„ï¼Œå¡å¡å¸¸å°±èƒ½è¿‡ã€‚ ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæˆ‘ä¸€å…±è¿‡äº†ä¸¤ä¸ªæµ‹è¯•ç‚¹ï¼Œå…¶ä¸­ä¸€ä¸ªå°±æ˜¯å¤§æ ·ä¾‹ï¼ˆé›¾ Code #include&lt;bits/stdc++.h&gt; #define rgi register int #define ll long long class fastin{ private: int _ch,_f; public: inline fastin&amp; operator&gt;&gt;(char&amp;c) {c=getchar(); return *this;} template&lt;typename _Tp&gt; inline fastin&amp; operator&gt;&gt;(_Tp&amp;_x){ _x=0; while(!isdigit(_ch)) _f|=(_ch==45),_ch=getchar(); while(isdigit(_ch)) _x=(_x&lt;&lt;1)+(_x&lt;&lt;3)+(_ch^48),_ch=getchar(); _f&amp;&amp;(_x=-_x,_f=0); return *this;} fastin() {_ch=_f=0;} }fin; class fastout{ #define endl '\\n' private: int _num[32],_head; public: inline fastout&amp; operator&lt;&lt;(char c) {putchar(c); return *this;} template&lt;typename _Tp&gt; inline fastout&amp; operator&lt;&lt;(_Tp _x){ _Tp _k; if(_x==0) {putchar('0'); return *this;} if(_x&lt;0) putchar('-'),_x=-_x; while(_x&gt;0) _k=_x/10,++_head,_num[_head]=(_x-(_k&lt;&lt;1)-(_k&lt;&lt;3))^48,_x=_k; while(_head&gt;0) putchar(_num[_head]),--_head; return *this;} fastout() {_head=0;} }fout; // ---------------------------- // #define int ll using namespace std; const int maxn=500004; const int mod=998244353,inf=2000000007; class segment_tree{ #define mid ((l+r)&gt;&gt;1) private: int size,ql,qr,qv,*A,fill[maxn&lt;&lt;2],cnt; // fill æ‰“çš„æ˜¯å– max æ ‡è®° pair&lt;int,int&gt; minv[maxn&lt;&lt;2],changed[maxn]; // first ç»´æŠ¤æœ€å°å€¼ï¼Œsecond ç»´æŠ¤æœ€å°å€¼å¯¹åº”çš„ä¸‹æ ‡ inline void pushup(int p) {minv[p]=min(minv[p&lt;&lt;1],minv[p&lt;&lt;1|1]);} inline void pushdown(int p,int l,int r) { if(!fill[p]) return; fill[p&lt;&lt;1]=max(fill[p],fill[p&lt;&lt;1]),fill[p&lt;&lt;1|1]=max(fill[p],fill[p&lt;&lt;1|1]); minv[p&lt;&lt;1]=max(minv[p&lt;&lt;1],make_pair(fill[p],minv[p&lt;&lt;1].second)); minv[p&lt;&lt;1|1]=max(minv[p&lt;&lt;1|1],make_pair(fill[p],minv[p&lt;&lt;1|1].second)); fill[p]=0; } void build(int p,int l,int r) { fill[p]=0; if(l==r) return minv[p]=make_pair(A[l],l),void(); build(p&lt;&lt;1,l,mid),build(p&lt;&lt;1|1,mid+1,r),pushup(p); } void modify(int p,int l,int r) { // ä¿®æ”¹å•ç‚¹çš„å€¼ if(l==r) return fill[p]=qv,minv[p]=make_pair(qv,l),void(); pushdown(p,l,r); if(ql&lt;=mid) modify(p&lt;&lt;1,l,mid); else modify(p&lt;&lt;1|1,mid+1,r); pushup(p); } void update_(int p,int l,int r) { // åŒºé—´å– max if(l&gt;=ql&amp;&amp;r&lt;=qr) return minv[p]=max(minv[p],make_pair(qv,minv[p].second)),fill[p]=max(fill[p],qv),void(); pushdown(p,l,r); if(ql&lt;=mid) update_(p&lt;&lt;1,l,mid); if(qr&gt;mid) update_(p&lt;&lt;1|1,mid+1,r); pushup(p); } pair&lt;int,int&gt; query(int p,int l,int r) { // æŸ¥è¯¢åŒºé—´æœ€å°å€¼ if(l&gt;=ql&amp;&amp;r&lt;=qr) return minv[p]; pushdown(p,l,r); if(qr&lt;=mid) return query(p&lt;&lt;1,l,mid); if(ql&gt;mid) return query(p&lt;&lt;1|1,mid+1,r); return min(query(p&lt;&lt;1,l,mid),query(p&lt;&lt;1|1,mid+1,r)); } public: inline void build(int siz,int *k) {A=k,size=siz,cnt=0,build(1,1,size);} inline void update(int l,int r,int v) {ql=l,qr=r,qv=v,update_(1,1,size);} inline bool query(int l,int r,int x,int k,int *ans) { bool flag=1; for(rgi i=1;i&lt;=k&amp;&amp;flag;++i) { ql=l,qr=r,changed[++cnt]=query(1,1,size); // æ”¹æˆ inf æ—¶è¦åŠ å…¥é˜Ÿåˆ—å› ä¸ºæœ€åè¦è¿˜åŸçš„ ql=changed[cnt].second,qv=inf,modify(1,1,size); if(changed[cnt].first&lt;x) ans[i]=changed[cnt].first; else flag=0; } while(cnt) ql=changed[cnt].second,qv=changed[cnt--].first,modify(1,1,size); return flag; } #undef mid }sgt; int a[maxn]; signed main() { // freopen(&quot;segtree.in&quot;,&quot;r&quot;,stdin); // freopen(&quot;segtree.out&quot;,&quot;w&quot;,stdout); int n,m,op,l,r,x,k; fin&gt;&gt;n; for(rgi i=1;i&lt;=n;++i) fin&gt;&gt;a[i]; sgt.build(n,a); for(fin&gt;&gt;m;m;--m) { fin&gt;&gt;op; if(op==1) fin&gt;&gt;l&gt;&gt;r&gt;&gt;x,sgt.update(l,r,x); else{ fin&gt;&gt;l&gt;&gt;r&gt;&gt;x&gt;&gt;k,op=sgt.query(l,r,x,k,a); if(op) {for(rgi i=1;i&lt;=k;++i) fout&lt;&lt;a[i]&lt;&lt;' '; fout&lt;&lt;endl;} else fout&lt;&lt;-1&lt;&lt;endl; } } return 0; } // ---------------------------- // by imzzy T3 ç®€å•æ ‘ä¸Šè·¯å¾„ é¢˜é¢ï¼ˆæš‚æ— ï¼‰ æ€è·¯ ç¥ä»™é¢˜ å’•äº†æ˜å¤©è¡¥å®Œæ€è·¯ Code #include&lt;bits/stdc++.h&gt; #define rgi register int #define ll long long class fastin{ private: int _ch,_f; public: inline fastin&amp; operator&gt;&gt;(char&amp;c) {c=getchar(); return *this;} template&lt;typename _Tp&gt; inline fastin&amp; operator&gt;&gt;(_Tp&amp;_x){ _x=0; while(!isdigit(_ch)) _f|=(_ch==45),_ch=getchar(); while(isdigit(_ch)) _x=(_x&lt;&lt;1)+(_x&lt;&lt;3)+(_ch^48),_ch=getchar(); _f&amp;&amp;(_x=-_x,_f=0); return *this;} fastin() {_ch=_f=0;} }fin; class fastout{ #define endl '\\n' private: int _num[32],_head; public: inline fastout&amp; operator&lt;&lt;(char c) {putchar(c); return *this;} template&lt;typename _Tp&gt; inline fastout&amp; operator&lt;&lt;(_Tp _x){ _Tp _k; if(_x==0) {putchar('0'); return *this;} if(_x&lt;0) putchar('-'),_x=-_x; while(_x&gt;0) _k=_x/10,++_head,_num[_head]=(_x-(_k&lt;&lt;1)-(_k&lt;&lt;3))^48,_x=_k; while(_head&gt;0) putchar(_num[_head]),--_head; return *this;} fastout() {_head=0;} }fout; // ---------------------------- // #define int ll // using namespace std; const int maxn=300004,maxq=50004,maxm=1004; const int mod=998244353,inf=1000000007; int anc[20][maxn],dep[maxn],c[maxq],v[6][maxq]; std::bitset&lt;maxm&gt; f[maxn],g[maxn],p[6][maxq],tmp; inline int LCA(int p,int q) { if(dep[p]&lt;dep[q]) std::swap(p,q); for(rgi i=19;i&gt;=0;--i) if(dep[q]&lt;=dep[p]-(1&lt;&lt;i)) p=anc[i][p]; if(p==q) return p; for(rgi i=19;i&gt;=0;--i) if(anc[i][p]!=anc[i][q]) p=anc[i][p],q=anc[i][q]; return anc[0][p]; } signed main() { // freopen(&quot;travel.in&quot;,&quot;r&quot;,stdin); // freopen(&quot;travel.out&quot;,&quot;w&quot;,stdout); int n,m,q,t,ans; fin&gt;&gt;n&gt;&gt;m&gt;&gt;q; anc[0][1]=dep[1]=1; for(rgi i=2;i&lt;=n;++i) fin&gt;&gt;anc[0][i],dep[i]=dep[anc[0][i]]+1; for(rgi i=1;i&lt;=n;++i) fin&gt;&gt;t,g[i][t]=1; for(rgi i=1;i&lt;=n;++i) f[i]=g[anc[0][i]]; for(rgi j=1;j&lt;20;++j) for(rgi i=1;i&lt;=n;++i) anc[j][i]=anc[j-1][anc[j-1][i]]; for(rgi i=1;i&lt;=q;++i) {fin&gt;&gt;c[i]; for(rgi j=1;j&lt;=c[i];++j) fin&gt;&gt;v[j][i],p[j][i]=g[v[j][i]]; v[0][i]=v[1][i]; for(rgi j=2;j&lt;=c[i];++j) v[0][i]=LCA(v[j][i],v[0][i]); } for(rgi k=0;k&lt;20;++k) { for(rgi i=1;i&lt;=q;++i) for(rgi j=1;j&lt;=c[i];++j) if((dep[v[j][i]]-dep[v[0][i]])&amp;(1&lt;&lt;k)) p[j][i]|=f[v[j][i]],v[j][i]=anc[k][v[j][i]]; memcpy(g,f,sizeof(f)); for(rgi i=1;i&lt;=n;++i) f[i]=g[i]|g[anc[k][i]]; } for(rgi k=1;k&lt;=q;++k) { ans=inf; for(rgi i=1;i&lt;1&lt;&lt;c[k];++i) {tmp=0; for(rgi j=1;j&lt;=c[k];++j) if(i&amp;(1&lt;&lt;(j-1))) tmp|=p[j][k]; ans=std::min(ans,(int)tmp.count()/__builtin_popcount(i)); } fout&lt;&lt;(ans*c[k])&lt;&lt;endl; } return 0; } // ---------------------------- // by imzzy æ€»ç»“ å®åŠ›æ˜¯ç¡¬ä¼¤ã€‚ğŸ˜Ÿ ä¾ç„¶æ˜¯å‰ä¸¤é¢˜éƒ½æƒ³åˆ°äº†ï¼Œéƒ½ç æŒ‚äº†ï¼Œæœ€åä¸€é¢˜å‹æ ¹ä¸ä¼šã€‚ ç»§ç»­åŠªåŠ›å§ã€‚ ","link":"https://imzzy1201.github.io/post/1iyhTQXar/"},{"title":"20200713 æ ¡å†…æµ‹è¯•è®¢æ­£","content":" I may not be able to change the past, but I can learn from it. 1. æ¦‚å†µ T1 100pts æŒºç®€å•æ²¡å•¥é—®é¢˜ã€‚ T2 90pts ç é”™äº†å¥½å‡ ä¸ªåœ°æ–¹ç«Ÿç„¶è¿˜èƒ½è¿™ä¹ˆé«˜ï¼Ÿï¼Ÿï¼Ÿ T3 0pts å·®ä¸€è¡Œå°±åˆ‡äº†ã€‚ğŸ™ƒ T4 0pts ä¸ä¼šã€‚ æ€»åˆ† 190ptsï¼Œå·®ã€‚ 2. é¢˜è§£ æµ‹è¯•èµ„æºé“¾æ¥ï¼ˆæ ¡å†…é¢˜åº“ï¼Œä¸å…¬å¼€å¯†ç ï¼‰ T1 å˜æ¢åºåˆ— é¢˜é¢ï¼ˆluoguï¼‰ å‰ç½®çŸ¥è¯† äºŒåˆ†å›¾åŒ¹é…ï¼ˆåŒˆç‰™åˆ©å’Œç½‘ç»œç˜¤éƒ½å¯ä»¥ï¼‰ æ€è·¯ å…ˆè€ƒè™‘æ•° iii èƒ½æ”¾çš„ä½ç½®ï¼Œå…¶ä¸‹æ ‡ï¼ˆä» 000 å¼€å§‹ï¼‰åªå¯èƒ½ä¸º (i+Di) mod N(i+D_i)\\bmod N(i+Diâ€‹)modN å’Œ (iâˆ’Di) mod N(i-D_i)\\bmod N(iâˆ’Diâ€‹)modNï¼Œæ¯ä¸ªæ•°åªèƒ½æ”¾ä¸€ä¸ªä½ç½®ï¼Œè€Œæ¯ä¸ªä½ç½®ä¹Ÿåªèƒ½æ”¾ä¸€ä¸ªæ•°ã€‚æ‰€ä»¥å¯ä»¥è§„çº¦æˆå®Œç¾åŒ¹é…é—®é¢˜ï¼Œå³ç”¨ä¸‹æ ‡ä¸æ•°å­—åŒ¹é…ï¼Œæ•°å­— iii å‘ä¸‹æ ‡ (iÂ±Di) mod N(i\\pm D_i)\\bmod N(iÂ±Diâ€‹)modN è¿è¾¹ï¼Œè·‘äºŒåˆ†å›¾åŒ¹é…ï¼Œå¦‚æœæ²¡æœ‰å®Œç¾åŒ¹é…å°±ç›¸å½“äºæ— è§£ã€‚ å¦ä¸€ä¸ªé—®é¢˜æ˜¯è¦æ±‚è¾“å‡ºå­—å…¸åºæœ€å°çš„ä¸€ç»„è§£ï¼Œè€ƒè™‘åˆ°åŒ¹é…è¿‡ç¨‹æ˜¯æ¯æ¬¡å°è¯•å¢å¹¿ã€‚å› ä¸ºæˆ‘ä»¬å¸Œæœ›è¶Šå°çš„æ•°å­—è¶Šå¾€å‰æ”¾ï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›å®ƒé åå¼€å§‹å¢å¹¿ã€‚è¿™ä¸€ç‚¹ä¸éš¾ç†è§£ã€‚åŒæ—¶ï¼Œåœ¨ä¸€æ¬¡å¢å¹¿ä¸­ï¼Œä¹Ÿåº”è¯¥å…ˆå°è¯•ä»ä¸‹æ ‡è¾ƒå°çš„ä½ç½®å¼€å§‹ã€‚å¯ä»¥ç”¨åè¯æ³•è¯æ˜è¿™ä¸ªç­–ç•¥çš„æ­£ç¡®æ€§ Code #include&lt;bits/stdc++.h&gt; #define rgi register int #define ll long long // ---------------------------- // #define int ll using namespace std; const int maxn=10004; const int mod=998244353,inf=1000000007; inline int read() { int x=0,f=0,ch=0; while(!isdigit(ch)) f|=(ch=='-'),ch=getchar(); while(isdigit(ch)) x=(x&lt;&lt;1)+(x&lt;&lt;3)+(ch^'0'),ch=getchar(); return f?-x:x; } vector&lt;int&gt; mp[maxn]; int match[maxn]; bool vis[maxn]; bool dfs(int p) // åŒˆç‰™åˆ©ç®—æ³• { for(unsigned rgi i=0,v;i&lt;mp[p].size();++i) { v=mp[p][i]; if(vis[v]) continue; vis[v]=1; if(match[v]==-1||dfs(match[v])) return match[v]=p,1; } return 0; } int a[maxn],ans[maxn]; signed main() { // freopen(&quot;transform.in&quot;,&quot;r&quot;,stdin); // freopen(&quot;transform.out&quot;,&quot;w&quot;,stdout); int n=read(); for(rgi i=0;i&lt;n;++i) { a[i]=read(); mp[i].push_back((i+a[i])%n); mp[i].push_back((i-a[i]+n)%n); sort(mp[i].begin(),mp[i].end()); } memset(match,-1,sizeof(match)); for(rgi i=n-1;i&gt;=0;--i) { memset(vis,0,sizeof(vis)); if(!dfs(i)) {puts(&quot;No Answer&quot;); return 0;} // æ— æ³•å¢å¹¿å³è¯´æ˜æ— è§£ } for(rgi i=0;i&lt;n;++i) ans[match[i]]=i; // æ³¨æ„ç­”æ¡ˆä¸ç›´æ¥ä¸ºè¿™ä¸ªåŒ¹é…ï¼Œè¿™ä¸ªåŒ¹é…æ˜¯æ•°ä¸ä¸‹æ ‡çš„å¯¹åº”è€Œéä¸‹æ ‡ä¸æ•°çš„å¯¹åº”ï¼Œæ‰€ä»¥è¦åè¿‡æ¥ä¸€ä¸‹ for(rgi i=0;i&lt;n;++i) printf(&quot;%d &quot;,ans[i]); return 0; } // ---------------------------- // by imzzy T2 æœ€å¤§å­å›¾ é¢˜é¢ï¼ˆluoguï¼‰ å‰ç½®çŸ¥è¯† ç¼©ç‚¹ï¼ˆtarjan ç®—æ³•ï¼‰ æ‹“æ‰‘æ’åº DAG ä¸Š DP æ€è·¯ é¢˜ç›®è¦æ±‚â€œæœ€å¤§åŠè¿é€šå¯¼å‡ºå­å›¾çš„èŠ‚ç‚¹æ•°â€åŠâ€œå¹¶åˆ—æœ€å¤§åŠè¿é€šå¯¼å‡ºå­å›¾çš„ä¸ªæ•°â€ã€‚å…ˆè§‚å¯ŸåŠè¿é€šå›¾çš„æ€§è´¨ï¼Œæˆ‘ä»¬å‘ç°ä¸€ä¸ªå›¾æ˜¯åŠè¿é€šå›¾å½“ä¸”ä»…å½“å›¾ä¸­å­˜åœ¨ä¸€æ¡è·¯å¾„èƒ½ç»è¿‡æ‰€æœ‰èŠ‚ç‚¹ã€‚è¿™ä¸ªç»“è®ºä¹Ÿæ¯”è¾ƒæ˜¾è€Œæ˜“è§ã€‚ ç„¶åï¼Œç»§ç»­ç»“åˆå¼ºè¿é€šåˆ†é‡çš„å¾ˆå¥½çš„æ€§è´¨ï¼šå¼ºè¿é€šåˆ†é‡å†…ä»»æ„ä¸¤ç‚¹ u,vu,vu,v é—´å­˜åœ¨è‡³å°‘ä¸€æ¡æœ‰å‘è·¯å¾„ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€æ¡è·¯å¾„åªè¦è¿›äº†å¼ºè¿é€šåˆ†é‡å°±å¯ä»¥èµ°å®Œè¿™ä¸ªåˆ†é‡é‡Œçš„æ‰€æœ‰ç‚¹ï¼Œå†ä»ä»»ä½•ä¸€ç‚¹å‡ºå»ã€‚æ‰€ä»¥å¯ä»¥ç¼©ç‚¹ï¼Œå¹¶è®°å½•ç¼–å·ä¸º iii çš„å¼ºè¿é€šåˆ†é‡é‡Œçš„èŠ‚ç‚¹æ•° siz[i]siz[i]siz[i]ï¼Œè·¯å¾„è¿›äº†åˆ†é‡ iii å°±ç›¸å½“äºèƒ½èµ° siz[i]siz[i]siz[i] ä¸ªèŠ‚ç‚¹ã€‚ ç¼©ç‚¹ä¹‹åå›¾æˆäº† DAGï¼Œæ ¹æ®å¥—è·¯æˆ‘ä»¬å°†å…¶æ‹“æ‰‘æ’åºå¹¶ DPã€‚æ‹“æ‰‘æ’åºåï¼Œè€ƒè™‘æŒ‰é€†æ‹“æ‰‘åºåŠ¨æ€è§„åˆ’ä»¥åˆ†é‡ iii ä¸ºèµ·ç‚¹çš„â€œæœ€å¤§åŠè¿é€šå¯¼å‡ºå­å›¾èŠ‚ç‚¹æ•°â€å’Œâ€œè¿™æ ·çš„å¯¼å‡ºå­å›¾çš„ä¸ªæ•°â€ï¼Œå³å¯ã€‚ Code #include&lt;bits/stdc++.h&gt; #define rgi register int #define ll long long // ---------------------------- // #define int ll using namespace std; const int maxn=200004; const int mod=998244353,inf=1000000007; inline int read() { int x=0,f=0,ch=0; while(!isdigit(ch)) f|=(ch=='-'),ch=getchar(); while(isdigit(ch)) x=(x&lt;&lt;1)+(x&lt;&lt;3)+(ch^'0'),ch=getchar(); return f?-x:x; } int n,m,p,u,v; vector&lt;int&gt; to[maxn],to2[maxn]; // to å­˜åŸå›¾ï¼Œto2 å­˜ç¼©ç‚¹åçš„è¾…åŠ©å›¾ï¼ˆç”¨äºæ‹“æ‰‘æ’åºå’Œ DPï¼‰ int col[maxn],siz[maxn]; // col[i] è¡¨ç¤º i æ‰€åœ¨çš„å¼ºè¿é€šåˆ†é‡ç¼–å·ï¼Œsiz[i] è¡¨ç¤ºç¼–å·ä¸º i çš„å¼ºè¿é€šåˆ†é‡èŠ‚ç‚¹æ•° bool vis[maxn]; int dfn[maxn],low[maxn],stk[maxn]; int dfsclock,indxs,cnt; void tarjan(int p) // ç¼©ç‚¹ { vis[stk[++indxs]=p]=1; low[p]=dfn[p]=++dfsclock; for(rgi i=0;i&lt;to[p].size();++i) if(!dfn[to[p][i]]) tarjan(to[p][i]),low[p]=min(low[p],low[to[p][i]]); else if(vis[to[p][i]]) low[p]=min(low[p],dfn[to[p][i]]); if(low[p]==dfn[p]) { vis[p]=0,siz[col[p]=++cnt]=1; while(p!=stk[indxs]) vis[stk[indxs]]=0,++siz[cnt],col[stk[indxs--]]=cnt; --indxs; } } int ccf[maxn],topo[maxn],ip; queue&lt;int&gt; q; inline void topsort() // æ‹“æ‰‘æ’åº { for(rgi i=1;i&lt;=n;++i) for(rgi j=0;j&lt;to[i].size();++j) if(col[i]!=col[to[i][j]]) to2[col[i]].push_back(col[to[i][j]]),++ccf[col[to[i][j]]]; for(rgi i=1;i&lt;=cnt;++i) if(ccf[i]==0) q.push(i),topo[++ip]=i; int u,v; while(!q.empty()) { u=q.front(),q.pop(); for(rgi i=0;i&lt;to2[u].size();++i) if((--ccf[to2[u][i]])==0) q.push(to2[u][i]),topo[++ip]=to2[u][i]; } } pair&lt;ll,ll&gt; f[maxn]; // f[i].first ä¸ºâ€œâ€¦çš„èŠ‚ç‚¹æ•°â€ï¼Œf[i].second ä¸ºâ€œâ€¦çš„ä¸ªæ•°â€ï¼Œå…¶ä¸­ i ä¸ºåˆ†é‡ç¼–å· inline void insert(pair&lt;ll,ll&gt; &amp;a,pair&lt;ll,ll&gt; b) {if(b.first==a.first) (a.second+=b.second)%=p; if(b.first&gt;a.first) a=b;} // insert æ˜¯ç”¨ b æ¥æ›´æ–° a set&lt;pair&lt;int,int&gt; &gt; s; inline pair&lt;ll,ll&gt; calc() { for(rgi i=1;i&lt;=cnt;++i) to2[i].clear(),f[i].second=1; // è¿™é‡Œè¦åå‘å»ºå›¾ï¼Œæ‰€ä»¥æ¸…ç©ºäº†é‡æ¥ for(rgi i=1;i&lt;=n;++i) for(rgi j=0;j&lt;to[i].size();++j) if(col[i]!=col[to[i][j]]&amp;&amp;!s.count(make_pair(col[i],col[to[i][j]]))) to2[col[to[i][j]]].push_back(col[i]),s.insert(make_pair(col[i],col[to[i][j]])); // æ³¨æ„è¿æ¥ä¸¤åˆ†é‡çš„åŒä¸€æ¡è¾¹ä¸èƒ½åŠ å¤šæ¬¡ï¼Œå¦åˆ™ä¼šå¤šæ¬¡æ›´æ–° pair&lt;ll,ll&gt; res=make_pair(0,0); for(rgi i=cnt,u;i&gt;0;--i) { u=topo[i],f[u].first+=siz[u],insert(res,f[u]); for(rgi j=0;j&lt;to2[u].size();++j) insert(f[to2[u][j]],f[u]); } return res; } signed main() { // freopen(&quot;graph.in&quot;,&quot;r&quot;,stdin); // freopen(&quot;graph.out&quot;,&quot;w&quot;,stdout); n=read(),m=read(),p=read(); for(rgi i=1;i&lt;=m;++i) u=read(),v=read(),to[u].push_back(v); for(rgi i=1;i&lt;=n;++i) if(!dfn[i]) tarjan(i); topsort(); pair&lt;ll,ll&gt; ans=calc(); printf(&quot;%lld\\n%lld&quot;,ans.first,ans.second); return 0; } // ---------------------------- // by imzzy T3 æœ€çŸ­è·¯ é¢˜é¢ï¼ˆDARKBZOJï¼‰ å‰ç½®çŸ¥è¯† æœ€çŸ­è·¯ç®—æ³•ï¼ˆDijkstraï¼‰ æ€è·¯ å…ˆè€ƒè™‘è¿ä¸Šæ‰€æœ‰å­˜åœ¨çš„è¾¹ï¼ˆå³æ¯ä¸¤ä¸ªç‚¹é—´è¿ä¸¤æ¡ï¼Œåˆ†åˆ«ä¸ºæ¨ªçºµåæ ‡çš„å·®ï¼‰ï¼Œç„¶åå†è€ƒè™‘åˆ æ‰æ— ç”¨è¾¹ã€‚åˆ†æ–¹å‘è®¨è®ºï¼Œå…ˆçœ‹æ¨ªå‘è¾¹ï¼Œå¦‚æœ iii åœ¨ jjj çš„å·¦ä¾§ï¼Œjjj åœ¨ kkk çš„å·¦ä¾§ï¼Œé‚£ä¹ˆå¾ˆæ˜æ˜¾ iii è‡³ kkk çš„æ¨ªå‘è¾¹æ˜¯æ¯«æ— æ„ä¹‰çš„ï¼ˆå› ä¸ºè¿™æ¡è¾¹å®Œå…¨å¯ä»¥è¢« iâ†’jâ†’ki\\to j\\to kiâ†’jâ†’k è¿™æ¡è·¯å¾„æ›¿ä»£ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´æŒ‰ç…§æ¨ªåæ ‡æ’åºåï¼Œæ¨ªå‘è¾¹åªç”¨è¿æ¥ç›¸é‚»ä¸¤ç‚¹å³å¯ã€‚çºµåæ ‡åŒç†ã€‚è¿™æ ·è¿è¾¹åè¾¹æ•°å°±å·²ç»æ˜¯ O(n)\\mathcal{O}(n)O(n) çº§åˆ«çš„äº†ï¼Œå‰©ä¸‹å°±æ˜¯æ­£å¸¸æ±‚æœ€çŸ­è·¯å³å¯ Code #include&lt;bits/stdc++.h&gt; #define rgi register int #define ll long long // ---------------------------- // #define int ll using namespace std; const int maxn=200004; const int mod=998244353,inf=1000000007; inline int read() { int x=0,f=0,ch=0; while(!isdigit(ch)) f|=(ch=='-'),ch=getchar(); while(isdigit(ch)) x=(x&lt;&lt;1)+(x&lt;&lt;3)+(ch^'0'),ch=getchar(); return f?-x:x; } int n; struct EDGE{int v,nxt; ll w;}e[maxn&lt;&lt;2]; int first[maxn],cnte; inline void addedge(int p,int q,ll w) { e[++cnte].v=q,e[cnte].w=w, e[cnte].nxt=first[p],first[p]=cnte; } inline void addedge2(int p,int q,ll w) {addedge(p,q,w),addedge(q,p,w);} struct NODE{ int v; ll w; inline bool operator&lt;(const NODE &amp;a) const {return w&gt;a.w;}; NODE(int a,int b) {v=a,w=b;} }; ll dis[maxn]; bool vis[maxn]; priority_queue&lt;NODE&gt; q; ll Dij() // Dijkstra { memset(dis,0x3f,sizeof(dis)); int u,v; q.push(NODE(1,0)),dis[1]=0; while(!q.empty()) { u=q.top().v,q.pop(); if(vis[u]) continue; vis[u]=1; for(rgi i=first[u];i;i=e[i].nxt) { v=e[i].v; if(dis[v]&gt;dis[u]+e[i].w) dis[v]=dis[u]+e[i].w,q.push(NODE(v,dis[v])); } } return dis[n]; } struct POINT{int x,y,k;}p[maxn]; inline bool cmp1(POINT a,POINT b) {return a.x&lt;b.x;} inline bool cmp2(POINT a,POINT b) {return a.y&lt;b.y;} signed main() { // freopen(&quot;dist.in&quot;,&quot;r&quot;,stdin); // freopen(&quot;dist.out&quot;,&quot;w&quot;,stdout); n=read(); for(rgi i=1;i&lt;=n;++i) p[i].x=read(),p[i].y=read(),p[i].k=i; sort(p+1,p+1+n,cmp1); for(rgi i=1;i&lt;n;++i) addedge2(p[i].k,p[i+1].k,p[i+1].x-p[i].x); sort(p+1,p+1+n,cmp2); for(rgi i=1;i&lt;n;++i) addedge2(p[i].k,p[i+1].k,p[i+1].y-p[i].y); // åˆ†åˆ«æŒ‰æ¨ªçºµåæ ‡æ’åºååŠ è¾¹ printf(&quot;%lld&quot;,Dij()); return 0; } // ---------------------------- // by imzzy T4 å¹³é¢å›¾åˆ¤å®š é¢˜é¢ï¼ˆluoguï¼‰ å‰ç½®çŸ¥è¯† å¹¶æŸ¥é›† æ€è·¯ é¦–å…ˆï¼Œæˆ‘ä»¬çŸ¥é“å¹³é¢å›¾èŠ‚ç‚¹æ•° nnn å’Œè¾¹æ•° mmm æ€»æœ‰ mâ‰¤3nâˆ’6m\\le3n-6mâ‰¤3nâˆ’6ï¼Œå› æ­¤å¦‚æœç»™çš„ m&gt;3nâˆ’6m&gt;3n-6m&gt;3nâˆ’6 å°±å¯ä»¥ç›´æ¥æ–­è¨€å…¶éå¹³é¢å›¾äº†ã€‚å› æ­¤å¯ä»¥å°†å›¾çš„è¾¹æ•°é™è‡³ O(n)\\mathcal{O}(n)O(n) çº§åˆ«ã€‚ æ—¢ç„¶é¢˜ç›®ç»™çš„æ˜¯ä¸ªå“ˆå¯†é¡¿å›¾ï¼Œè¿˜ç»™å‡ºäº†å“ˆå¯†é¡¿å›è·¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å…ˆç”»å‡ºè¿™ä¸ªå›è·¯ï¼Œå½¢æˆä¸€ä¸ªå¤§åœˆã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªå›¾é‡Œçš„æ‰€æœ‰è¾¹ï¼Œè¦ä¹ˆåœ¨åœˆå†…ï¼Œè¦ä¹ˆåœ¨åœˆå¤–ï¼Œè¦ä¹ˆåœ¨åœˆä¸Š ï¼ˆåºŸè¯ï¼‰ã€‚ åœ¨åœˆä¸Šçš„è¾¹ä¸ç”¨è€ƒè™‘ï¼Œå› ä¸ºè¯´â€œè¦ä¹ˆåœ¨åœˆå†…ï¼Œè¦ä¹ˆåœ¨åœˆå¤–ï¼Œè¦ä¹ˆåœ¨åœˆä¸Šâ€æ—¶å·²ç»ç¡®å®šäº†æ²¡æœ‰è¾¹ç©¿è¿‡åœˆï¼Œå³åœˆä¸Šæ‰€æœ‰è¾¹ä¸è·Ÿå…¶å®ƒè¾¹ç›¸äº¤ã€‚è€Œå¯¹äºå…¶å®ƒè¾¹ï¼Œå¦‚æœè®° st[i]st[i]st[i] ä¸ºè¾¹ iii åœ¨åœˆå†…çš„æ–­è¨€ï¼Œstâ€²[i]st&#x27;[i]stâ€²[i] ä¸ºè¾¹ iii åœ¨åœˆå¤–çš„æ–­è¨€ï¼Œé‚£ä¹ˆå¦‚æœè¾¹ i,ji,ji,j åœ¨åœˆå†…ä¼šç›¸äº¤ï¼Œåˆ™å§‹ç»ˆæœ‰ st[i]â‡”stâ€²[j],st[j]â‡”stâ€²[i]st[i]\\Leftrightarrow st&#x27;[j],st[j]\\Leftrightarrow st&#x27;[i]st[i]â‡”stâ€²[j],st[j]â‡”stâ€²[i] æˆç«‹ã€‚ å› æ­¤æˆ‘ä»¬åªç”¨å°†æ‰€æœ‰æ­¤ç±»æ¡ä»¶æ•´åˆï¼Œå¹¶æ£€æŸ¥æ˜¯å¦æœ‰çŸ›ç›¾å³å¯ã€‚çŸ›ç›¾çš„å½¢å¼ä¹Ÿå¾ˆå®¹æ˜“çœ‹å‡ºæ¥ï¼Œåªç”¨åˆ¤æ–­æœ‰æ²¡æœ‰ st[i]âˆ§stâ€²[i]st[i]\\wedge st&#x27;[i]st[i]âˆ§stâ€²[i] ä¸ºçœŸçš„æƒ…å†µï¼Œå¦‚æœæ²¡æœ‰å°±æ˜¯å¹³é¢å›¾ï¼Œæœ‰åˆ™ä¸æ˜¯ è‡³äºç»´æŠ¤è¿™äº›å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¹¶æŸ¥é›†ç»´æŠ¤ä¸€äº›ç­‰ä»·ç±»ã€‚æ¯”å¦‚ st[i]â‡”stâ€²[j]st[i]\\Leftrightarrow st&#x27;[j]st[i]â‡”stâ€²[j] å°±ç›¸å½“äº st[i]st[i]st[i] å’Œ stâ€²[j]st&#x27;[j]stâ€²[j] åœ¨åŒä¸€ç­‰ä»·ç±»ä¸­ï¼Œå³å¯¹è¿™ä¸¤ä¸ªçŠ¶æ€åŸå¤„çš„ç­‰ä»·ç±»è¿›è¡Œåˆå¹¶ï¼›æœ€åå¯¹äºæ¯ä¸ª iii å†æ£€æŸ¥ st[i]st[i]st[i] å’Œ stâ€²[i]st&#x27;[i]stâ€²[i] æ˜¯å¦åœ¨åŒä¸€ç­‰ä»·ç±»å³å¯ã€‚ Code #include&lt;bits/stdc++.h&gt; #define rgi register int #define ll long long // ---------------------------- // #define int ll using namespace std; const int maxn=204,maxm=100004; const int mod=998244353,inf=1000000007; inline int read() { int x=0,f=0,ch=0; while(!isdigit(ch)) f|=(ch=='-'),ch=getchar(); while(isdigit(ch)) x=(x&lt;&lt;1)+(x&lt;&lt;3)+(ch^'0'),ch=getchar(); return f?-x:x; } int n,m; int u[maxm],v[maxm],a[maxn],pos[maxn]; class DSU{ // å¹¶æŸ¥é›† private: int fa[maxm]; public: inline void build(int siz) {for(rgi i=1;i&lt;=siz;++i) fa[i]=i;} inline int find(int p) {while(fa[p]!=p) p=fa[p]=fa[fa[p]]; return p;} inline void merge(int p,int q) {fa[find(p)]=find(q);} inline bool query(int p,int q) {return find(p)==find(q);} }dsu; signed main() { // freopen(&quot;planar.in&quot;,&quot;r&quot;,stdin); // freopen(&quot;planar.out&quot;,&quot;w&quot;,stdout); rgi T=read(); while(T--) { n=read(),m=read(); for(rgi i=1;i&lt;=m;++i) u[i]=read(),v[i]=read(); for(rgi i=1;i&lt;=n;++i) a[i]=read(),pos[a[i]]=i; // pos[i] ä¸ºèŠ‚ç‚¹ i åœ¨åœˆä¸Šçš„ç¼–å· if(m&gt;n*3-6) {puts(&quot;NO&quot;); continue;} for(rgi i=1;i&lt;=m;++i) { u[i]=pos[u[i]],v[i]=pos[v[i]]; // æ”¹ä¸€ä¸‹èŠ‚ç‚¹ç¼–å·ï¼Œæ–¹ä¾¿åé¢åˆ¤åœˆå†…ä¸¤è¾¹æ˜¯å¦äº¤å‰ if(u[i]&gt;v[i]) swap(u[i],v[i]); // å…äºåˆ†ç±»è®¨è®º } dsu.build(m*2+1); for(rgi i=1;i&lt;=m;++i) for(rgi j=i+1;j&lt;=m;++j) { if(u[i]==u[j]||v[i]==v[j]||u[j]==v[i]||u[i]==v[j]) continue; // æœ‰ç›¸åŒèŠ‚ç‚¹å³å¯è·³è¿‡ int a=i,b=j; if(u[a]&gt;u[b]) swap(a,b); // å…äºåˆ†ç±»è®¨è®º if(u[b]&lt;v[a]&amp;&amp;v[a]&lt;v[b]) dsu.merge(a,b+m),dsu.merge(b,a+m); } bool flag=1; for(rgi i=1;i&lt;=m&amp;&amp;flag;++i) if(dsu.query(i,i+m)) flag=0; puts(flag?&quot;YES&quot;:&quot;NO&quot;); } return 0; } // ---------------------------- // by imzzy 3. æ€»ç»“ emmmmâ€¦â€¦ å‰ä¸‰é¢˜éƒ½è¿˜æ˜¯æƒ³åˆ°äº†çš„ï¼Œä½†æ—¶é—´åˆ†é…ä¸å½“ã€å®ç°ä¸Šä¹Ÿæœ‰äº›é—®é¢˜ï¼Œæ‰€ä»¥ä¸¢äº†ä¸å°‘åˆ†ã€‚æœ€åä¸€é¢˜ 2-SAT æˆ–è€… DSUï¼Œè¿™ä¸ªå¥—è·¯æ²¡æ€ä¹ˆåšè¿‡ï¼Œä¸å¤ªä¼šç”¨ï¼Œå¹³é¢å›¾çš„æ€§è´¨ä¹Ÿä¸çŸ¥é“ï¼Œæ²¡æƒ³å‡ºæ¥ä¹Ÿç®—æ­£å¸¸ï¼ˆ?ï¼‰ ","link":"https://imzzy1201.github.io/post/LQUS5KCXn/"},{"title":"æ‚é¢˜ - CF1375F Integer Game","content":" Whatever you do, you hold on to that foolishly hopeful smile. é¢˜é¢ é¢˜æ„ç®€è¿°ï¼š Anton æœ‰ 3 å †çŸ³å¤´ï¼Œåˆ†åˆ«æœ‰ a,b,ca,b,ca,b,c ä¸ªã€‚æ¯æ¬¡æ“ä½œ Harris æ‰”ç»™ Anton yyy ä¸ªçŸ³å¤´ï¼ŒAnton è¦é€‰æ‹©ä¸€å †æ‰”è¿›å»ï¼Œç›¸é‚»ä¸¤æ¬¡æ“ä½œ Anton ä¸èƒ½æ‰”è¿›åŒä¸€å †ã€‚å¦‚æœ 3 å †ä¸­ä»»æ„ä¸¤å †çš„çŸ³å¤´ä¸ªæ•°ä¸€æ ·ï¼ŒAnton è¾“ï¼›å¦‚æœ 1000 è½®æ“ä½œ Anton è¿˜æ²¡è¾“ï¼ŒHarris å°±è¾“ã€‚ ç»™ä½  a,b,ca,b,ca,b,cï¼Œè®©ä½ é€‰ä¸ªäººåªä¼šä»–èµ¢ã€‚ å‰ç½®çŸ¥è¯† é¡ºåºç»“æ„ç¨‹åºè®¾è®¡ï¼ˆ ? ? ? ï¼‰ æ€è·¯ æˆ‘ä»¬å…ˆè€ƒè™‘ä»€ä¹ˆæ—¶å€™ Anton ä¼šæŒ‚ã€‚ç°åœ¨æˆ‘ä»¬å…ˆå‡è®¾ a&lt;b&lt;ca&lt;b&lt;ca&lt;b&lt;cï¼Œå…¶åˆ†åˆ«å¯¹åº”çš„çŸ³å­å †è®°ä¸º A,B,CA,B,CA,B,Cï¼ˆæ³¨æ„ A,B,CA,B,CA,B,C åœ¨ä¸åŒè½®ä»£è¡¨çš„çŸ³å †ä¹Ÿä¸åŒï¼‰ä¸‹é¢åˆ†ç±»è®¨è®ºï¼š Anton ä¸Šä¸€è½®æ²¡æ‰”è¿› CCC å¾ˆæ˜æ˜¾ä»–è¿™è½®é€‰ CCC çš„å †å¾€é‡Œé¢æ‰”ï¼Œä¸€å®šæ­»ä¸äº†ã€‚ Anton ä¸Šä¸€è½®æ‰”è¿›äº† CCC æˆ‘ä»¬å‡è®¾ câˆ’bâ‰ bâˆ’ac-b\\neq b-acâˆ’bî€ â€‹=bâˆ’aï¼Œé‚£ä¹ˆå¦‚æœ k=câˆ’bk=c-bk=câˆ’b å°±å¾€ AAA é‡Œæ‰”ï¼Œå¦‚æœ k=bâˆ’ak=b-ak=bâˆ’a å°±å¾€ BBB é‡Œæ‰”ï¼Œå¦åˆ™éšä¾¿æ‰”ã€‚ å‡è®¾ câˆ’b=bâˆ’ac-b=b-acâˆ’b=bâˆ’aï¼Œé‚£ä¹ˆåªè¦æ‰”ç»™ä»– bâˆ’ab-abâˆ’a ä¸ªçŸ³å¤´ Anton å°±å¿…æ­»æ— ç–‘äº† é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰ Anton ä¸Šä¸€è½®æ‰”è¿›äº† CCCï¼Œå¹¶ä¸” câˆ’b=bâˆ’ac-b=b-acâˆ’b=bâˆ’aï¼ŒHarris æ‰å¿…èƒœã€‚ å†å¾€å‰æ¨ä¸€æ­¥ï¼Œæ€ä¹ˆè®© Anton åªèƒ½é€‰æ‰”è¿› CCCï¼Œå¹¶ä¸” câˆ’b=bâˆ’ac-b=b-acâˆ’b=bâˆ’a å‘¢ï¼Ÿ ä¸€ä¸ªå·§å¦™çš„æ„é€ æ–¹æ³•æ˜¯ï¼Œå‡è®¾å½“å‰ä¸‰å †çŸ³å¤´ä¸ªæ•°åˆ†åˆ«ä¸º a0,b0,c0 (a0&lt;b0&lt;c0)a_0,b_0,c_0\\ (a_0&lt;b_0&lt;c_0)a0â€‹,b0â€‹,c0â€‹ (a0â€‹&lt;b0â€‹&lt;c0â€‹)ï¼Œå¹¶ä¸”ä¸Šä¸€è½® Anton æ‰”åˆ°äº† CCC é‡Œã€‚å¦‚æœå« Harris æ‰”ç»™ Anton 2c0âˆ’a0âˆ’b02c_0-a_0-b_02c0â€‹âˆ’a0â€‹âˆ’b0â€‹ ä¸ªçŸ³å¤´ï¼Œæˆ‘ä»¬å‘ç°ï¼š å¦‚æœ Anton æ”¾è¿›äº† AAAï¼Œåˆ™æ–°çš„çŸ³å¤´ä¸ªæ•°ä¸º b0,c0,2c0âˆ’b0b_0,c_0,2c_0-b_0b0â€‹,c0â€‹,2c0â€‹âˆ’b0â€‹ï¼Œåˆ™æœ‰ câˆ’b=bâˆ’a=c0âˆ’b0c-b=b-a=c_0-b_0câˆ’b=bâˆ’a=c0â€‹âˆ’b0â€‹ å¦‚æœ Anton æ”¾è¿›äº† BBBï¼Œåˆ™æ–°çš„çŸ³å¤´ä¸ªæ•°ä¸º a0,c0,2c0âˆ’a0a_0,c_0,2c_0-a_0a0â€‹,c0â€‹,2c0â€‹âˆ’a0â€‹ï¼Œåˆ™æœ‰ câˆ’b=bâˆ’a=c0âˆ’a0c-b=b-a=c_0-a_0câˆ’b=bâˆ’a=c0â€‹âˆ’a0â€‹ é‚£ä¹ˆè¿™æ ·æ“ä½œå°±é€¼æ­» Anton äº†ã€‚ æœ€åæœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯ä¸Šé¢çš„æ–¹æ³•ä¸­è¦æ±‚ Anton å‰ä¸€è½®æ‰”åˆ°äº† CCC é‡Œã€‚è¿™ä¹Ÿå¾ˆå¥½è§£å†³ï¼Œå« Harris ä¸€å¼€å§‹å°±æ‰”ç»™ Anton ä¸€ä¸ªå˜¿å¤§çš„æ•°ï¼Œä¸ç®¡æ€æ · Anton æ‰”åˆ°çš„å †éƒ½ä¼šæˆä¸ºæ–°ä¸€è½®çš„ CCCã€‚ Code ll a[4]; signed main() { fin&gt;&gt;a[1]&gt;&gt;a[2]&gt;&gt;a[3]; puts(&quot;First&quot;),fflush(stdout); puts(&quot;100000000000&quot;),fflush(stdout); int t,x; fin&gt;&gt;t,a[t]+=100000000000ll; fout&lt;&lt;(3ll*a[t]-a[1]-a[2]-a[3])&lt;&lt;endl,fflush(stdout); fin&gt;&gt;x; fout&lt;&lt;a[t]-a[6-x-t]&lt;&lt;endl,fflush(stdout); fin&gt;&gt;x; return 0; } ","link":"https://imzzy1201.github.io/post/1Qf-3P6_-/"},{"title":"æ¸¸è®° - HBOI2020","content":" You have to work very hard to believe that you are really powerless. Day -?? æ²‰è¿·äº whkï¼Œç äº†å‡ ä¸ªå° DSï¼Œç„¶åå¼€å§‹é‡å†™å„ç§å„æ ·çš„ã€æ¨¡æ¿ã€‘ã€‚ Day -? å‘ç°è‡ªå·±è¿ kmp éƒ½å¿˜äº†ï¼Œç„¶åå¼€å§‹æ¶è¡¥å­—ç¬¦ä¸²ã€‚ï¼ˆè™½ç„¶æœ€åæ ¹æœ¬æ²¡è€ƒä¸²ä¸²ï¼‰ è€ƒäº†å¥—æ¨¡æ‹Ÿèµ›ï¼Œåšå¾—è¿˜ä¸é”™ã€‚ Day 0 whk è€ƒè¯•å»äº†ï¼Œæœ€åæ™šä¸Šé™ª xiong_6\\textsf{\\color{black}x\\color{red}iong\\_6}xiong_6 ç äº†ä¸ªçº¿æ®µæ ‘ 1ï¼ˆå¬è¯´èƒ½å¢åŠ  rp ï¼Ÿï¼Ÿï¼Ÿï¼‰ç„¶åå°±ç¡äº†ã€‚ Day 1 é¢˜ç›®è¿˜å¥½ï¼Œæ‹¿åˆ°ä¹‹åæ‰«ä¸€éé¢˜é¢è§‰å¾— T1 å¯åšï¼ŒT2 è¯´ä¸å‡†ï¼ŒT3 å®Œå…¨ä¸å¯åšã€‚ ä»”ç»†æƒ³äº†æƒ³ T1ï¼Œæƒ³æ³•æ˜¯å€¼åŸŸæ ‘çŠ¶æ•°ç»„ä¸ŠäºŒåˆ†ï¼Œlogâ¡2\\log^2log2 çš„ï¼Œä½†è‡ªä»¥ä¸ºå¸¸æ•°å¾ˆå°èƒ½è¿‡ï¼Œäºæ˜¯æ²¡æœ‰ç»§ç»­æƒ³ä¸€ä¸ª logâ¡\\loglog çš„è§£æ³•äº†ã€‚ ç„¶åå¼€å§‹è‚ T2ï¼Œå‘ç°å¤§æ¦‚åœ¨å¯’å‡çš„æ—¶å€™æˆ‘é—®è¿‡ xiong_6 å·®ä¸å¤šçš„é¢˜ï¼Ÿï¼Ÿï¼Ÿç„¶è€Œé—æ†¾çš„æ˜¯é‚£æ—¶å€™æ²¡åšå‡ºæ¥ã€‚äºæ˜¯å¼€å§‹å°è¯•æ‰¾è§„å¾‹ã€‚å¤§æ¦‚å°±æ˜¯ç»™å®š n,kn,kn,kï¼Œå°è¯•æŠŠ âˆ‘i=0nikxi(ni)\\sum_{i=0}^n i^kx^i\\binom{n}{i} i=0âˆ‘nâ€‹ikxi(inâ€‹) è¡¨ç¤ºæˆ âˆ‘i=nâˆ’knfixnâˆ’iâˆ‘j=0ixj(ij)\\sum_{i=n-k}^nf_ix^{n-i}\\sum_{j=0}^{i}x^j\\binom{i}{j} i=nâˆ’kâˆ‘nâ€‹fiâ€‹xnâˆ’ij=0âˆ‘iâ€‹xj(jiâ€‹) å³ âˆ‘i=nâˆ’knfixnâˆ’i(x+1)i\\sum_{i=n-k}^nf_ix^{n-i}(x+1)^i i=nâˆ’kâˆ‘nâ€‹fiâ€‹xnâˆ’i(x+1)i ç„¶åå°±å¼€å§‹å¯¹ {f}\\{f\\}{f} æ‰¾è§„å¾‹ã€‚ é…åˆç€æš´åŠ›ç¨‹åºï¼Œä¼°æ‘¸ç€æ‰¾äº† 2hï¼Œæ‰¾åˆ°äº†ä¸ªå¥‡å¥‡æ€ªæ€ªçš„è§„å¾‹ï¼Œç„¶åç å‡ºæ¥å°±è¿‡äº†å¤§æ ·ä¾‹ã€‚ å›å¤´æ¥ç  T1 äº†ï¼Œç äº†ä¸€åŠæ‰å‘ç°å¸¸æ•°å·¨å¤§ã€‚ã€‚ã€‚ä½†æ—¶é—´å·²ç»ä¸å¤šäº†ï¼Œæ‰€ä»¥å†³å®šå…ˆç å®Œ T1 logâ¡2\\log^2log2 å’Œ T3 å¤§æš´åŠ›å†å›å¤´æƒ³ã€‚ äºæ˜¯å°±è°ƒäº†åŠå¤© T3 ã€‚ã€‚ã€‚ æœ€åæ…Œæ…Œå¼ å¼ è‡ªå·±é€ äº†å‡ ä¸ªå°æ•°æ®æ‹äº†ä¸‹ T1 T2ï¼Œæ£€æŸ¥äº† freopenï¼Œå°±è€ƒè¯•ç»“æŸäº†ã€‚ç„¶åå‘ç°å¥½å¤šäººéƒ½æ²¡åšå‡ºæ¥ T2 ï¼Ÿï¼Ÿ ç„¶åä¼°åˆ† Day 1 60+100+15=17560+100+15=17560+100+15=175ï¼Œæ„Ÿè§‰è‰¯å¥½ å›å®¶ä¹Ÿæ²¡å¹²å•¥ä¸»è¦å°±æ˜¯è¡¥è§‰ï¼Œç„¶åå¬è¯´ FZzzz\\textsf{\\color{black}F\\color{red}Zzzz}FZzzz T1 ä¸€ä¸ª logâ¡\\loglog è·‘ 10s+ ï¼Ÿï¼Ÿï¼Ÿäºæ˜¯å¼€å§‹æ€€ç–‘è‡ªå·± 606060 éƒ½æ‹¿ä¸åˆ°äº†ï¼ˆ Day 2 ä¸€æ‹¿åˆ°å·å­å°±æ¯«æ— å¤´ç»ªï¼ˆé¢„ç¤ºç€è¦çˆ†é›¶ï¼Ÿï¼‰ å†·é™æƒ³äº†æƒ³â€¦â€¦ä¾ç„¶æ¯«æ— å¤´ç»ªâ€¦â€¦ T1 å‡†å¤‡å…ˆå†™ä¸ªæš´åŠ›æ‰¾æ‰¾è§„å¾‹ï¼Œç„¶åå‘ç°æ‰¾ä¸åˆ°è§„å¾‹ã€‚ç„¶åå°è¯•è´ªå¿ƒï¼Œå‘ç°è´ªå¿ƒæ˜¯é”™çš„ã€‚è€ƒè™‘ DP ä½†ä¸ä¼š DPã€‚å†³å®šå…ˆæ”¾ç€æš´åŠ›çœ‹åé¢çš„é¢˜å»ã€‚ ç„¶åæ˜¯ T2ï¼ŒDS é¢˜ï¼Œçœ‹èµ·æ¥è¦æ”¯æŒåŒºé—´åŠ ä¸€ã€æ’å…¥å€¼ã€æŸ¥è¯¢åŒºé—´å¼‚æˆ–å’Œã€‚å°è¯•çº¿æ®µæ ‘ï¼Œfailedï¼›å°è¯•å€¼åŸŸæ ‘çŠ¶æ•°ç»„ï¼Œfailedï¼›å°è¯• 01trieï¼Œå‘ç°è‡ªå·±æ ¹æœ¬æ²¡åšè¿‡ 01trie çš„é¢˜ï¼Œæœæ–­ failedã€‚äºæ˜¯åªå¾—è°ƒå¤´æ‹¿å‚»ç“œåˆ†ï¼Œå¹¶æœŸæœ›ç€å‡ºé¢˜äººæ‹¿è„šé€ æ•°æ®ã€‚ çœ‹ T3 å»äº†ï¼Œæ±‚ç”Ÿæˆæ ‘ä¸ªæ•° ï¼Ÿåˆæ¨äº†åŠå¤©å¼å­ç„¶è€Œæ¯«æ— è¿›å±•ï¼Œäºæ˜¯åˆå»ç æš´åŠ›äº†ã€‚ ç„¶åå°±å¼€å§‹ç‹‚æƒ³ T1 T3 çš„å…¶å®ƒéƒ¨åˆ†åˆ†ï¼Œä½†ä¾ç„¶ä¸ä¼šã€‚ æœ€åé™¤äº†æš´åŠ›åˆ†å•¥ä¹Ÿæ²¡æ‹¿åˆ°â€¦â€¦ ä¼°åˆ† Day 2 30+10+30=7030+10+30=7030+10+30=70ï¼Œçˆ¬äº† å›å®¶æ‰çŸ¥é“ T2 æ˜¯åŸé¢˜ Day 3 åˆ°å’•ä¸Šæµ‹äº†ä¸¤å¤©çš„ T1 T2ï¼ŒD1 T1 606060 T2 100100100ï¼ŒD2 T1 æŒ‚äº† T2 808080 (?) ç„¶åå‘ç° D1 T1 çœŸçš„å¥½å¡å¸¸å•Š Day 4 è¿™ï¼Œå°±å‡ºæˆç»©äº†ï¼Ÿ äºæ˜¯ D2 T2 ä¾ç„¶åªæœ‰ 101010 åˆ†ï¼ŒD2 T3 è¿˜ WA äº† 555 åˆ† End æ€»åˆ†ï¼š240240240ï¼ˆHB rk9ï¼‰ åŠ æƒåˆ†ï¼š240Ã—70%+241Ã—30%=240.3240\\times70\\%+241\\times30\\%=240.3240Ã—70%+241Ã—30%=240.3ï¼ˆHB rk13ï¼‰ E é˜Ÿå·®ä¸€ç‚¹ çœé€‰è€ƒå¾—è¿˜å¥½ï¼Œä½†å»å¹´ CSP-S å¤ªèœäº†ï¼Œæ•´ä¸ªé˜Ÿçº¿é‡Œ CSP æˆç»©å€’æ•°ç¬¬äºŒçš„æ¯”æˆ‘é«˜ 50 ğŸ˜µ é—®é¢˜ä¸»è¦åœ¨ä¼šçš„çŸ¥è¯†ç‚¹å¤ªå°‘äº†ï¼Œç„¶åæœ‰äº›çŸ¥è¯†ç‚¹ä¼šä½†ç»ƒå¾—ä¸å¤Ÿï¼Œè¿˜æœ‰ä¸ä¼šå¡å¸¸ ä»Šå¹´çœé€‰çš„é¢˜ä¹Ÿæ˜¯åƒåœ¾ï¼Œ5/6 åŸé¢˜ ç„¶åå¼±çœç»ˆç©¶æ˜¯å¼±çœï¼Œçº¿ä¸åˆ° 200 æ€•ä¸æ˜¯ç å…¨æš´åŠ› = è¿›é˜Ÿ ","link":"https://imzzy1201.github.io/post/akubgc5lY/"},{"title":"ç¬”è®° - åç¼€æ•°æ®ç»“æ„","content":" Everythings comes full circle. åç¼€æ•°æ®ç»“æ„æ˜¯è§£å†³å­—ç¬¦ä¸²ç›¸å…³é—®é¢˜çš„åˆ©å™¨ï¼Œå…¶å…·æœ‰ä»£ç çŸ­ã€æ¿å­å¥½è®°ã€æ—¶é—´å¤æ‚åº¦ä½ã€åº”ç”¨å¹¿æ³›çš„ä¼˜ç‚¹ã€‚ æ­¤ä»‹ç» 2 ç§å¸¸ç”¨ç»“æ„ï¼šåç¼€æ ‘ã€åç¼€æ•°ç»„ å‰ç½®çº¦å®š Ïµ\\epsilonÏµ ä¸ºç©ºä¸² SSS ä¸ºåŸä¸²ï¼Œå…¶ä¸‹æ ‡ä» 111 å¼€å§‹ n=âˆ£Sâˆ£n=|S|n=âˆ£Sâˆ£ ä¸º SSS çš„é•¿åº¦ï¼Œä»£ç ä¸­å…¶æœ€å¤§å€¼ç”¨ maxn è¡¨ç¤º S[i]S[i]S[i] ä¸º SSS çš„ç¬¬ iii ä¸ªå­—ç¬¦ S[l..r]S[l..r]S[l..r] ä¸º SSS ä¸­ç¬¬ lll ä¸ªå­—ç¬¦åˆ°ç¬¬ rrr ä¸ªå­—ç¬¦é¡ºåºè¿æ¥å½¢æˆçš„å­ä¸² SiS^iSi ä¸º SSS çš„ä»¥ç¬¬ iii ä¸ªå­—ç¬¦ä¸ºèµ·å§‹çš„åç¼€ï¼Œå³ S[i..n]S[i..n]S[i..n] SiS_iSiâ€‹ ä¸º SSS çš„ä»¥ç¬¬ iii ä¸ªå­—ç¬¦ä¸ºæœ«å°¾çš„å‰ç¼€ï¼Œå³ S[1..i]S[1..i]S[1..i] S1S2â€¾\\overline{S_1S_2}S1â€‹S2â€‹â€‹ è¡¨ç¤º S1S_1S1â€‹ å’Œ S2S_2S2â€‹ ä¸²è¿å¾—åˆ°çš„å­—ç¬¦ä¸² Î£\\SigmaÎ£ ä¸º SSS çš„å­—ç¬¦é›† âˆ£Î£âˆ£|\\Sigma|âˆ£Î£âˆ£ ä¸º SSS çš„å­—ç¬¦é›†çš„å…ƒç´ ä¸ªæ•°ï¼Œä»£ç ä¸­å…¶æœ€å¤§å€¼ç”¨ maxm è¡¨ç¤º åç¼€æ ‘ å‰ç½®çŸ¥è¯† å­—ç¬¦ä¸²å’Œæ ‘çš„å®šä¹‰ä¸åŸºç¡€çŸ¥è¯† å­—å…¸æ ‘ï¼ˆTrieï¼‰ å®šä¹‰ ä¸ºäº†æ–¹ä¾¿æè¿°ï¼Œæˆ‘ä»¬å…ˆä½œå‡ºå¦‚ä¸‹å‡ ä¸ªç‰¹æ®Šå®šä¹‰ï¼š è¾¹çš„æ ‡è®°ä¸²ï¼šè¾¹ä¸Šçš„å­—ç¬¦ä¸² è·¯å¾„çš„æ ‡è®°ä¸²ï¼šAAA å’Œ BBB ä¸¤èŠ‚ç‚¹ï¼ˆçº¦å®š AAA æ˜¯ BBB çš„ç¥–å…ˆï¼‰é—´çš„è·¯å¾„æ ‡è®°ä¸ºï¼Œä»æµ…åˆ°æ·±ï¼Œä¸²è¿ä» AAA åˆ° BBB çš„å”¯ä¸€è·¯å¾„ç»è¿‡çš„æ‰€æœ‰è¾¹çš„æ ‡è®°ä¸²ï¼Œæ‰€å¾—åˆ°çš„æ–°ä¸² èŠ‚ç‚¹å¯¹åº”çš„ä¸²ï¼šAAA èŠ‚ç‚¹å¯¹åº”çš„ä¸²å³ä¸ºä»æ ¹èŠ‚ç‚¹åˆ° AAA çš„è·¯å¾„æ ‡è®°ä¸² ä¸€ä¸ªä¸²åœ¨åç¼€æ ‘ä¸­ï¼šå³å…¶å¯è¢«è¡¨ç¤ºä¸ºæŸä¸ªèŠ‚ç‚¹å¯¹åº”ä¸²çš„å‰ç¼€ ä¸€ä¸ªä¸²åœ¨èŠ‚ç‚¹ AAA ä¸Šï¼šå³ AAA çš„å¯¹åº”ä¸²å°±æ˜¯è¿™ä¸ªä¸² åç¼€æ ‘ï¼ˆSuffix Tree, SFTï¼‰å¯ä»¥çœ‹ä½œæ˜¯å‹ç¼©åçš„åç¼€å­—å…¸æ ‘ã€‚å…·ä½“æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªä¸² SSSï¼Œå…¶åç¼€æ ‘å¯ä»¥è®¤ä¸ºæ˜¯ï¼Œå°†å…¶æ‰€æœ‰åç¼€æ’å…¥ä¸€ä¸ªå­—å…¸æ ‘ä¸­ï¼Œç„¶åå»æ‰æ‰€æœ‰å­èŠ‚ç‚¹ä¸ªæ•°ä¸º 111 çš„éæ ¹èŠ‚ç‚¹ï¼Œå¹¶åˆå¹¶å…¶çˆ¶è¾¹å’Œå…¶å”¯ä¸€çš„å­è¾¹ï¼ˆåˆå¹¶åçš„è¾¹æ ‡è®°ä¸²å³ä¸ºä»è¢«åˆ å»çš„èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹åˆ°å­èŠ‚ç‚¹çš„è·¯å¾„æ ‡è®°ä¸²ï¼‰ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹å›¾æ˜¯ä¸² S=bananaS=\\mathtt{banana}S=banana çš„åç¼€å­—å…¸æ ‘ï¼š ä¸‹å›¾æ˜¯å…¶åç¼€æ ‘ï¼š ä½†æˆ‘ä»¬å‘ç°ï¼Œå¹¶ä¸æ˜¯ SSS çš„æ‰€æœ‰åç¼€éƒ½åœ¨æŸä¸ªèŠ‚ç‚¹ä¸Šï¼Œæ¯”å¦‚ banana\\mathtt{banana}banana çš„åç¼€æ ‘ä¸­ na\\mathtt{na}na å°±ä¸åœ¨ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚è¿™ä¸ªé—®é¢˜åœ¨åº”ç”¨ä¸­ä¼šé€ æˆå¾ˆå¤šä¸ä¾¿ä¹‹å¤„ï¼Œæ‰€ä»¥ä¸€èˆ¬è€Œè¨€è¯´ SSS çš„åç¼€æ ‘æŒ‡çš„æ˜¯åœ¨æœ«å°¾åŠ ä¸€ä¸ªç»“æŸç¬¦ $\\mathtt{\\$}$ åå¾—åˆ°çš„ä¸²çš„åç¼€æ ‘ï¼Œå³ S $â€¾\\overline{S\\;\\mathtt{\\$}}S$â€‹ çš„åç¼€æ ‘ï¼š è¿™æ ·å°±ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜äº†ã€‚ æ€§è´¨ åç¼€æ ‘çš„æ€§è´¨æ¯”è¾ƒæ˜¾ç„¶ï¼Œä½†æ— è®ºåœ¨æ„é€ ä¸­è¿˜æ˜¯åœ¨è§£é¢˜ä¸­éƒ½éå¸¸é‡è¦ï¼Œä¸‹é¢ç»™å‡ºå‡ ä¸ªå¸¸ç”¨çš„ï¼š æ‰€æœ‰éæ ¹èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¸ªæ•°éƒ½ä¸ä¸º 111 åŸä¸²çš„æ‰€æœ‰è¿ç»­å­ä¸²åœ¨åç¼€æ ‘ä¸­ æ‰€æœ‰ä¸æ˜¯åŸä¸²è¿ç»­å­ä¸²çš„å­—ç¬¦ä¸²éƒ½ä¸åœ¨åç¼€æ ‘ä¸­ è‹¥åŸä¸²åŒ…å«ç»“æŸç¬¦ï¼Œé‚£ä¹ˆåŸä¸²çš„æ‰€æœ‰åç¼€ä¸²éƒ½åœ¨æŸä¸ªèŠ‚ç‚¹ä¸Š æ³¨ï¼šåæ–‡è®²ç®€ç§°è¿™äº›æ€§è´¨ä¸ºâ€œæ€§è´¨ 1 â€â€œæ€§è´¨ 3 â€ç­‰ï¼ˆåæ–‡æ–¹æ¡ˆã€æƒ…å†µç­‰åŒæ­¤è¡¨è¾¾ï¼‰ è¡¨ç¤ºæ–¹å¼ æ³¨æ„åˆ°æ‰€æœ‰è¾¹çš„æ ‡è®°ä¸²éƒ½æ˜¯åŸä¸²çš„è¿ç»­å­ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šç›´æ¥è®°å½•æ ‡è®°ä¸²ï¼Œè€Œæ˜¯å¯¹å…¶æ ‡è®°ä¸€ä¸ªæœ‰åºæ•°å¯¹ (pos, len)(pos,\\,len)(pos,len)ï¼Œè¡¨ç¤ºå…¶å¯¹åº”åŸä¸²è¿ç»­å­ä¸²çš„èµ·å§‹ä½ç½®å’Œé•¿åº¦ã€‚ç‰¹åˆ«çš„ï¼Œå¦‚æœæ ‡è®°ä¸²ä¸ºåŸä¸²çš„åç¼€ï¼Œä¸ºäº†æ–¹ä¾¿åç»­æ“ä½œæˆ‘ä»¬å°†å…¶é•¿åº¦ lenlenlen è®°ä¸º infâ¡\\infinfã€‚æ¯”å¦‚ä¸Šå›¾ä¸­æ ‡è®°ä¸º banana$\\mathtt{banana\\$}banana$ çš„è¾¹æˆ‘ä»¬è®°ä¸º (1, infâ¡)(1,\\,\\inf)(1,inf)ï¼Œæ ‡è®°ä¸º aaa çš„è¾¹æˆ‘ä»¬è®°ä¸º (2,1)(2,1)(2,1)ã€‚è¾¹æˆ‘ä»¬è®°å½•åœ¨èŠ‚ç‚¹çš„ç»“æ„ä½“ä¸­ï¼ˆå³è®°å½•ä¸ºçˆ¶è¾¹ï¼‰ å…¶å®ƒçš„ä¸œè¥¿è·Ÿ Trie çš„è®°å½•æ–¹å¼ç›¸åŒã€‚ ä¸‹é¢ç»™å‡ºä¸€ä¸ªå‚è€ƒçš„èŠ‚ç‚¹ç»“æ„ä½“ï¼š struct NODE{ std::pair&lt;int,int&gt; fa; // å³çˆ¶è¾¹ int ch[maxm]; // ch[i] è¡¨ç¤ºä»¥ i ä¸ºå§‹çš„å­è¾¹è¿æ¥çš„å­èŠ‚ç‚¹ç¼–å· } æ„å»º æœ´ç´ æ„å»ºæ–¹å¼ æ ¹æ®å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªæœ´ç´ æ„å»ºæ–¹æ³•ã€‚æˆ‘ä»¬æ–°å»ºä¸€ä¸ª Trieï¼Œå°†æ‰€æœ‰åç¼€é¡ºåºæ’å…¥ï¼Œç„¶åæ ¹æ®åç¼€æ ‘çš„å‹ç¼©è¦æ±‚å‹ç¼© Trieï¼Œå¾—åˆ°ç»“æœã€‚ å¾ˆå®¹æ˜“åˆ†æå‡ºï¼Œè¿™ä¸ªæ–¹æ³•çš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦å‡ä¸º O(n2)\\mathcal{O}(n^2)O(n2)ï¼Œæ˜¯å¾ˆæ…¢çš„ã€‚æˆ‘ä»¬è€ƒè™‘ä¼˜åŒ–ï¼Œå‘ç°è¿™ä¸ªæ–¹æ³•æ ¹æœ¬ä¸å¥½ä¼˜åŒ–ã€‚ äºæ˜¯ä¹å¦ä¸€ä¸ªæ„å»ºçš„æ€æƒ³åº”è¿è€Œç”Ÿã€‚ éšå¼æ ‘æ„å»º åå­—æ˜¯ä¸ªå¹Œå­ æ‰€è°“éšå¼æ ‘æ„å»ºå…¶å®å°±æ˜¯ä»å°åˆ°å¤§é€’æ¨æ„å»º SSS çš„å‰ç¼€ä¸²çš„åç¼€æ ‘ï¼Œæˆ–è€…è¯´ç»´æŠ¤åç¼€æ ‘æ¯æ¬¡å¾€åŸä¸²è¿½åŠ ä¸€ä¸ªå­—ç¬¦ï¼ˆä»¥åç§°æ­¤ä¸ºä¸€è½®æ’å…¥ï¼‰ï¼Œæœ€ç»ˆæ„å»ºå‡ºæ•´ä¸ªåŒ…æ‹¬ç»“æŸç¬¦çš„ä¸²çš„åç¼€æ ‘ã€‚è¿™ä¸ªæ–¹æ³•çœ‹ä¼¼æ¯”æœ´ç´ æ„å»ºæ–¹å¼è¿˜æ…¢ï¼Œä½†ä¼˜åŒ–åå®ƒå¯ä»¥è¾¾åˆ°çº¿æ€§æ—¶é—´ã€‚ä¸‹é¢æˆ‘ä»¬ä»æš´åŠ›å¼€å§‹ï¼Œä¸€æ­¥ä¸€æ­¥ä¼˜åŒ–ï¼Œå†å¾—åˆ°å®ƒçš„çº¿æ€§æ„é€ æ–¹æ³•ã€‚ æš´åŠ› é¦–å…ˆè¦å‘ç°è¿™ä¸ªæ–¹æ³•çš„ä¸€ä¸ªç®—çš„ä¸Šå¾ˆä¼˜çš„æ€§è´¨ï¼Œå°±æ˜¯è‹¥ l&lt;rl&lt;rl&lt;rï¼Œåˆ™ SrS_rSrâ€‹ çš„åç¼€æ ‘å¿…å®šåŒ…å« SlS_lSlâ€‹ çš„åç¼€æ ‘ã€‚ä¹Ÿå°±æ˜¯åœ¨ä¸Šé¢è¯´çš„æ’å…¥ä¸€ä¸ªå­—ç¬¦åï¼Œåç¼€æ ‘åªå¯èƒ½å‘ç”Ÿçš„ä¸€ç³»åˆ—å˜åŒ–åªå¯èƒ½æœ‰ä¸‰ç§ï¼šä¸€ç§æ˜¯ä»æŸä¸ªèŠ‚ç‚¹ä¼¸å‡ºä¸€æ¡è¾¹æŒ‡å‘ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼›ä¸€ç§æ˜¯å°†ä¸€æ¡è¾¹åˆ‡æ–­ä¸ºä¸Šä¸‹ä¸¤éƒ¨åˆ†ï¼Œä¸­é—´æ–°å»ºä¸€ä¸ªèŠ‚ç‚¹è¿æ¥ï¼ˆåæ–‡ç§°å…¶ä¸ºåˆ†è£‚ï¼‰ï¼›å¦ä¸€ç§æ˜¯å¾€ä¸€æ¡è¾¹çš„æ ‡è®°ä¸²è¿½åŠ ä¸€ä¸ªå­—ç¬¦ã€‚ ç°åœ¨æˆ‘ä»¬æ¥è®¨è®ºåœ¨æ’å…¥ S[i..j]S[i..j]S[i..j]ï¼Œå³æ„å»º SjS_jSjâ€‹ çš„åç¼€æ ‘æ—¶æ’å…¥ (Sj)i(S_j)^i(Sjâ€‹)i å‡ºç°çš„æƒ…å†µ å¦‚æœ S[i..j]S[i..j]S[i..j] å·²ç»åœ¨åç¼€æ ‘é‡Œäº†ï¼Œé‚£æ˜¾ç„¶å¯ä»¥ä¸ç”¨ç®¡å®ƒï¼Œä¸‹é¢è®¨è®ºå¦‚æœ S[i..j]S[i..j]S[i..j] ä¸åœ¨åç¼€æ ‘é‡Œè¯¥å¦‚ä½•æ“ä½œã€‚ é¦–å…ˆï¼Œæ ¹æ® æ€§è´¨ 2ï¼Œæˆ‘ä»¬çŸ¥é“åŸæ ‘ä¸­å¿…å®šæœ‰ S[i..jâˆ’1]S[i..j-1]S[i..jâˆ’1]ï¼Œä½†å®ƒæ—¢å¯èƒ½æ­£å¥½æ˜¯æŸä¸ªèŠ‚ç‚¹çš„å¯¹åº”ä¸²ï¼Œä¹Ÿå¯èƒ½ä¸æ˜¯ã€‚é‚£ä¹ˆæˆ‘ä»¬å…ˆå‡è®¾å®ƒæ˜¯ AAA çš„å¯¹åº”ä¸²çš„å‰ç¼€ï¼ˆä¸ºäº†ä¿è¯å”¯ä¸€æ€§ï¼Œæˆ‘ä»¬ä»¤ AAA ä¸ºæ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„èŠ‚ç‚¹ä¸­æ·±åº¦æœ€å°çš„ä¸€ä¸ªï¼‰ å¦‚æœ S[i..jâˆ’1]S[i..j-1]S[i..jâˆ’1] æ­£å¥½åœ¨èŠ‚ç‚¹ AAA ä¸Šï¼Œé‚£å¾ˆå¥½åŠäº†ï¼š å¦‚æœ AAA æ˜¯å¶å­èŠ‚ç‚¹ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨ AAA çš„çˆ¶è¾¹æ ‡è®°ä¸²æœ€åè¿½åŠ ä¸€ä¸ª S[j]S[j]S[j] å°±å¥½äº†ã€‚åˆå› ä¸º AAA çš„å¯¹åº”ä¸²æ­£å¥½ä¹Ÿæ˜¯ Sjâˆ’1S_{j-1}Sjâˆ’1â€‹ çš„åç¼€ï¼Œè€Œè¿½åŠ å AAA çš„çˆ¶è¾¹åˆæˆäº† SjS_jSjâ€‹ çš„åç¼€ï¼Œæ‰€ä»¥è¿½åŠ å‰å AAA çš„çˆ¶è¾¹çš„ lenlenlen ä¸€ç›´éƒ½æ˜¯ infâ¡\\infinfï¼Œå³ä¸ç”¨æ”¹å˜å…¶è¾¹çš„æ ‡è®°ã€‚æˆ–è€…ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬å°±è·³è¿‡å®ƒï¼å†å¦‚æœ AAA ä¸æ˜¯å¶å­èŠ‚ç‚¹ï¼Œä¹Ÿå¾ˆå¥½åŠï¼Œæˆ‘ä»¬ä» AAA ä¼¸å‡ºä¸€æ¡è¾¹ï¼Œå¯¹åº”ä¸²ä¸º S[j]S[j]S[j] çš„è¾¹ï¼ˆæ ‡è®°ä¸º (j, infâ¡)(j,\\,\\inf)(j,inf)ï¼‰ï¼ŒæŒ‡å‘ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹å°±å¥½ã€‚æ³¨æ„è¿™é‡Œçš„å¶å­èŠ‚ç‚¹ä¸èƒ½åŒ…æ‹¬æ ¹èŠ‚ç‚¹ï¼Œå› ä¸ºæ ¹èŠ‚ç‚¹æ²¡æœ‰çˆ¶è¾¹ã€‚ ç¨åŠ æ€è€ƒå°±èƒ½å‘ç°ä¸Šé¢ä¸¤ä¸ªæ“ä½œæ–¹æ³•ç¬¦åˆåç¼€æ ‘çš„æ„é€ è¦æ±‚ã€‚ ç„¶è€Œå¦ä¸€ç§æƒ…å†µå°±ç¨å¾®éº»çƒ¦ä¸€ç‚¹äº†ï¼Œå¦‚æœ S[i..jâˆ’1]S[i..j-1]S[i..jâˆ’1] æ˜¯ AAA å¯¹åº”ä¸²çš„çœŸå‰ç¼€ï¼ˆå³ä¸ AAA çš„å¯¹åº”ä¸²ä¸åŒä½†ä¸ºå…¶å‰ç¼€ï¼‰ï¼Œåˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å…ˆè®° AAA çš„å¯¹åº”ä¸²ä¸º Sâ€²S&#x27;Sâ€²ï¼Œå‡è®¾ S[i..jâˆ’1]=Skâ€²S[i..j-1]=S&#x27;_kS[i..jâˆ’1]=Skâ€²â€‹ã€‚æ ¹æ®åç¼€æ ‘ç”±åç¼€ Trie å‹ç¼©å¾—åˆ°çš„å®šä¹‰ï¼Œæˆ‘ä»¬çŸ¥é“æœ¬æ¥åº”è¯¥ä»åç¼€ Trie ä¸Šå¯¹åº”ä¸²ä¸º Skâ€²S&#x27;_kSkâ€²â€‹ çš„èŠ‚ç‚¹ KKK å¤„ä¼¸å‡ºä¸€æ¡å¯¹åº”ä¸²ä¸º S[j]S[j]S[j] çš„è¾¹ã€‚ç„¶è€Œè¿™ä¸ª KKK å´ä¸åœ¨åç¼€æ ‘ä¸Šï¼Œå› ä¸ºå®ƒåœ¨åŸæ¥çš„åç¼€æ ‘å‹ç¼©çš„æ—¶å€™è¢«æ‰”äº†ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±åº”è¯¥æŠŠå®ƒæ¡å›æ¥ï¼Œæˆ–è€…è¯´åœ¨è¿™é‡Œåˆ†è£‚å‡ºä¸€ä¸ªå¯¹åº”ä¸²ä¸º Skâ€²S&#x27;_kSkâ€²â€‹ çš„èŠ‚ç‚¹ KKKï¼Œç„¶ååƒ Trie ä¸Šæ’å…¥ä¸€æ ·ä»è¿™ä¸ªèŠ‚ç‚¹ä¸Šä¼¸å‡ºä¸€æ¡å¯¹åº”ä¸²ä¸º S[j]S[j]S[j] çš„è¾¹ï¼ˆæ ‡è®°ä¸º (j, infâ¡)(j,\\,\\inf)(j,inf)ï¼‰ã€‚ æ€»ç»“æ¥è¯´ï¼Œåˆ† ä¸‰ç§æ–¹æ¡ˆ ï¼š å¦‚æœ S[i..j]S[i..j]S[i..j] åœ¨åç¼€æ ‘ä¸­æˆ– S[i..jâˆ’1]S[i..j-1]S[i..jâˆ’1] æ˜¯æŸä¸ªéæ ¹çš„å¶èŠ‚ç‚¹ AAA çš„å¯¹åº”ä¸² ä¸ç®¡å®ƒ å¦‚æœ S[i..j]S[i..j]S[i..j] åœ¨ä¸åç¼€æ ‘ä¸­ä¸” S[i..jâˆ’1]S[i..j-1]S[i..jâˆ’1] ä¸æ ¹èŠ‚ç‚¹æˆ–æŸä¸ªéå¶å­èŠ‚ç‚¹ AAA çš„å¯¹åº”ä¸²ç›¸åŒ ä» AAA ä¼¸å‡ºä¸€æ¡æ ‡è®°ä¸º (j, infâ¡)(j,\\,\\inf)(j,inf) çš„è¾¹ å…¶å®ƒæƒ…å†µ åˆ†è£‚å‡ºä¸€ä¸ªå¯¹åº”ä¸²ä¸º S[i..jâˆ’1]S[i..j-1]S[i..jâˆ’1] çš„èŠ‚ç‚¹ï¼Œä»å…¶ä¼¸å‡ºä¸€æ¡æ ‡è®°ä¸º (j, infâ¡)(j,\\,\\inf)(j,inf) çš„è¾¹ æˆ‘ä»¬æŒ‰ç…§ä¸Šè¿°æ–¹æ¡ˆä»é•¿åˆ°çŸ­æ’å…¥å³å¯ã€‚ æ²¡æœ‰ä»€ä¹ˆæ¯”ä¸¾ä¾‹å­æ›´å¥½è¯´æ˜çš„æ–¹æ³•äº†ï¼Œä¸‹é¢æˆ‘ä»¬ä¸¾ä¾‹æ„é€  cacfccf$\\mathtt{cacfccf\\$}cacfccf$ çš„åç¼€æ ‘ï¼ˆå›¾ä¸­çº¢è‰²çš„è¾¹å³ä¸ºæ­¤æ¬¡æ’å…¥æ—¶ä¿®æ”¹è¿‡çš„è¾¹ï¼‰ï¼š é¦–å…ˆæˆ‘ä»¬æœ‰ä¸ªæ ¹èŠ‚ç‚¹ 0 c\\mathtt{c}c æ¥äº†ï¼Œæ’å…¥ä¸² c\\mathtt{c}cã€‚æˆ‘ä»¬å‘ç°ä¸Šæ–‡æåˆ°çš„ S[i..jâˆ’1]S[i..j-1]S[i..jâˆ’1] å³ S[1..0]S[1..0]S[1..0] å³ç©ºä¸²ï¼Œåœ¨èŠ‚ç‚¹ 0 ä¸Šï¼Œè€Œ 0 æ˜¯æ ¹èŠ‚ç‚¹ã€‚æ‰€ä»¥æ ¹æ® æ–¹æ¡ˆ 2 ï¼Œæˆ‘ä»¬ä¼¸å‡ºä¸€æ¡æ ‡è®°ä¸º (1, infâ¡)(1,\\,\\inf)(1,inf) çš„è¾¹ ç„¶å a\\mathtt{a}a æ¥äº†ï¼Œäºæ˜¯æˆ‘ä»¬æ’å…¥ä¸² {a,ca}\\{\\mathtt{a},\\mathtt{ca}\\}{a,ca}ã€‚å¯¹äº ca\\mathtt{ca}ca è§‚å¯Ÿåˆ°ä¸² c\\mathtt{c}c åœ¨èŠ‚ç‚¹ 1 ä¸Šï¼Œè€Œ 1 æ˜¯å¶èŠ‚ç‚¹ï¼Œæ‰€ä»¥å¥—ç”¨ æ–¹æ¡ˆ 1 ï¼›å¯¹äº a\\mathtt{a}a è§‚å¯Ÿåˆ°ç©ºä¸²åœ¨èŠ‚ç‚¹ 0 ä¸Šï¼Œè€Œ 0 æ˜¯æ ¹èŠ‚ç‚¹ï¼Œæ‰€ä»¥å¥—ç”¨ æ–¹æ¡ˆ 2 åˆæ¥äº†ä¸ª c\\mathtt{c}cï¼Œæˆ‘ä»¬è¦æ’å…¥ä¸² {c,ac,cac}\\{\\mathtt{c},\\mathtt{ac},\\mathtt{cac}\\}{c,ac,cac}ã€‚cac\\mathtt{cac}cac å’Œ ac\\mathtt{ac}ac éƒ½å› ä¸ºâ€œS[i..jâˆ’1]S[i..j-1]S[i..jâˆ’1] åœ¨æŸä¸ªéæ ¹çš„å¶èŠ‚ç‚¹ AAA ä¸Šâ€è€Œå¥—ç”¨ æ–¹æ¡ˆ 1 ï¼Œc\\mathtt{c}c åˆ™å› æœ¬èº«å°±åœ¨åç¼€æ ‘ä¸­è€Œä¹Ÿå¥—ç”¨äº† æ–¹æ¡ˆ 1 . f\\mathtt{f}f æ¥äº†ï¼Œæ’å…¥ä¸² {f,cf,acf,cacf}\\{\\mathtt{f},\\mathtt{cf},\\mathtt{acf},\\mathtt{cacf}\\}{f,cf,acf,cacf}ã€‚æ’å…¥ cacf\\mathtt{cacf}cacf å’Œ acf\\mathtt{acf}acf æ—¶éƒ½å¥—ç”¨ æ–¹æ¡ˆ 1 ã€‚è€Œå½“æ’å…¥ cf\\mathtt{cf}cf æ—¶ï¼Œæˆ‘ä»¬å‘ç° c\\mathtt{c}c åœ¨åŸæ ‘ä¸­ä¸åœ¨ä»»ä½•èŠ‚ç‚¹ä¸Šï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¾—ç”¨ æ–¹æ¡ˆ 3 äº†ï¼Œ åˆ†è£‚å‡ºèŠ‚ç‚¹ 3 å¯¹åº”ä¸² c\\mathtt{c}cï¼Œå†ä» 3 ä¼¸å‡ºæ ‡è®°ä¸º (4, infâ¡)(4,\\,\\inf)(4,inf) çš„è¾¹æŒ‡å‘æ–°èŠ‚ç‚¹ 4ã€‚æœ€åæ’å…¥ f\\mathtt{f}f å¥—ç”¨äº† æ–¹æ¡ˆ 2 ã€‚ å‰©ä¸‹çš„å‡ è½®æ“ä½œä¹Ÿç›¸ä¼¼ï¼Œè¿™é‡Œç»™å‡ºå›¾ï¼Œä¸å†ä½œè¯¦ç»†è¯´æ˜äº†ã€‚ å¯ä»¥å‘ç°ï¼Œä¸€è½®è¦æ’å…¥ n+1n+1n+1 ä¸ªå­—ç¬¦ï¼Œæ’å…¥ç¬¬ iii ä¸ªå­—ç¬¦æ—¶è¦æ‰§è¡Œ iii æ¬¡æ–¹æ¡ˆï¼Œæ¯æ¬¡æ‰§è¡Œæ–¹æ¡ˆå‰éƒ½è¿˜è¦åœ¨åç¼€æ ‘ä¸­å®šä½ä¸²çš„ä½ç½®ï¼Œæ‰€ä»¥æ€»å¤æ‚åº¦ä¸º O(n3)\\mathcal{O}(n^3)O(n3)ï¼Œç”šè‡³æ¯”æœ´ç´ æ„å»ºæ–¹æ³•è¿˜æ…¢â€¦â€¦æ‰€ä»¥æˆ‘ä»¬æœ‰äº†ä¼˜åŒ– ä¼˜åŒ– ä»”ç»†çœ‹ä¸Šé¢çš„å›¾ï¼Œæˆ‘ä»¬ä¼šå‘ç°å…¶ä¸­æ‰§è¡Œäº†å¾ˆå¤šæ¬¡ æ–¹æ¡ˆ 1 ï¼Œè€Œ æ–¹æ¡ˆ 1 äº‹å®ä¸Šæ ¹æœ¬æ²¡æœ‰æ”¹å˜åŸæ ‘ã€‚å› æ­¤æˆ‘ä»¬å°è¯•é¢„åˆ¤æ’å…¥ä¸²æ—¶å“ªäº›å°†è¦æ‰§è¡Œ æ–¹æ¡ˆ 1 ï¼Œå¹¶è·³è¿‡å®ƒï¼Œæˆ–è€…è¯´å°½é‡é¿å¼€ æ–¹æ¡ˆ 1 ã€‚ å‡å®šç°åœ¨æ’å…¥çš„ä¸²æ˜¯ S[i..j]S[i..j]S[i..j]ï¼Œæˆ‘ä»¬ç°åœ¨å†æŠŠ æ–¹æ¡ˆ 1 ç»†åˆ†æˆ ä¸¤ä¸ªæƒ…å†µ ï¼š S[i..j]S[i..j]S[i..j] å·²ç»åœ¨åç¼€æ ‘ä¸­äº† S[i..jâˆ’1]S[i..j-1]S[i..jâˆ’1] æ˜¯éæ ¹å¶èŠ‚ç‚¹ AAA çš„å¯¹åº”ä¸² ä¸‹é¢å°±æ¨å¯¼å‡ ä¸ªä¸ä¼˜åŒ–ç›¸å…³çš„é‡è¦ æ–°æ€§è´¨ ï¼š ä»”ç»†è§‚å¯Ÿï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæ ¹æ®åç¼€æ ‘çš„ æ€§è´¨ 2,3 ï¼Œå¦‚æœåç¼€æ ‘é‡Œæœ‰ä¸² Sâ€²S&#x27;Sâ€² é‚£ä¹ˆ Sâ€²S&#x27;Sâ€² å¿…å®šæ˜¯åŸä¸²çš„è¿ç»­å­ä¸²ï¼Œè€Œä¸” Sâ€²S&#x27;Sâ€² çš„æ‰€æœ‰è¿ç»­å­ä¸²ä¹Ÿåœ¨åç¼€æ ‘ä¸­ã€‚é‚£ä¹ˆï¼Œæ—¢ç„¶ S[i..j]S[i..j]S[i..j] å·²ç»åœ¨æ ‘ä¸­äº†ï¼Œæ‰€ä»¥ S[i+1..j], S[i+2..j],â‹¯ , S[j..j]S_[i+1..j],\\,S[i+2..j],\\cdots,\\,S[j..j]S[â€‹i+1..j],S[i+2..j],â‹¯,S[j..j] ä¹Ÿéƒ½åœ¨åç¼€æ ‘ä¸­ã€‚å› æ­¤æ˜¾ç„¶ï¼Œæ‰€æœ‰æ­¤è½®éœ€è¦æ’å…¥çš„æ¯” S[i..j]S[i..j]S[i..j] çŸ­çš„æ‰€æœ‰ä¸²ï¼Œéƒ½åœ¨æ ‘ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æ’å…¥æ—¶é‡åˆ°äº† æƒ…å†µ 1 ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»“æŸæ­¤è½®æ’å…¥ã€‚ å†çœ‹åˆ°å¦‚æœ S[i..j]S[i..j]S[i..j] æ»¡è¶³ æƒ…å†µ 2 ï¼Œé‚£ä¹ˆ S[iâˆ’1..j], S[iâˆ’2..j],â‹¯ , S[1..j]S[i-1..j],\\,S[i-2..j],\\cdots,\\,S[1..j]S[iâˆ’1..j],S[iâˆ’2..j],â‹¯,S[1..j] ä¹Ÿè‚¯å®šæ»¡è¶³ æƒ…å†µ 2 ã€‚ä¸‹é¢ç»™å‡ºä¸€ä¸ªç®€å•çš„è¯æ˜ï¼š åè¯æ³•ï¼Œå‡è®¾ S[iâˆ’k,jâˆ’1] (0&lt;k&lt;i)S[i-k,j-1]\\ (0&lt;k&lt;i)S[iâˆ’k,jâˆ’1] (0&lt;k&lt;i) ä¸åœ¨éæ ¹å¶èŠ‚ç‚¹ä¸Šï¼Œé‚£ä¹ˆæ ¹æ® æ€§è´¨ 2,3 ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¿…å®šå­˜åœ¨ä¸€ä¸ªéç©ºä¸²ä¸² Sâ€²S&#x27;Sâ€² ä½¿å¾— S[iâˆ’k..jâˆ’1]Sâ€²â€¾\\overline{S[i-k..j-1]S&#x27;}S[iâˆ’k..jâˆ’1]Sâ€²â€‹ ä¹Ÿåœ¨åç¼€æ ‘ä¸­ï¼ˆå¦åˆ™ S[iâˆ’k..jâˆ’1]S[i-k..j-1]S[iâˆ’k..jâˆ’1] å°±åœ¨å¶èŠ‚ç‚¹ä¸Šäº†ï¼‰ï¼Œå†ç”¨ä¸€é æ€§è´¨ 2 æˆ‘ä»¬å°±å¾—åˆ° S[i,jâˆ’1]Sâ€²â€¾\\overline{S[i,j-1]S&#x27;}S[i,jâˆ’1]Sâ€²â€‹ ä¹Ÿåœ¨æ ‘ä¸­ï¼ˆå› ä¸ºå…¶æ˜¯ S[iâˆ’k..jâˆ’1]Sâ€²â€¾\\overline{S[i-k..j-1]S&#x27;}S[iâˆ’k..jâˆ’1]Sâ€²â€‹ çš„åç¼€ï¼‰ï¼Œæ‰€ä»¥ S[i..jâˆ’1]S[i..j-1]S[i..jâˆ’1] ä¹Ÿä¸åœ¨å¶èŠ‚ç‚¹ä¸Šï¼Œä¸é¢˜è®¾çŸ›ç›¾ï¼ åˆšåˆšä¸Šé¢çš„é‚£ä¸ªæ–°æ€§è´¨ä¼¼ä¹ç›´æ¥ä¸å¤ªå¥½ç”¨ï¼Œéœ€è¦é…åˆå¦ä¸€ä¸ªæ€§è´¨æ‰å¥½ã€‚å¦‚æœ S[i..j]S[i..j]S[i..j] æ»¡è¶³ æƒ…å†µ 2 ï¼Œé‚£ä¹ˆ S[i..j+1]S[i..j+1]S[i..j+1] ä¹Ÿæ»¡è¶³ æƒ…å†µ 2 ã€‚è¿™ä¸ªå¾ˆå¥½è¯ï¼Œå¯ä»¥è‡ªè¡Œè¯æ˜æˆ–æ„Ÿæ€§ç†è§£ä¸€ä¸‹å°±å¥½äº†ã€‚ é‡è¦çš„æ˜¯ï¼Œæ ¹æ®åˆšåˆšè®²çš„ä¸¤ä¸ªæ–°æ€§è´¨ï¼Œæˆ‘ä»¬åˆå¾—åˆ°äº†ä¸€ä¸ªå¾ˆæ£’çš„ä¼˜åŒ–ï¼šè‹¥æ’å…¥ SjS_jSjâ€‹ è¿™è½®æ“ä½œä¸­ï¼ŒS[i..j]S_[i..j]S[â€‹i..j] æ»¡è¶³äº† æƒ…å†µ 2 ï¼Œé‚£ä¹ˆä»¥åæ’å…¥ S[k] (k&gt;j)S[k]\\ (k&gt;j)S[k] (k&gt;j) çš„æ“ä½œä¸­å¯ä»¥ç›´æ¥ä» S[i+1..k]S[i+1..k]S[i+1..k] å¼€å§‹ æ€»ç»“æ¥è¯´ç°åœ¨æœ‰äº†ä¸¤ä¸ª ä¼˜åŒ– ï¼š å½“æ’å…¥æ—¶é‡åˆ°äº† æƒ…å†µ 1 ï¼Œç»“æŸæ­¤è½®æ’å…¥ è‹¥æ’å…¥ SjS_jSjâ€‹ è¿™è½®æ“ä½œä¸­ï¼ŒS[i..j]S[i..j]S[i..j] æ»¡è¶³äº† æƒ…å†µ 2 ï¼Œé‚£ä¹ˆä»¥åæ’å…¥ S[k] (k&gt;j)S[k]\\ (k&gt;j)S[k] (k&gt;j) çš„æ“ä½œä¸­å¯ä»¥ç›´æ¥ä» S[i+1..k]S[i+1..k]S[i+1..k] å¼€å§‹ æˆ‘ä»¬è¿˜æ˜¯ä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ï¼š è¿™æ˜¯ä¼˜åŒ–åæ„é€  S=acamsam$S=\\mathtt{acamsam\\$}S=acamsam$ çš„æ­¥éª¤ï¼Œæ¯å¹…å›¾ä¸­éƒ½æ ‡æ³¨äº†å°è¯•æ’å…¥äº†å“ªäº›ä¸²ï¼Œç°è‰²æ˜¯å·²ç»è¢«è·³è¿‡çš„ä¸²ï¼Œçº¢è‰²æ˜¯ä¸Šè¿° æƒ…å†µ 1 ï¼Œæ©™è‰²æ˜¯ æƒ…å†µ 2 ï¼Œè“è‰²æ˜¯æ­£å¸¸æ’å…¥ï¼ˆ æ–¹æ¡ˆ 2,3 ï¼‰ è¿™ä¸ªä¼˜åŒ–çœ‹èµ·æ¥ä¸å¤§ï¼Œä½†å´ä¸ºçº¿æ€§æ—¶é—´åšäº†å¾ˆå¤§çš„è´¡çŒ®ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä¼˜åŒ–åæ’å…¥çš„ä¸²çš„ä¸ªæ•°ä¸€å®šæ˜¯çº¿æ€§çš„ï¼š æ»¡è¶³ æƒ…å†µ 1 çš„æ’å…¥æ˜¯ O(n)\\mathcal{O}(n)O(n) çš„ å› ä¸ºæ¯è½®æ’å…¥ä¸€ä½†ç¢°åˆ° æƒ…å†µ 1 å°±ç»“æŸäº†ï¼Œæ‰€ä»¥æ¯è½®æœ€å¤š 111 æ¬¡ æ»¡è¶³ æƒ…å†µ 2 çš„æ’å…¥æ˜¯ O(n)\\mathcal{O}(n)O(n) çš„ å› ä¸ºè¿™ä¸ªæƒ…å†µå½“ä¸”ä»…å½“åœ¨å¶èŠ‚ç‚¹ä¸Šæ’å…¥æ‰ä¼šå‡ºç°ï¼Œå¶èŠ‚ç‚¹ä¸€å…±æœ‰ n+1n+1n+1 ä¸ªï¼Œè€Œæ ¹æ® ä¼˜åŒ– 2 æ¯ä¸ªå¶èŠ‚ç‚¹ä¹Ÿéƒ½åªä¼šè¢«è®¿é—® 111 æ¬¡ ä¸æ»¡è¶³ æƒ…å†µ 1,2ï¼ˆå³ä¸æ˜¯ æ–¹æ¡ˆ 1 ï¼‰çš„æ’å…¥æ˜¯ O(n)\\mathcal{O}(n)O(n) çš„ å¯ä»¥çœ‹åˆ°æ—¢ç„¶ä¸æ˜¯ æ–¹æ¡ˆ 1 ï¼Œé‚£ä¹ˆè¿™æ¬¡æ’å…¥å¿…ç„¶ä¼šå¢åŠ è‡³å°‘ 111 ä¸ªèŠ‚ç‚¹ï¼Œè€Œæ ¹æ®åç¼€æ ‘ æ€§è´¨ 1 å¯ä»¥å¾—åˆ°å…¶è‡³å¤šæœ‰ 2n2n2n ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥è¿™ç±»æ’å…¥ä¸è¶…è¿‡ 2n2n2n æ¬¡ è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„è¿›æ­¥ï¼Œä½†æˆ‘ä»¬å‘ç°æ¯æ¬¡æ’å…¥æ—¶ä¾ç„¶å¾—é‡æ–°åœ¨åç¼€æ ‘ä¸­ç»™ä¸²ä¸²å®šä½ï¼Œè€Œè¿™å°±æ˜¯ O(n)\\mathcal{O}(n)O(n) çš„äº†ï¼Œæ‰€ä»¥æ€»æ—¶é—´å¤æ‚åº¦ä¾ç„¶ O(n2)\\mathcal{O}(n^2)O(n2)â€¦â€¦å› æ­¤åˆæœ‰äº†äºŒæ¬¡ä¼˜åŒ–ã€‚ äºŒæ¬¡ä¼˜åŒ– è§‚å¯Ÿåˆ°ä¸€æ¬¡ä¼˜åŒ–åæœ€è€—æ—¶é—´çš„æ˜¯æ¯æ¬¡åœ¨åç¼€æ ‘ä¸­å®šä½ä¸²ä¸²ï¼Œæˆ‘ä»¬è€ƒè™‘å¦‚ä½•é™ä½è¿™ä¸ªçš„å¤æ‚åº¦ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æ¯è½®æ’å…¥æ—¶å‡è®¾æœ€åè¿˜æ’å…¥äº†ä¸€ä¸ªç©ºä¸²ï¼ˆåæ–‡å°†ä½“ç°å…¶ç”¨å¤„ï¼‰ã€‚ ç°åœ¨å¼•å…¥ä¸¤ä¸ªæ–°æ¦‚å¿µ åç¼€é“¾ å¯¹äºä¸€ä¸ªèŠ‚ç‚¹ AAAï¼Œè‹¥å…¶å¯¹åº”ä¸²ä¸º S[l..r]S[l..r]S[l..r]ï¼Œé‚£ä¹ˆå®ƒçš„ åç¼€é“¾ link[A]link[A]link[A] æŒ‡å‘å¯¹åº”ä¸²ä¸º S[l+1..r]S[l+1..r]S[l+1..r] çš„èŠ‚ç‚¹ï¼ˆå¦‚æœä¸å­˜åœ¨è¿™æ ·çš„èŠ‚ç‚¹åˆ™æŒ‡å‘æ ¹èŠ‚ç‚¹ï¼‰ã€‚ æ´»åŠ¨ç‚¹ å³å½“å‰æ­£åœ¨æ’å…¥çš„åç¼€åœ¨åŸæ ‘ï¼ˆè¿˜æœªæ’å…¥æ­¤ä¸²æ—¶çš„åç¼€æ ‘ï¼‰ä¸­çš„ä½ç½®ï¼Œè¿™ä¸ªåç¼€æˆ‘ä»¬ç§°ä¸º æ´»åŠ¨ä¸² ã€‚ æ´»åŠ¨ç‚¹ æˆ‘ä»¬ç”¨ä¸€ä¸ªä¸‰å…ƒç»„ (now, rem, char)(now,\\,rem,\\,char)(now,rem,char) æ¥è®°å½•ï¼Œnownownow è¡¨ç¤ºæ´»åŠ¨ç‚¹ä½äºå“ªä¸ªèŠ‚ç‚¹çš„å­è¾¹ä¸Šï¼ˆæˆ–æ­£å¥½åœ¨èŠ‚ç‚¹ä¸Šï¼‰ï¼Œremremrem è¡¨ç¤ºæ´»åŠ¨ç‚¹åœ¨å­è¾¹ä¸Šçš„é•¿åº¦ï¼ˆå³èŠ‚ç‚¹å¯¹åº”ä¸²è¿ä¸Šå­è¾¹æ ‡è®°ä¸²çš„å‰ remremrem ä¸ªå­—ç¬¦å°±æ˜¯æ´»åŠ¨ä¸²ï¼‰ï¼Œcharcharchar è¡¨ç¤ºè¿™ä¸ªå­è¾¹çš„èµ·å§‹å­—ç¬¦ã€‚ è®°å½•è¿™ä¸¤ä¸ªä¸œè¥¿æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬ä¸‹é¢å°±æ¥è¯´ã€‚ è€ƒè™‘è¿™ä¸ª æ´»åŠ¨ç‚¹ çš„å«ä¹‰ï¼Œæˆ‘ä»¬å‘ç°ï¼Œä¸€è½®æ’å…¥åï¼Œæ¯”ç»“æŸæ’å…¥æ—¶çš„ æ´»åŠ¨ä¸² é•¿çš„æ‰€æœ‰åç¼€ï¼Œä¸€å®šéƒ½åœ¨åç¼€æ ‘çš„æŸä¸ªéæ ¹å¶èŠ‚ç‚¹ä¸Šï¼ˆè¿™ä¸ªä¸å¤ªå¥½è§£é‡Šï¼Œå¯ä»¥ç…§ç€åé¢çš„ä¾‹å­ç†è§£ä¸€ä¸‹ï¼‰ã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¿›è¡Œä¸‹ä¸€è½®æ“ä½œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»ä¸Šè½®æ’å…¥é—ç•™ä¸‹çš„ æ´»åŠ¨ä¸² åŠ ä¸Šæ–°æ’å…¥çš„å­—ç¬¦è¿™é‡Œå¼€å§‹æ’å…¥ï¼Œå†ç®€æ´ä¸€ç‚¹ï¼Œè¿›è¡Œä¸‹ä¸€è½®æ“ä½œæ—¶ï¼Œæˆ‘ä»¬åªç”¨å°†è€ æ´»åŠ¨ç‚¹ çš„ rem+1rem+1rem+1 å°±èƒ½å¾—åˆ°ç°éœ€çš„ æ´»åŠ¨ç‚¹ ã€‚ æ¯”å¦‚å¦‚æœä¸Šä¸€è½®æ’å…¥çš„åŸä¸²æ˜¯ abab\\mathtt{abab}ababï¼Œç»“æŸä¸Šè½®æ’å…¥æ—¶ æ´»åŠ¨ä¸² æ˜¯ ab\\mathtt{ab}abï¼Œæ­¤è½®æ’å…¥è¦è¿½åŠ å­—ç¬¦ c\\mathtt{c}cï¼Œé‚£ä¹ˆæ­¤è½®å°±å¯ä»¥ç›´æ¥ä» abc\\mathtt{abc}abc å¼€å§‹æ’å…¥ï¼›å¦‚æœä¸Šä¸€è½®æ’å…¥çš„åŸä¸²æ˜¯ abc\\mathtt{abc}abcï¼Œç»“æŸä¸Šè½®æ’å…¥æ—¶ æ´»åŠ¨ä¸² æ˜¯ç©ºä¸²ï¼Œæ­¤è½®æ’å…¥è¦è¿½åŠ å­—ç¬¦ d\\mathtt{d}dï¼Œé‚£ä¹ˆæ­¤è½®å°±å¯ä»¥ç›´æ¥ä» d\\mathtt{d}d å¼€å§‹æ’å…¥ã€‚ å†è€ƒè™‘ åç¼€é“¾ çš„æ€§è´¨ï¼Œæˆ‘ä»¬å‘ç°æ’å…¥ä¸€ä¸ªä¸²åï¼Œæˆ‘ä»¬å‘ç°ï¼Œå¦‚æœ nownownow ä¸ä¸ºæ ¹èŠ‚ç‚¹ï¼Œå°† nownownow æ›´æ”¹ä¸º link[now]link[now]link[now]ï¼›å¦‚æœ nownownow æ˜¯æ ¹èŠ‚ç‚¹ï¼Œåˆ™å°† remâˆ’1rem-1remâˆ’1ã€‚è¿™æ ·ï¼Œç»„æˆçš„æ–°ä¸‰å…ƒç»„å°±æ˜¯æ–°çš„ æ´»åŠ¨ç‚¹ ã€‚ ç°åœ¨å†æ¥è€ƒè™‘å¦‚ä½•ç»´æŠ¤ä¸Šé¢ä¸¤ä¸ªæ¦‚å¿µã€‚äº‹å®ä¸Šåœ¨ä¸Šè¿°å¯¹å…¶ä½œç”¨çš„è®²è§£ä¸­ï¼Œ æ´»åŠ¨ç‚¹ å·²ç»è¢«ç»´æŠ¤äº†ã€‚è€Œå¯¹äº åç¼€é“¾ ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€è½®æ“ä½œä¸­ï¼Œæ’å…¥çš„ç¬¬ä¸€ä¸ªä¸² åç¼€é“¾ æŒ‡å‘æ ¹èŠ‚ç‚¹ï¼›å…¶ä½™æ¯æ¬¡æ’å…¥æ–°ä¸²ï¼Œé‚£ä¹ˆå®ƒçš„ åç¼€é“¾ ä¸€å®šæŒ‡å‘ä¸Šä¸€æ¬¡æ’å…¥çš„ä¸²æ‰€åœ¨çš„èŠ‚ç‚¹ã€‚ æ³¨æ„å‰é¢å¯¹æ´»åŠ¨ç‚¹çš„ç»´æŠ¤è¿˜æœ‰ä¸€ä¸ªé—æ¼ï¼Œå°±æ˜¯åœ¨å‡ æ¬¡æ›´æ–°åå¯èƒ½ remremrem æ¯” nownownow çš„é¦–å­—æ¯ä¸º charcharchar çš„å­è¾¹è¿˜é•¿ï¼Œè¿™æ—¶æˆ‘ä»¬åº”è¯¥é¡ºç€å­è¾¹è·³åˆ°å®ƒçš„å­èŠ‚ç‚¹ï¼Œå¹¶æ›´æ–° remremrem å’Œ charcharcharã€‚ ä¸Šé¢å‡ ä¸ªåœ°æ–¹å…¶å®ä¸å¤ªå¥½è®²ä¹Ÿä¸å¤ªå¥½ç†è§£ï¼Œéœ€è¦æ£æ‘©ä¸€ä¸‹ï¼Œå¯ä»¥å¯¹ç…§ä¸€äº›ä¾‹å­å¸®åŠ©ç†è§£ï¼ˆæ¯”å¦‚å¯ä»¥è¯•è¯• S=noinonoipnoiS=\\mathtt{noinonoipnoi}S=noinonoipnoiï¼‰ åœ¨äºŒæ¬¡ä¼˜åŒ–åå¾—åˆ°çš„è¿™ä¸ªæ–¹æ³•ï¼Œæ­£æ˜¯å¤§åé¼é¼çš„ Ukkonen ç®—æ³•ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ª Ukkonen ç®—æ³•çš„æ„é€ è¿‡ç¨‹å¯è§†åŒ–ï¼ˆåŸå€åœ¨ https://github.com/brenden/ukkonen-animationï¼Œæ ¹æ®éœ€æ±‚ç¨æœ‰ä¿®æ”¹ï¼‰ã€‚å›¾ä¸­çº¢è‰²èŠ‚ç‚¹å’Œè¾¹å³ä¸º æ´»åŠ¨ç‚¹ ï¼Œè™šçº¿è¿æ¥çš„èŠ‚ç‚¹åˆ™è¡¨ç¤º åç¼€é“¾ ã€‚ å¤æ‚åº¦åˆ†æ ç¬¬ä¸€æ¬¡ä¼˜åŒ–æ—¶æˆ‘ä»¬å·²ç»è¯æ˜äº†å‘åç¼€æ ‘æ’å…¥ä¸²çš„æ¬¡æ•°æ˜¯ O(n)\\mathcal{O}(n)O(n) çº§åˆ«çš„ï¼Œæ³¨æ„åˆ°æ¯æ¬¡æ’å…¥æ—¶æˆ‘ä»¬åªæ˜¯ç»´æŠ¤äº†å‡ ä¸ªå€¼ï¼Œå¯ä»¥å¯¹ç…§ä»£ç çœ‹åˆ°é™¤äº† æ´»åŠ¨ç‚¹ ä¸­â€œé¡ºç€å­è¾¹è·³åˆ°å®ƒçš„å­èŠ‚ç‚¹â€è¿™é‡Œæœ‰å¾ªç¯ï¼Œå…¶å®ƒä½ç½®éƒ½å¿…å®šæ˜¯ O(1)\\mathcal{O}(1)O(1) çš„ã€‚è€Œæˆ‘ä»¬å‘ç°æ´»åŠ¨ç‚¹çš„ remremrem åªä¼šåœ¨æ¯è½®æ’å…¥çš„å¼€å§‹ +1+1+1ï¼Œè€Œæ¯æ¬¡â€œé¡ºç€å­è¾¹è·³åˆ°å®ƒçš„å­èŠ‚ç‚¹â€éƒ½ä¼šä½¿ remremrem å‡å°ï¼Œremremrem åˆä¸€ç›´ &gt;0&gt;0&gt;0ï¼Œæ‰€ä»¥â€œé¡ºç€å­è¾¹è·³åˆ°å®ƒçš„å­èŠ‚ç‚¹â€æ˜¯å‡æ‘Š O(1)\\mathcal{O}(1)O(1) çš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å…¶æ—¶é—´å¤æ‚åº¦ä¸º O(n)\\mathcal{O}(n)O(n)ã€‚ æ³¨æ„åˆ°æœ€å¤š 2n2n2n ä¸ªèŠ‚ç‚¹ï¼Œè€Œæ¯ä¸ªèŠ‚ç‚¹çš„ chchch æ•°ç»„æ˜¯ O(âˆ£Î£âˆ£)\\mathcal{O}(|\\Sigma|)O(âˆ£Î£âˆ£) çš„ï¼Œå› æ­¤æ€»çš„ç©ºé—´å¤æ‚åº¦ä¸º O(nâˆ£Î£âˆ£)\\mathcal{O}(n|\\Sigma|)O(nâˆ£Î£âˆ£) å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç”¨å¹³è¡¡æ ‘ï¼ˆmapï¼‰ç»´æŠ¤å­èŠ‚ç‚¹çš„æ˜ å°„ï¼Œè¿™æ ·å¯ä»¥åšåˆ°æ—¶ç©ºå¤æ‚åº¦å‡ä¸º O(nlogâ¡Î£âˆ£)\\mathcal{O}(n\\log\\Sigma|)O(nlogÎ£âˆ£) Code ä¸ºäº†æ–¹ä¾¿ï¼Œåœ¨å®ç°æ—¶è®°æ ¹èŠ‚ç‚¹ä¸º 1 å·èŠ‚ç‚¹ï¼Œè€Œæ´»åŠ¨ç‚¹çš„ charcharchar åˆ™è¢«åŸä¸²å’Œ remremrem è¡¨ç¤ºã€‚åœ¨å®ç°ä¸­ä¹Ÿè¿˜æœ‰ä¸€äº›å°æŠ€å·§ï¼Œå¯ä»¥ä»”ç»†ç†è§£ä¸€ä¸‹ä»£ç ã€‚ class suffix_tree{ public: int s[maxn],n,now,rem,cnt; struct NODE{int link,pos,len,ch[maxm];}t[maxn&lt;&lt;1]; // link æ˜¯åç¼€é“¾ï¼Œå…¶å®ƒåŒä¸Šæ–‡ä¸­ NODE çš„å„å˜é‡ inline int newnode(int pos,int l) { NODE &amp;x=t[++cnt]; x.link=1,x.pos=pos,x.len=l; memset(x.ch,0,sizeof(x.ch)); return cnt; } inline void extend(int x) { s[++n]=x,++rem; for(rgi last=1;rem;) { while(rem&gt;t[t[now].ch[s[n-rem+1]]].len) // å³â€œé¡ºç€å­è¾¹è·³åˆ°å®ƒçš„å­èŠ‚ç‚¹â€ rem-=t[now=t[now].ch[s[n-rem+1]]].len; // s[n-rem+1] å³ä¸ºæ–‡ä¸­çš„ char int &amp;v=t[now].ch[s[n-rem+1]],c=s[t[v].pos+rem-1]; if(!v||c==x) { t[last].link=now,last=now; if(!v) v=newnode(n-rem+1,inf); else break; } else { int u=newnode(t[v].pos,rem-1); t[u].ch[c]=v,t[u].ch[x]=newnode(n,inf); t[v].pos+=rem-1,t[v].len-=rem-1; t[last].link=v=u,last=u; } if(now==1) --rem; else now=t[now].link; } } inline void build(const char *str) { cnt=n=rem=0,t[0].len=inf,now=newnode(0,0); // t[0].len=inf æ˜¯ä¸ºäº†åœ¨ while(rem&gt;t[t[now].ch[s[n-rem+1]]].len) è¿™å¥è¯ä¸­ t[now].ch[s[n-rem+1]]ï¼ˆnow æ²¡æœ‰è¿™ä¸ªå„¿å­ï¼‰æ—¶åŠæ—¶è·³å‡ºå¾ªç¯ for(rgi i=0,l=strlen(str);i&lt;l;++i) extend(str[i]-'a'+1); extend(0); } }sft; åº”ç”¨ åç¼€æ ‘èƒ½è§£å†³çš„é—®é¢˜å¾ˆå¤šï¼Œä¸‹é¢ç»™å‡ºå‡ ä¸ªæ¯”è¾ƒå¸¸è§çš„ã€‚ ç»™å®šæ–‡æœ¬ä¸² SSS å’Œå¤šä¸ªæ¨¡å¼ä¸² {T}\\{T\\}{T}ï¼ŒæŸ¥è¯¢ä¸² TiT_iTiâ€‹ åœ¨ SSS ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚ å¯¹ SSS æ„é€ åç¼€æ ‘ï¼Œå¯¹æ¯ä¸ªæ¨¡å¼ä¸² Tâ€²T&#x27;Tâ€² éƒ½å…ˆä»æ ¹å¾€ä¸‹æ‰¾åˆ°å…¶åœ¨æ ‘ä¸­çš„ä½ç½®ã€‚æ ¹æ® æ€§è´¨ 4 ï¼Œæ‰€åˆ°èŠ‚ç‚¹çš„å­æ ‘ä¸­å¶èŠ‚ç‚¹ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯ SSS çš„æ‰€æœ‰åç¼€ä¸­æœ‰å‰ç¼€ä¸º Tâ€²T&#x27;Tâ€² çš„ä¸ªæ•°ï¼Œå³ä¸º SSS ä¸­å‡ºç°æ¬¡æ•°ã€‚ ç»™å®šä¸² SSSï¼Œæ±‚ SSS ä¸­ä¸åŒè¿ç»­å­ä¸²ä¸ªæ•°ã€‚ å¯¹ SSS æ„é€ åç¼€æ ‘ã€‚æ ¹æ® æ€§è´¨ 2 ï¼ŒSSS çš„æ‰€æœ‰è¿ç»­å­ä¸²éƒ½åœ¨æ ‘ä¸­ï¼Œæˆ–è€…è¯´åŸæ¥æåˆ°è¿‡çš„åç¼€ Trie çš„èŠ‚ç‚¹æ•°æ­£æ˜¯ä¸åŒè¿ç»­å­ä¸²ä¸ªæ•°ã€‚æ‰€ä»¥å…¶æ‰€æœ‰æ ‘è¾¹çš„é•¿åº¦å’Œï¼ˆé•¿åº¦å³æ ‡è®°ä¸²é•¿åº¦ï¼Œæ³¨æ„è¿™é‡Œæ„é€ å®Œåè¦æŠŠæ ‡ä¸ºé•¿ infâ¡\\infinf çš„è¾¹è¿˜åŸæˆçœŸå®é•¿åº¦ï¼‰å³ä¸ºä¸åŒè¿ç»­å­ä¸²ä¸ªæ•°ã€‚ æŸ¥è¯¢ä¸² SSS ä¸­æœ€é•¿é‡å¤å­ä¸² å¯¹ SSS æ„é€ åç¼€æ ‘ï¼Œå…¶æœ€é•¿é‡å¤å­ä¸²å³ä¸ºå‡ºç°è¿‡è‡³å°‘ä¸¤æ¬¡çš„æœ€é•¿å­ä¸²ï¼Œä¹Ÿå°±æ˜¯æœ€é•¿çš„éå¶èŠ‚ç‚¹å¯¹åº”ä¸²ã€‚ æ±‚ä¸¤ä¸² S, TS,\\,TS,T çš„æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰ å¯¹ S # T $â€¾\\overline{S\\ \\mathtt{\\#}\\ T\\ \\mathtt{\\$}}S # T $â€‹ å»ºç«‹åç¼€æ ‘ï¼Œæˆ‘ä»¬å‘ç°åç¼€æ ‘å¶èŠ‚ç‚¹çš„çˆ¶è¾¹æ ‡è®°ä¸²çš„ç¬¬ä¸€ä¸ªéå­—æ¯çš„å­—ç¬¦ï¼Œè¦ä¹ˆæ˜¯ #\\mathtt{\\#}#ï¼Œè¦ä¹ˆæ˜¯ $\\mathtt{\\$}$ï¼›å¦‚æœæ˜¯ #\\mathtt{\\#}# å°±è¯´æ˜è¿™ä¸ªèŠ‚ç‚¹çš„å¯¹åº”ä¸²æ˜¯ SSS çš„åç¼€ï¼Œå¦åˆ™å³ä¸º TTT çš„åç¼€ã€‚é‚£ä¹ˆï¼Œæ—¢ç„¶è¦æ±‚ LCSï¼Œä¹Ÿå°±æ˜¯æ±‚æœ€é•¿çš„ä¸²ä½¿å¾— S, TS,\\,TS,T å‡å­˜åœ¨ä¸€ä¸ªåç¼€ï¼Œæ»¡è¶³æ‰€æ±‚ä¸²æ˜¯å®ƒçš„å‰ç¼€ã€‚ä¹Ÿå°±æ˜¯åœ¨æ ‘ä¸­æ±‚æœ€é•¿çš„ä¸²ä½¿å…¶å¯¹åº”èŠ‚ç‚¹çš„å­æ ‘ä¸­æœ‰ #\\mathtt{\\#}# å’Œ $\\mathtt{\\$}$ å³å¯ã€‚ æ±‚ä¸² SSS çš„æœ€é•¿å›æ–‡å­ä¸² é¦–å…ˆå’Œ manacher ç®—æ³•ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å…ˆåœ¨åŸä¸²æ¯ä¸¤ä¸ªä½ç½®é—´æ’å…¥ âˆ£\\mathtt{|}âˆ£ï¼Œç„¶åè·Ÿæ±‚ LCS æ—¶ä¸€æ ·å…ˆå°† S # Sâ€² $â€¾\\overline{S\\ \\mathtt{\\#}\\ S&#x27;\\ \\mathtt{\\$}}S # Sâ€² $â€‹ï¼ˆå…¶ä¸­ Sâ€²S&#x27;Sâ€² ä¸º SSS çš„åä¸²ï¼‰æ„é€ åç¼€æ ‘ï¼Œæˆ‘ä»¬å‘ç°ä»¥ç¬¬ iii ä¸ªå­—ç¬¦ä¸ºå›æ–‡ä¸­å¿ƒçš„æœ€é•¿å›æ–‡ä¸²å°±æ˜¯ SiS^iSi å’Œ Sâ€²nâˆ’i+1S&#x27;^{n-i+1}Sâ€²nâˆ’i+1 çš„æœ€é•¿å…¬å…±å‰ç¼€ï¼Œå¯¹åº”åˆ°åç¼€æ ‘ä¸Šå°±æ˜¯è¿™ä¸¤ä¸ªä¸²å¯¹åº”èŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼ˆLCAï¼‰ç„¶åå°±å¯ä»¥æ±‚äº†ã€‚ æ±‚ SSS çš„æ‰€æœ‰å­åºåˆ—ä¸­å­—å…¸åºç¬¬ iii å¤§çš„ä¸² # 1 é‡å¤ä¸²ç®—ä¸€ä¸ª å»º SSS çš„åç¼€æ ‘ï¼Œå¯¹æ¯ä¸ªèŠ‚ç‚¹ iii è®°å½•å…¶å­æ ‘ä¸­æ‰€æœ‰è¾¹çš„é•¿åº¦å’Œ sum0[i]sum0[i]sum0[i]ï¼Œè®° iii çš„å¯¹åº”ä¸²ä¸º Sâ€²S&#x27;Sâ€² ä¸ é—®é¢˜ 2 ç±»ä¼¼çš„æˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™ä¸ªé•¿åº¦å’Œå³ä¸ºæœ‰ SSS ä¸­å‰ç¼€æœ‰ Sâ€²S&#x27;Sâ€² çš„ä¸åŒå­ä¸²ä¸ªæ•°ã€‚æ‰€ä»¥é¢„å¤„ç† sum0sum0sum0 åæˆ‘ä»¬åœ¨æ ‘ä¸Š DFSï¼Œæ²¿å­—å…¸åºæšä¸¾å­èŠ‚ç‚¹çš„ sum0sum0sum0 åŠ ä¸Šå­è¾¹é•¿åº¦ï¼Œæ¯” iii å¤§ iii å°±å‡å»å®ƒå¹¶ç»§ç»­æšä¸¾ï¼Œå¦åˆ™ iii å‡å»å­è¾¹é•¿å¹¶è¿›å…¥æ­¤å­æ ‘ # 2 é‡å¤ä¸²ä¸ç®—ä¸€ä¸ª æ³¨æ„åˆ° é—®é¢˜ 1 ç»™å‡ºçš„ç»“è®ºï¼Œå‘Šè¯‰æˆ‘ä»¬ä¸€ä¸ªä¸² TTT åœ¨æ–‡æœ¬ä¸² SSS ä¸­çš„å‡ºç°æ¬¡æ•°å°±æ˜¯æ–‡æœ¬ä¸²çš„åç¼€æ ‘ä¸Š TTT å¯¹åº”èŠ‚ç‚¹çš„å­æ ‘ä¸­çš„å¶èŠ‚ç‚¹æ•° siz[i]siz[i]siz[i]ã€‚æ ¹æ®è¿™ä¸ªæˆ‘ä»¬å¯ä»¥æ±‚å‡º SSS ä¸­å‰ç¼€æœ‰ TTT çš„å­ä¸²ä¸ªæ•° sum1[i]sum1[i]sum1[i]ã€‚å‰©ä¸‹è·Ÿä¸Šé¢å°±ä¸€æ ·äº†ã€‚ ä¸Šé¢ä¸¤ä¸ªè¯´èµ·æ¥éƒ½æœ‰ç‚¹ç»•ï¼Œä¸‹é¢ç»™å‡ºå¯¹åº”ä»£ç å¸®åŠ©ç†è§£ã€‚ æ³¨æ„è¿™ä»½ä»£ç ä¸­å·²ç»æŠŠæ ‡ä¸ºé•¿ infâ¡\\infinf çš„è¾¹è¿˜åŸæˆçœŸå®é•¿åº¦ï¼Œå³åœ¨ suffix_tree::build() çš„æœ€åä¸€è¡ŒåŠ ä¸Š for(rgi i=1;i&lt;=cnt;++i) if(t[i].len&gt;n&lt;&lt;1) t[i].len=n-t[i].p; char str[maxn]; int n; int siz[maxn&lt;&lt;1],sum[2][maxn&lt;&lt;1]; void getsum(int x) { if(sft.t[x].p+sft.t[x].len&gt;n) return siz[x]=1,void(); for(rgi i=0,v;i&lt;=26;++i) if(sft.t[x].ch[i]) { getsum(v=sft.t[x].ch[i]); sum[0][x]+=sum[0][v]+sft.t[v].len; sum[1][x]+=sum[1][v]+sft.t[v].len*siz[v]; siz[x]+=siz[v]; } } char ans[maxn]; int indx; bool dfs(int t,int x,int p) // è¿”å›å€¼ä¸º 1 åˆ™æ‰¾ä¸åˆ°ç¬¬ p å¤§çš„ä¸² { for(rgi i=0,v,tmp;i&lt;=26;++i) if(sft.t[x].ch[i]) { v=sft.t[x].ch[i],tmp=sft.t[v].len*(t?siz[v]:1); if(p&gt;sum[t][v]+tmp) p-=sum[t][v]+tmp; else { for(rgi i=0;i&lt;sft.t[x].len;++i) ans[indx++]=str[sft.t[x].p+i-1]; if(p&lt;=tmp) for(rgi i=0;i&lt;(p-1)/(t?siz[v]:1)+1;++i) ans[indx++]=str[sft.t[v].p+i-1]; else dfs(t,v,p-tmp); return 0; } } return 1; } signed main() // Luogu P3975 { scanf(&quot;%s&quot;,str),n=strlen(str); sft.build(str),getsum(1); int t,k; fin&gt;&gt;t&gt;&gt;k; // t=0 æ±‚ #1ï¼Œt=1 æ±‚ #2 if(dfs(t,1,k)) puts(&quot;-1&quot;); else ans[indx++]='\\0',printf(&quot;%s&quot;,ans); return 0; } åç¼€æ•°ç»„ å‰ç½®çŸ¥è¯† å­—ç¬¦ä¸²å’Œæ ‘çš„å®šä¹‰ä¸åŸºç¡€çŸ¥è¯† å­—å…¸æ ‘ï¼ˆTrieï¼‰ æ’åº æœ€å¥½å¯¹åŸºæ•°æ’åºæœ‰ä¸€å®šçš„äº†è§£ï¼Œä¸åˆ—ä¸ºå‰ç½®çŸ¥è¯†æ˜¯å› ä¸ºæ–‡ä¸­ä¼šæœ‰è¯¦ç»†ä»‹ç»ã€‚ å®šä¹‰ åç¼€æ•°ç»„ï¼ˆSuffix Array, SAï¼‰å°±æ˜¯ SSS çš„æ‰€æœ‰åç¼€æŒ‰å­—å…¸åºæ’åºåçš„æ’åæ•°ç»„ï¼Œå³æœ‰ âˆ€i&lt;j, SSA[i]&lt;SSA[j]\\forall i&lt;j,\\ S^{SA[i]}&lt;S^{SA[j]} âˆ€i&lt;j, SSA[i]&lt;SSA[j] ä¸¾ä¸ªä¾‹å­ï¼ŒS=fzfzzfzzzzS=\\texttt{fzfzzfzzzz}S=fzfzzfzzzz çš„åç¼€æ•°ç»„æ˜¯ {1,3,6,10,2,5,9,4,8,7}\\{1,3,6,10,2,5,9,4,8,7\\}{1,3,6,10,2,5,9,4,8,7} åç¼€æ•°ç»„ä¹Ÿå¯ä»¥ç†è§£ä¸ºåç¼€æ ‘çš„ DFS åºä¸­å„å¶èŠ‚ç‚¹çš„å‡ºç°é¡ºåºï¼š æ„å»º æœ´ç´ æ„å»ºæ–¹å¼ æˆ‘ä»¬æ ¹æ®åç¼€æ•°ç»„çš„å®šä¹‰æ¥æ„é€ ï¼Œä¹Ÿå°±æ˜¯å…ˆåˆ—å‡ºæ‰€æœ‰çš„åç¼€ï¼Œç„¶åå¯¹å…¶è¿›è¡Œæ’åºã€‚ å¯ä»¥å‘ç°ï¼Œæ’åºéœ€è¦æ¯”è¾ƒ nlogâ¡nn\\log nnlogn æ¬¡ä¸¤ä¸²ï¼Œè€Œæ¯”è¾ƒä¸¤ä¸²åˆ™æ˜¯ (n)\\mathcal(n)(n) çš„ï¼Œå› æ­¤æ€»æ—¶é—´å¤æ‚åº¦æ˜¯ O(n2logâ¡n)\\mathcal{O}(n^2\\log n)O(n2logn)ï¼Œç›¸è¾ƒäºæœ€ä½çš„æ—¶ç©ºå¤æ‚åº¦å‡ (O)n\\mathcal(O){n}(O)n å·®è·è¿˜å¾ˆå¤§ã€‚ é€šè¿‡åç¼€æ ‘æ„å»º ä¹Ÿå°±æ˜¯å…ˆæ„å»ºå‡ºåç¼€æ ‘ï¼Œç„¶ååœ¨æ ‘ä¸Š DFS å‡ºåç¼€æ•°ç»„ã€‚ è·Ÿç›´æ¥ç”¨åç¼€æ ‘æ¯”æ²¡æœ‰ä»»ä½•ä¼˜åŠ¿ï¼Œæ—¶ç©ºå¤æ‚åº¦ä¹Ÿä¸ç›´æ¥æ„å»ºåç¼€æ ‘ç›¸åŒã€‚ å€å¢æ³• å€å¢æ³•æ˜¯ç«èµ›ä¸­æœ€å¸¸ç”¨çš„ä¸ª SA æ„å»ºæ–¹æ³•ï¼Œå…¶å…·æœ‰å ç”¨ç©ºé—´ä½ã€æ€è·¯æ¸…æ™°æ˜“æ‡‚ã€ä»£ç çŸ­ã€æ—¶é—´å¤æ‚åº¦è¾ƒä¼˜çš„ä¼˜ç‚¹ã€‚ ä¸ºäº†è¯´æ˜å€å¢æ³•çš„æ€æƒ³ï¼Œæˆ‘ä»¬ä¾ç„¶ä»åŸºæœ¬æ€æƒ³å¼€å§‹è¯´èµ·ã€‚è€ƒè™‘è¿™æ ·è¿›è¡Œæ’åºï¼šç¬¬ iii è½®æ’åºå¯¹äºæ¯ä¸ª jjj çš„ S[j..minâ¡(j+2iâˆ’1,n)]S[j..\\min(j+2^i-1,n)]S[j..min(j+2iâˆ’1,n)]ï¼Œç›´åˆ° 2iâ‰¥n2^i\\ge n2iâ‰¥nï¼ˆå³ç¬¬ iii è½®æ’åºé•¿åº¦ä¸º 2i2^i2i çš„å­ä¸²ï¼‰ã€‚ä¸¾ä¸ªä¾‹å­æˆ‘ä»¬è¿˜æ˜¯æ’åºä¸² S=fzfzzfzzzzS=\\mathtt{fzfzzfzzzz}S=fzfzzfzzzzï¼Œä¸‹é¢åˆ—ä¸¾äº†æ¯è½®æ’åºçš„å¾…æ’åºä¸²ï¼š ç¬¬ 0 è½® ç¬¬ 1 è½® ç¬¬ 2 è½® ç¬¬ 3 è½® ç¬¬ 4 è½® f z f z z f z z z z\\begin{aligned}\\\\\\mathtt{f\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{z\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{f\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{z\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{z\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{f\\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{z\\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{z\\ \\ \\ \\ }&amp;\\\\\\mathtt{z\\ \\ }&amp;\\\\\\mathtt{z}\\end{aligned}f z f z z f z z z zâ€‹â€‹ fz zf fz zz zf fz zz zz zzz\\begin{aligned}\\\\\\mathtt{fz\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{zf\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{fz\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{zz\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{zf\\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{fz\\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{zz\\ \\ \\ \\ }&amp;\\\\\\mathtt{zz\\ \\ }&amp;\\\\\\mathtt{zz}&amp;\\\\\\mathtt{z}\\end{aligned}fz zf fz zz zf fz zz zz zzzâ€‹â€‹ fzfz zfzz fzzf zzfz zfzz fzzz zzzzzzzzzz\\begin{aligned}\\\\\\mathtt{fzfz\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{zfzz\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{fzzf\\ \\ \\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{zzfz\\ \\ \\ \\ \\ \\ }&amp;\\\\\\mathtt{zfzz\\ \\ \\ \\ }&amp;\\\\\\mathtt{fzzz\\ \\ }&amp;\\\\\\mathtt{zzzz}&amp;\\\\\\mathtt{zzz}&amp;\\\\\\mathtt{zz}&amp;\\\\\\mathtt{z}\\end{aligned}fzfz zfzz fzzf zzfz zfzz fzzz zzzzzzzzzzâ€‹â€‹ fzfzzfzz zfzzfzzz fzzfzzzzzzfzzzzzfzzzzfzzzzzzzzzzzzzz\\begin{aligned}\\\\\\mathtt{fzfzzfzz\\ \\ \\ \\ }&amp;\\\\\\mathtt{zfzzfzzz\\ \\ }&amp;\\\\\\mathtt{fzzfzzzz}&amp;\\\\\\mathtt{zzfzzzz}&amp;\\\\\\mathtt{zfzzzz}&amp;\\\\\\mathtt{fzzzz}&amp;\\\\\\mathtt{zzzz}&amp;\\\\\\mathtt{zzz}&amp;\\\\\\mathtt{zz}&amp;\\\\\\mathtt{z}\\end{aligned}fzfzzfzz zfzzfzzz fzzfzzzzzzfzzzzzfzzzzfzzzzzzzzzzzzzzâ€‹â€‹ fzfzzfzzzzzfzzfzzzzfzzfzzzzzzfzzzzzfzzzzfzzzzzzzzzzzzzz\\begin{aligned}\\\\\\mathtt{fzfzzfzzzz}&amp;\\\\\\mathtt{zfzzfzzzz}&amp;\\\\\\mathtt{fzzfzzzz}&amp;\\\\\\mathtt{zzfzzzz}&amp;\\\\\\mathtt{zfzzzz}&amp;\\\\\\mathtt{fzzzz}&amp;\\\\\\mathtt{zzzz}&amp;\\\\\\mathtt{zzz}&amp;\\\\\\mathtt{zz}&amp;\\\\\\mathtt{z}\\end{aligned}fzfzzfzzzzzfzzfzzzzfzzfzzzzzzfzzzzzfzzzzfzzzzzzzzzzzzzzâ€‹â€‹ å®šä¹‰ Si,j=S[j..minâ¡(j+2iâˆ’1,n)]S_{i,j}=S[j..\\min(j+2^i-1,n)]Si,jâ€‹=S[j..min(j+2iâˆ’1,n)]ï¼ˆå³å¦‚ä¸Šè¡¨ä¸­çš„ç¬¬ iii è½®ç¬¬ jjj è¡Œï¼Œè‹¥ j&gt;nj&gt;nj&gt;n åˆ™ä»¤å…¶ä¸º Ïµ\\epsilonÏµï¼‰ é‚£ä¹ˆå¾ˆæ˜æ˜¾ï¼Œæœ‰ Si+1,j=Si,j Si,j+2iâ€¾S_{i+1,j}=\\overline{S_{i,j}\\ S_{i,j+2^i}}Si+1,jâ€‹=Si,jâ€‹ Si,j+2iâ€‹â€‹ å†å®šä¹‰ fi,jf_{i,j}fi,jâ€‹ ä»£è¡¨ Si,jS_{i,j}Si,jâ€‹ åœ¨ Si,k (1â‰¤kâ‰¤n)S_{i,k}\\ (1\\le k\\le n)Si,kâ€‹ (1â‰¤kâ‰¤n) ä¸­çš„æ’åã€‚æ¯”å¦‚ä¸Šè¿°ç¬¬ 1 è½®å¯¹åº”çš„ f1={1,3,1,4,3,1,4,4,4,2}f_1=\\{1,3,1,4,3,1,4,4,4,2\\}f1â€‹={1,3,1,4,3,1,4,4,4,2}ï¼Œç¬¬ 2 è½®å¯¹åº”çš„ f2={1,5,2,7,5,3,9,8,6,4}f_2=\\{1,5,2,7,5,3,9,8,6,4\\}f2â€‹={1,5,2,7,5,3,9,8,6,4} æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ˜æ˜¾å´ä¸å¤ªæ˜æ˜¾çš„ç»“è®ºï¼š åŸºäºåŒä¸€ä¸ª iiiï¼Œå¦‚æœæˆ‘ä»¬å¯¹äºæ‰€æœ‰ jjj å°† (fi,j, fi,j+2i)(f_{i,j},\\,f_{i,j+2^i})(fi,jâ€‹,fi,j+2iâ€‹) æ’åºå»é‡ï¼Œåˆ™ fi+1,j=(fi,j, fi,j+2i)f_{i+1,j}=(f_{i,j},\\,f_{i,j+2^i})fi+1,jâ€‹=(fi,jâ€‹,fi,j+2iâ€‹)æ’åºåçš„åºå·ã€‚æ¯”å¦‚è¿˜æ˜¯ä¸¾ i=1i=1i=1 çš„ä¾‹å­ï¼Œç”¨æ¥æ’åºçš„æ•°å¯¹æ˜¯ï¼š {(1,1),(3,4),(1,3),(4,1),(3,4),(1,4),(4,4),(4,2),(4,0),(2,0)}\\{(1,1),(3,4),(1,3),(4,1),(3,4),(1,4),(4,4),(4,2),(4,0),(2,0)\\} {(1,1),(3,4),(1,3),(4,1),(3,4),(1,4),(4,4),(4,2),(4,0),(2,0)} ç¬¬ xxx ä¸ªæ•°å¯¹é‡Œçš„ç¬¬ä¸€ä¸ªæ•°å«â€œç¬¬ iii è½®ä¸­åç¼€ xxx çš„ç¬¬ä¸€å…³é”®å­—â€ï¼Œç¬¬äºŒä¸ªæ•°å«â€œç¬¬ iii è½®ä¸­åç¼€ xxx çš„ç¬¬äºŒå…³é”®å­—â€ï¼Œåæ–‡å°±ç›´æ¥è¿™æ ·ç§°å‘¼äº† æ’åºå»é‡åçš„æ•°å¯¹æ˜¯ï¼š {(1,1),(1,3),(1,4),(2,0),(3,4),(4,0),(4,1),(4,2),(4,4)}\\{(1,1),(1,3),(1,4),(2,0),(3,4),(4,0),(4,1),(4,2),(4,4)\\} {(1,1),(1,3),(1,4),(2,0),(3,4),(4,0),(4,1),(4,2),(4,4)} æ‰€ä»¥æ’åºåçš„åºå·ä¸º {1,5,2,7,5,3,9,8,6,4}\\{1,5,2,7,5,3,9,8,6,4\\}{1,5,2,7,5,3,9,8,6,4}ï¼Œä¹Ÿå°±æ˜¯ f2f_2f2â€‹ çš„å€¼ã€‚ æ ¹æ®è¿™ä¸ªç»“è®ºï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ âŒˆlogâ¡nâŒ‰\\lceil\\log n\\rceilâŒˆlognâŒ‰ æ¬¡æ’åºä»¥å†…æ±‚å‡º fâŒˆlogâ¡nâŒ‰f_{\\lceil\\log n\\rceil}fâŒˆlognâŒ‰â€‹ ä»¥åŠ SASASAï¼ˆSA[i]SA[i]SA[i] å¯ä»¥ç†è§£ä¸º iii åœ¨ fâŒˆlogâ¡nâŒ‰f_{\\lceil\\log n\\rceil}fâŒˆlognâŒ‰â€‹ ä¸­å¯¹åº”çš„ä¸‹æ ‡ï¼‰ å¦‚æœç”¨æ™®é€šçš„æ’åºæ–¹å¼ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ª nlogâ¡2nn\\log^2nnlog2n çš„æ±‚æ³•äº†ã€‚ è§‚å¯Ÿåˆ°éœ€è¦æ’åºçš„å¯¹è±¡æ˜¯ä¸€äº›æœ‰åºæ•°å¯¹ï¼Œè€Œæœ‰åºæ•°å¯¹ä¸­æ¯ä¸ªæ•°éƒ½ä¸è¶…è¿‡ nnnï¼Œæ‰€ä»¥æˆ‘ä»¬å¼•å…¥å¦ä¸€ç§æ’åºæ–¹å¼ä½¿å¾—ä¸€æ¬¡æ’åºåªç”¨èŠ±è´¹ O(n)\\mathcal{O}(n)O(n) çš„æ—¶é—´å’Œç©ºé—´ï¼šåŸºæ•°æ’åºã€‚ ç®€å•æ¥è®²ï¼ŒåŸºæ•°æ’åºå°±æ˜¯å…ˆæŒ‰ç¬¬äºŒå…³é”®å­—æ¡¶æ’åºä¸€éï¼Œå†æŒ‰ç¬¬ä¸€å…³é”®å­—æ¡¶æ’åºä¸€éã€‚ SASASA çš„ä»£ç æ˜¯ç²¾é«“ï¼Œå…·ä½“å®ç°æ–¹æ³•ï¼Œå…ˆä¸Š codeï¼Œå†ä¸€ç‚¹ä¸€ç‚¹è®² Code int n,m; int SA[maxn],c[maxn],t1[maxn],t2[maxn]; inline void getSA() { int *x=t1,*y=t2; for(rgi i=1;i&lt;=n;++i) ++c[x[i]=s[i]]; for(rgi i=2;i&lt;=m;++i) c[i]+=c[i-1]; for(rgi i=n;i&gt;=1;--i) SA[c[x[i]]--]=i; for(rgi k=1,p;k&lt;=n;k&lt;&lt;=1) {p=0; for(rgi i=n-k+1;i&lt;=n;++i) y[++p]=i; for(rgi i=1;i&lt;=n;++i) if(SA[i]&gt;k) y[++p]=SA[i]-k; for(rgi i=1;i&lt;=m;++i) c[i]=0; for(rgi i=1;i&lt;=n;++i) ++c[x[i]]; for(rgi i=2;i&lt;=m;++i) c[i]+=c[i-1]; for(rgi i=n;i&gt;=1;--i) SA[c[x[y[i]]]--]=y[i],y[i]=0; std::swap(x,y),x[SA[1]]=p=1; for(rgi i=2;i&lt;=n;++i) x[SA[i]]=(y[SA[i]]==y[SA[i-1]]&amp;&amp;y[SA[i]+k]==y[SA[i-1]+k])?p:++p; if(n==(m=p)) break; } } çœ‹èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆç„å­¦ï¼Ÿ emmmmâ€¦â€¦ä¸€ç‚¹ä¸€ç‚¹è¯´å§ int n,m; int SA[maxn],c[maxn],t1[maxn],t2[maxn]; è¿™é‡Œçš„ nnn æ˜¯å¾…æ±‚ SASASA çš„ä¸²çš„é•¿åº¦å³ âˆ£Sâˆ£|S|âˆ£Sâˆ£ï¼›mmm å¼€å§‹æ—¶å¯ä»¥è¯´æ˜¯å­—ç¬¦é›†çš„å¤§å°å³ âˆ£Î£âˆ£|\\Sigma|âˆ£Î£âˆ£ï¼Œåé¢åˆ™æˆä¸ºæ’åçš„å€¼åŸŸï¼ˆä¹Ÿå°±æ˜¯è¿™è½®æ’åºäº†å¤šå°‘ç§ä¸åŒçš„ä¸²ï¼‰ï¼Œè¿™ä¸ªæ„ä¹‰æœ€åä¼šä½“ç°çš„ã€‚ SASASA å°±æ˜¯ SASASAï¼ˆæ³¨æ„æ¯è½®æ’åºçš„ä¸²é•¿åº¦æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥æ¯è½®çš„åç¼€æ’åºä¹Ÿæ˜¯ä¸åŒçš„ï¼‰ï¼Œccc æ˜¯ç”¨äºæ¡¶æ’åºä¸²è¾…åŠ©æ•°ç»„ï¼Œt1,t2t1,t2t1,t2 æ˜¯å¦å¤–ä¸¤ä¸ªç¥ç¥å¥‡å¥‡çš„è¾…åŠ©æ•°ç»„ï¼Œåé¢ä¼šè®²å®ƒçš„ä½œç”¨ã€‚ int *x=t1,*y=t2; è¿™ä¸¤ä¸ªä¸œè¥¿åœ¨ä¸åŒçš„åœ°æ–¹æœ‰ä¸åŒçš„æ„ä¹‰ for(rgi i=1;i&lt;=n;++i) ++c[x[i]=s[i]]; for(rgi i=2;i&lt;=m;++i) c[i]+=c[i-1]; for(rgi i=n;i&gt;=1;--i) SA[c[x[i]]--]=i; é¦–å…ˆé¢„å¤„ç†ç¬¬ 0 è½®æ’åºï¼Œå³å¯¹å•ä¸ªå­—ç¬¦æ’åºã€‚è¿™ä¸‰è¡Œæ˜¯æ­£å¸¸çš„æ¡¶æ’åºã€‚ ç¬¬ä¸€è¡Œå…ˆå°†æ‰€æœ‰å…ƒç´ æ”¾å…¥æ¡¶ï¼›ç¬¬äºŒè¡Œå¯¹æ¡¶åšå‰ç¼€å’Œï¼Œæ–¹ä¾¿è®¡ç®—æ’åï¼›ç¬¬ä¸‰è¡Œå°†æ’åæ”¾è¿› SASASA æ•°ç»„ï¼ˆå†è¯´ä¸€é SA[i]SA[i]SA[i] è¡¨ç¤ºæ’åç¬¬ iii çš„åç¼€ï¼Œä¸ºäº†ä¸é‡å¤è®©æ’åå¹¶åˆ—çš„åç¼€æ”¾è¿›åŒä¸€ä¸ªä½ç½®æ‰€ä»¥ä¸‹æ ‡è¦æ˜¯ c[x[i]]--ï¼‰ for(rgi k=1,p;k&lt;=n;k&lt;&lt;=1) {p=0; å‡†å¤‡åŸºæ•°æ’åºäº†ã€‚æ³¨æ„ï¼Œkkk ä¸æ˜¯æœ¬è½®æ’åºçš„ä¸²çš„é•¿åº¦ï¼Œè€Œæ˜¯å®ƒçš„ä¸€åŠï¼ç„¶å ppp æ˜¯ä¸ªè¾…åŠ©å˜é‡ï¼Œå¯ä»¥è¯´æ˜¯ç”¨æ¥è®°ä¸‹æ ‡çš„ ç°åœ¨ï¼Œå…ˆç†è§£ä¸€ä¸ªåœ°æ–¹ï¼Œæ¯è½®å¼€å§‹æ—¶ä¸Šä¸€è½®å·²ç»å¤„ç†å¥½äº†è¿™ä¸€è½®çš„ç¬¬ä¸€å…³é”®å­—ï¼Œè¿™é‡Œå°±æ˜¯ xxxï¼Œè¿™ä¸ªåœ¨ç¬¬ 1 è½®æ’åºæ—¶æ˜¯æ˜¾ç„¶çš„ï¼ˆç¬¬ 0 è½®é‡Œçš„ xxx å½“ç„¶å¯ä»¥ä½œä¸ºç¬¬ 1 è½®çš„ç¬¬ä¸€å…³é”®å­—ï¼‰ï¼Œè€Œåœ¨æ¯è½®çš„æœ«å°¾ä¹Ÿéƒ½æœ‰è¿™ä¸ªå¤„ç†è¿‡ç¨‹ï¼Œå…·ä½“åé¢å†è®²ã€‚ç°åœ¨å¯ä»¥è¿™æ ·è®°ç€ï¼šç¬¬ iii è½®å¼€å§‹æ—¶ xxx å°±æ˜¯ä¸Šæ–‡ä¸­çš„ fiâˆ’1f_{i-1}fiâˆ’1â€‹ã€‚ ä¸¾ä¸ªä¾‹å­è¿˜æ˜¯ fzfzzfzzzz\\texttt{fzfzzfzzzz}fzfzzfzzzzï¼Œç¬¬ 2 è½®æ’åºå¼€å§‹æ—¶ï¼Œxxx çš„å€¼å°±æ˜¯ {1,3,1,4,3,1,4,4,4,2}\\{1,3,1,4,3,1,4,4,4,2\\}{1,3,1,4,3,1,4,4,4,2}ã€‚ é‚£ä¹ˆæ—¢ç„¶ç¬¬ä¸€å…³é”®å­—å·²ç»å‡†å¤‡å¥½äº†ï¼Œç°åœ¨å°±è¯¥å¤„ç†ç¬¬äºŒå…³é”®å­—äº† æ¥åˆ°ç¬¬ä¸€ä¸ªç¥å¥‡çš„ä½ç½®äº†ï¼Œé©¬ä¸Šè¦ç°èº«çš„ y[i]y[i]y[i] åœ¨è¿™é‡ŒæŒ‡ç¬¬äºŒå…³é”®å­—æ’åä¸º iii çš„åç¼€ï¼Œå®ƒåŸæ¥æ‰€å¤„çš„ä½ç½®çš„ä¸‹æ ‡ï¼ˆå¤§é›¾ï¼‰ã€‚ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¾ç„¶å¥ fz çš„ä¾‹å­æ¥è§£é‡Šï¼š å¦‚æœæˆ‘ä»¬ç°åœ¨æ­£åœ¨æ’åºç¬¬ 2 è½®ï¼ˆå³é•¿åº¦ä¸º 444 çš„ä¸²ï¼‰ï¼Œé‚£ä¹ˆâ€¦â€¦ ç¬¬äºŒå…³é”®å­—ï¼š{1,4,3,1,4,4,4,2,0,0}\\{1,4,3,1,4,4,4,2,0,0\\}{1,4,3,1,4,4,4,2,0,0} ç¬¬äºŒå…³é”®å­—æ’åºååº”è¯¥é•¿è¿™æ ·ï¼š{0,0,1,1,2,3,4,4,4,4}\\{0,0,1,1,2,3,4,4,4,4\\}{0,0,1,1,2,3,4,4,4,4} æˆ‘ä»¬çœ‹æ¯ä¸ªæ•°å®ƒåŸæ¥åœ¨å“ªï¼ˆå³åŸä½ç½®çš„ä¸‹æ ‡ï¼‰ï¼šå‰ä¸¤ä¸ª 000 åˆ†åˆ«åœ¨ 9,109,109,10 å·ä½ç½®ï¼Œ111 åœ¨ 1,41,41,4ï¼Œ222 åªåœ¨ä¸‹æ ‡ä¸º 888 çš„ä½ç½®å‡ºç°è¿‡ï¼Œ333 æ­£å¥½åœ¨ 333 å·ä½ï¼Œ444 åˆ™åè½äº 2,5,6,72,5,6,72,5,6,7 è¿™å‡ ä¸ªä¸‹æ ‡ã€‚ æ‰€ä»¥ yyy åº”è¯¥ä¸ºï¼š{9,10,1,4,8,3,2,5,6,7}\\{9,10,1,4,8,3,2,5,6,7\\}{9,10,1,4,8,3,2,5,6,7} å†æ¢å¥è¯è¯´ âˆ€i&lt;j\\forall i&lt;jâˆ€i&lt;jï¼Œåç¼€ y[i]y[i]y[i] çš„ç¬¬äºŒå…³é”®å­—å°äºç­‰äºåç¼€ y[j]y[j]y[j] çš„ç¬¬äºŒå…³é”®å­—ã€‚ å¥½äº†å·®ä¸å¤šå°±è¿™æ ·äº†ï¼Œä¸‹é¢çœ‹æ€ä¹ˆæ±‚ yyyï¼š for(rgi i=n-k+1;i&lt;=n;++i) y[++p]=i; é¦–å…ˆå¯ä»¥çœ‹åˆ°æœ€å kkk ä¸ªåç¼€åœ¨è¿™ä¸€è½®æ’åºä¸­æ˜¯æ²¡æœ‰ç¬¬äºŒå…³é”®å­—çš„ï¼ˆæˆ–è€…è¯´ç¬¬äºŒå…³é”®å­—ä¸º 000ï¼‰ï¼Œæ‰€ä»¥å®ƒä»¬è‚¯å®šæ’åœ¨æœ€å‰é¢ã€‚ for(rgi i=1;i&lt;=n;++i) if(SA[i]&gt;k) y[++p]=SA[i]-k; æ³¨æ„åˆ°è¿™é‡Œ SA[i]SA[i]SA[i] ç›¸å½“äºä¸Šä¸€è½®åç¼€çš„æ’åºï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äº xxx çš„æ’åºï¼Œæˆ–è€…è¯´ç°åœ¨æœ‰ âˆ€i&lt;j,x[SA[i]]â‰¤x[SA[j]]\\forall i&lt;j,x[SA[i]]\\le x[SA[j]]âˆ€i&lt;j,x[SA[i]]â‰¤x[SA[j]]ã€‚åˆè§‚å¯Ÿåˆ° 1âˆ¼nâˆ’k1\\sim n-k1âˆ¼nâˆ’k è¿™äº›åç¼€åœ¨è¿™è½®çš„ç¬¬äºŒå…³é”®å­—æ­£å¥½æ˜¯ k+1âˆ¼nk+1\\sim nk+1âˆ¼n çš„ç¬¬ä¸€å…³é”®å­—ã€‚æ‰€ä»¥å‘¢â€¦â€¦æ ¹æ® yyy çš„å®šä¹‰ï¼Œæœ‰ âˆ€i&lt;j,x[y[i]+k]â‰¤x[y[j]+k]\\forall i&lt;j,x[y[i]+k]\\le x[y[j]+k]âˆ€i&lt;j,x[y[i]+k]â‰¤x[y[j]+k] ï¼Œå‘ç°è¿™ä¸è·Ÿ SASASA æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™å—ï¼äºæ˜¯ä¹å°±æœ‰äº†ä¸Šé¢çš„è¿™è¡Œç ã€‚æ³¨æ„å¦‚æœ SA[i]â‰¤kSA[i]\\le kSA[i]â‰¤kï¼Œé‚£ x[SA[i]]x[SA[i]]x[SA[i]] æ˜¾ç„¶ä¸åœ¨ç¬¬äºŒå…³é”®å­—é‡Œï¼Œæ‰€ä»¥è¦è·³è¿‡ã€‚ for(rgi i=1;i&lt;=m;++i) c[i]=0; for(rgi i=1;i&lt;=n;++i) ++c[x[i]]; for(rgi i=2;i&lt;=m;++i) c[i]+=c[i-1]; å†å¯¹ç¬¬ä¸€å…³é”®å­—æ¡¶æ’åºä¸€éï¼Œè·Ÿå‰é¢è¯´çš„å·®ä¸å¤šã€‚è¿™é‡Œæ˜¯å…ˆæ‰”è¿›æ¡¶é‡Œå¹¶è·Ÿç¬¬ 0 è½®æ—¶ä¸€æ ·æ±‚ä¸ªå‰ç¼€å’Œã€‚ for(rgi i=n;i&gt;=1;--i) SA[c[x[y[i]]]--]=y[i],y[i]=0; ç„¶åè¦ä»æ¡¶é‡Œå–å‡ºæ¥ç®—è¿™ä¸€è½®çš„ SASASA äº†ã€‚è¿™é‡Œå¥—äº†å¤§æ¦‚ 444 å±‚æ–¹æ‹¬å·ä»¤äººæœ‰ç‚¹éå¸¸çœ¼çâ€¦â€¦æ‰€ä»¥æˆ‘ä»¬ä»å†…å¾€å¤–ä¸€å±‚ä¸€å±‚çœ‹ï¼š y[i]y[i]y[i]ï¼šç¬¬äºŒå…³é”®å­—æ’åä¸º iii çš„åç¼€çš„ä¸‹æ ‡ï¼ˆå‰é¢è¯´è¿‡äº†ï¼‰ x[y[i]]x[y[i]]x[y[i]]ï¼šç¬¬äºŒå…³é”®å­—æ’åä¸º iii çš„åç¼€çš„ç¬¬ä¸€å…³é”®å­— c[x[y[i]]]c[x[y[i]]]c[x[y[i]]]ï¼šâ€œç¬¬äºŒå…³é”®å­—æ’åä¸º iii çš„åç¼€çš„ç¬¬ä¸€å…³é”®å­—â€åœ¨æ¡¶é‡Œçš„æ’åï¼ˆ-- è·Ÿä¹‹å‰è¯´çš„ä¸€æ ·æ˜¯ä¸ºäº†ä¿è¯ä¸é‡å¤ï¼‰ SA[c[x[y[i]]]âˆ’âˆ’]SA[c[x[y[i]]]--]SA[c[x[y[i]]]âˆ’âˆ’]ï¼šSASASA æ•°ç»„ä¸­ï¼Œä¸‹æ ‡ä¸ºä¸Šé¢çš„â€œâ€¦â€¦çš„æ’åâ€çš„ä½ç½® è¿™ä¸ªæ€ä¹ˆç†è§£å‘¢ï¼Ÿå¯ä»¥å›å¤´å¯¹ç€ç¬¬ 000 è½®çš„é‚£å¥è¯ for(rgi i=n;i&gt;=1;--i) SA[c[x[i]]--]=i; çœ‹ã€‚å®ƒæ— éå°±æ˜¯æŠŠä¸‹æ ‡é‡Œçš„ iii æ”¹æˆäº† y[i]y[i]y[i]ï¼Œæˆ–è€…è¯´å°±æ˜¯æ¢äº†ä¸ªè®¿é—®é¡ºåºã€‚æ­£æ˜¯å› ä¸ºæ¢æˆäº†è¿™ä¸ª y[i]y[i]y[i] æ‰ä½¿å¾—åœ¨ç¬¬ä¸€å…³é”®å­—æœ‰åºçš„æƒ…å†µä¸‹ï¼Œç¬¬äºŒå…³é”®å­—æœ‰åº è¿™ä¸ªåœ°æ–¹ä»”ç»†æ¨¡æ‹Ÿä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼Œå°±èƒ½ç†è§£äº†ã€‚ æœ€åé‚£ä¸ª y[i]=0y[i]=0y[i]=0 æ²¡åˆ«çš„æ„æ€ï¼Œå°±åªæ˜¯æ¸…ç©º yyyã€‚ è®°å¾—å‰é¢æåˆ°è¿‡çš„â€œæ¯è½®å¼€å§‹æ—¶ä¸Šä¸€è½®å·²ç»å¤„ç†å¥½äº†è¿™ä¸€è½®çš„ç¬¬ä¸€å…³é”®å­—â€å—ï¼Ÿç°åœ¨å°±è¦â€œå±¥è¡Œè¿™ä¸ªè¯ºè¨€â€äº†ã€‚ç”±äºä¸‹ä¸€è½®çš„ç¬¬ä¸€å…³é”®å­—å°±æ˜¯è¿™ä¸€è½®æ’åºåæ¯ä¸ªåç¼€çš„æ’åï¼Œæ‰€ä»¥ç›´æ¥æ±‚è¿™ä¸ªæ’åå°±å¥½ std::swap(x,y),x[SA[1]]=p=1; è¿™é‡Œçš„äº¤æ¢çº¯ç²¹æ˜¯ä¸ºäº†æ–¹ä¾¿å†™ï¼Œx[SA[1]]=p=1 ä¹ŸæŒºæ˜¾ç„¶çš„ï¼Œç¬¬ä¸€åçš„åç¼€å½“ç„¶æ’åè€å¤§ 111 å•¦ã€‚ for(rgi i=2;i&lt;=n;++i) x[SA[i]]=(y[SA[i]]==y[SA[i-1]]&amp;&amp;y[SA[i]+k]==y[SA[i-1]+k])?p:++p; è¿™å¥è¯å‘¢â€¦â€¦æŒºé•¿â€¦â€¦ä½†å…¶å®æ„æ€æŒºç®€å•ã€‚y[SA[i]]==y[SA[i-1]]&amp;&amp;y[SA[i]+k]==y[SA[i-1]+k] å°±æ˜¯åˆ¤å®šçš„è¿™ä¸ªåç¼€å’Œä¸Šä¸ªåç¼€æ˜¯ä¸æ˜¯ä¿©å…³é”®å­—éƒ½ç›¸åŒï¼Œå¦‚æœæ˜¯çš„è¯é‚£è‚¯å®šæ’åè·Ÿä¸Šä¸€ä¸ªä¹Ÿä¸€æ ·å³ pppï¼Œå¦åˆ™å°±è¦ +1+1+1ã€‚ if(n==(m=p)) break; æœ€åä¸€å¥ï¼Œä¹Ÿä¸éš¾ç†è§£äº†ã€‚ é¦–å…ˆï¼Œæœ€åçš„ ppp å€¼ä¹Ÿå°±æ˜¯è¿™è½®æ’åºå‡ºç°çš„ä¸åŒæ’åçš„ä¸ªæ•°ï¼Œæ‰€ä»¥ mmm è¦è¢«èµ‹å€¼ä¸º ppp å•¦ã€‚ ç„¶åå¦‚æœ n=mn=mn=mï¼Œå°±è¯´æ˜æ’åå·²ç»ä¸¤ä¸¤ä¸åŒäº†ï¼Œä¹Ÿå°±æ˜¯å·²ç»å®Œå…¨æœ‰åºäº†ï¼Œæ‰€ä»¥å°±ä¸ç”¨å†ç»§ç»­æ’ä¸‹å»äº†å‘—ã€‚ é‚£ä¹ˆåˆ°è¿™é‡Œï¼Œå€å¢æ³•æ€»ç®—æ˜¯è®²å®Œäº†ã€‚ã€‚ã€‚ å¦‚æœè¿˜æ˜¯æœ‰é—®é¢˜ï¼Œå¯ä»¥è¾“å‡ºä¸€ä¸‹ SA,x,ySA,x,ySA,x,y è¿™ä¸‰ä¸ªæ•°ç»„å¯¹ç€çœ‹çœ‹ï¼Œæ¯”å¦‚åƒä¸‹é¢è¿™æ ·ï¼š int n,m,SA[maxn],c[maxn],t1[maxn],t2[maxn]; inline void DEBUG(int time,const char *v,int *x,int *y) { printf(&quot;\\n------ DEBUG:%3d, %s ------\\n&quot;,time,v); printf(&quot; SA: &quot;); for(rgi i=1;i&lt;=n;++i) std::cout&lt;&lt;SA[i]&lt;&lt;' '; std::cout&lt;&lt;'\\n'; printf(&quot; x: &quot;); for(rgi i=1;i&lt;=n;++i) std::cout&lt;&lt;x[i]&lt;&lt;' '; std::cout&lt;&lt;'\\n'; printf(&quot; y: &quot;); for(rgi i=1;i&lt;=n;++i) std::cout&lt;&lt;y[i]&lt;&lt;' '; std::cout&lt;&lt;'\\n'; std::cout&lt;&lt;'\\n'; } inline void getSA() { int *x=t1,*y=t2; DEBUG(1,&quot;No.0&quot;,x,y); for(rgi i=1;i&lt;=n;++i) ++c[x[i]=s[i]]; for(rgi i=2;i&lt;=m;++i) c[i]+=c[i-1]; for(rgi i=1;i&lt;=n;++i) SA[c[x[i]]--]=i; DEBUG(1,&quot;No.1&quot;,x,y); for(rgi k=1,p;k&lt;=n;k&lt;&lt;=1) {p=0; DEBUG(k&lt;&lt;1,&quot;No.0&quot;,x,y); for(rgi i=n-k+1;i&lt;=n;++i) y[++p]=i; for(rgi i=1;i&lt;=n;++i) if(SA[i]&gt;k) y[++p]=SA[i]-k; DEBUG(k&lt;&lt;1,&quot;No.1&quot;,x,y); for(rgi i=1;i&lt;=m;++i) c[i]=0; for(rgi i=1;i&lt;=n;++i) ++c[x[i]]; for(rgi i=2;i&lt;=m;++i) c[i]+=c[i-1]; for(rgi i=n;i&gt;=1;--i) SA[c[x[y[i]]]--]=y[i],y[i]=0; DEBUG(k&lt;&lt;1,&quot;No.2&quot;,x,y); std::swap(x,y),x[SA[1]]=p=1; for(rgi i=2;i&lt;=n;++i) x[SA[i]]=(y[SA[i]]==y[SA[i-1]]&amp;&amp;y[SA[i]+k]==y[SA[i-1]+k])?p:++p; if(n==(m=p)) break; } } DC3/DC ç®—æ³• ä¸ä¼šï¼Œæœ‰æ—¶é—´å­¦äº†å°±å†™ SA-IS ç®—æ³• ä¹Ÿä¸ä¼šï¼Œä¼°è®¡ä¼šå…ˆå­¦è¿™å†å­¦ DC3/DC è¾…åŠ©å·¥å…· å•å•æœ‰ä¸ªåç¼€æ•°ç»„å…¶å®è§£å†³ä¸äº†ä»€ä¹ˆé—®é¢˜ï¼Œå› æ­¤æˆ‘ä»¬è¦å¼•å…¥å¦å¤–ä¸¤ä¸ªè¾…åŠ©æ•°ç»„ï¼šrankrankrank å’Œ heightheightheightã€‚ rank[i]rank[i]rank[i] é¡¾åæ€ä¹‰å°±æ˜¯åç¼€ SiS^iSi çš„æ’åï¼Œå³ SA[rank[i]]=iSA[rank[i]]=iSA[rank[i]]=iï¼› height[i]height[i]height[i] æŒ‡ SSA[i]S^{SA[i]}SSA[i] å’Œ SSA[iâˆ’1]S^{SA[i-1]}SSA[iâˆ’1] çš„æœ€é•¿å…¬å…±å‰ç¼€ï¼ˆLCPï¼‰ï¼Œå³æœ‰ (SSA[i])height[i]=(SSA[iâˆ’1])height[i](S^{SA[i]})_{height[i]}=(S^{SA[i-1]})_{height[i]}(SSA[i])height[i]â€‹=(SSA[iâˆ’1])height[i]â€‹ ä¸” (SSA[i])[height[i]+1]â‰ (SSA[iâˆ’1])[height[i]+1](S^{SA[i]})[height[i]+1]\\neq(S^{SA[i-1]})[height[i]+1](SSA[i])[height[i]+1]î€ â€‹=(SSA[iâˆ’1])[height[i]+1] ç»™ä¸ªå›¾è¿™ä¿©ä¸œè¥¿å°±å¾ˆæ¸…æ™°äº†ï¼š é—²æ‰¯ä¸€å¥ï¼Œheightheightheight æ•°ç»„ä¹Ÿå¯ä»¥è®¤ä¸ºä»£è¡¨äº†åç¼€æ ‘ä¸­ç›¸é‚»ä¸¤ä¸ªå¶èŠ‚ç‚¹çš„ LCALCALCA çš„æ˜ å°„ã€‚ è¿™ä¸¤ä¸ªçš„æ±‚æ³•å‘¢ï¼Œä¹Ÿä¸éš¾ã€‚ rankrankrank å…¶å®å°±ä¸€è¡Œï¼Œéå†ä¸€æ¬¡ SASASA æ•°ç»„å°±å¥½äº† int rank[maxn]; for(rgi i=1;i&lt;=n;++i) rank[SA[i]]=i; å¦‚æœæ±‚ SASASA æ—¶ç”¨çš„æ˜¯å€å¢æ³•ï¼Œç”šè‡³å¯ä»¥ç›´æ¥å®šä¹‰å…¨å±€å˜é‡ int *rank; ç„¶ååœ¨ getSA å‡½æ•°çš„æœ€å¤–å±‚å¾ªç¯ä¹‹ååŠ ä¸Šä¸€å¥ rank=x; å³å¯ LCP ä¸ heightheightheight æˆ‘ä»¬æ³¨æ„åˆ°ä¸€ä¸ªæ€§è´¨ï¼Œheight[rank[i]]â‰¥height[rank[iâˆ’1]]âˆ’1height[rank[i]]\\ge height[rank[i-1]]-1height[rank[i]]â‰¥height[rank[iâˆ’1]]âˆ’1ã€‚è¿™ä¸ªæ€§è´¨å½¢å¼åŒ–çš„è¯æ˜é•¿å¾—æ¯”è¾ƒä¸‘ï¼Œè¿™é‡Œä¸¾ä¸ªä¾‹å­è¯´æ˜åŸå› ã€‚ çœ‹åˆ° i=4i=4i=4 çš„æ—¶å€™ï¼Œé¦–å…ˆï¼Œrank[iâˆ’1]=2rank[i-1]=2rank[iâˆ’1]=2ï¼Œåç¼€ iâˆ’1i-1iâˆ’1 ä¸º fzzfzzzz\\texttt{fzzfzzzz}fzzfzzzzï¼Œæ’åä»…é«˜äºå®ƒçš„åç¼€åˆ™æ˜¯ fzfzzfzzzz\\mathtt{fzfzzfzzzz}fzfzzfzzzzï¼Œä¹Ÿå°±æ˜¯æ±‚çš„è¿™ä¸¤è¡Œçš„ LCSï¼š å¦‚æœæˆ‘ä»¬å°†è¿™ä¸¤ä¸ªä¸²å»æ‰é¦–å­—æ¯å†åœ¨é‡Œé¢å®šä½ï¼š å¯ä»¥å‘ç° zzfzzzz\\texttt{zzfzzzz}zzfzzzz ä¹Ÿå°±æ˜¯åç¼€ iiiï¼Œè€Œ zfzzfzzzz\\mathtt{zfzzfzzzz}zfzzfzzzz è‚¯å®šæ’åœ¨ zzfzzzz\\texttt{zzfzzzz}zzfzzzz ä¹‹å‰ã€‚æ—¢ç„¶æ’åœ¨å®ƒä¹‹å‰ï¼Œæ‰€ä»¥å®ƒä¿©ä¹‹é—´çš„ä¸² è‚¯å®šæ’ååœ¨å®ƒä¿©ä¹‹é—´ã€‚ è¿›ä¸€æ­¥æ¨æ–­ï¼Œè¿™ä¸€å †çš„æ‰€æœ‰ä¸²çš„ LCS å¿…å®šå°±æ˜¯ height[rank[iâˆ’1]]âˆ’1height[rank[i-1]]-1height[rank[iâˆ’1]]âˆ’1ï¼š æ‰€ä»¥å°±èƒ½å¾—åˆ° height[rank[i]]â‰¥height[rank[iâˆ’1]]âˆ’1height[rank[i]]\\ge height[rank[i-1]]-1height[rank[i]]â‰¥height[rank[iâˆ’1]]âˆ’1ï¼š æœ‰äº†è¿™ä¸ªæ€§è´¨ï¼Œå°±å¾ˆå®¹æ˜“çº¿æ€§æ±‚ heightheightheight æ•°ç»„äº†ï¼Œä¸‹é¢æ˜¯ä»£ç ä¾›å‚è€ƒ inline void getheight() { for(rgi i=1,j,k=0;i&lt;=n;++i) { if(k) --k; j=SA[rank[i]-1]; while(s[i+k]==s[j+k]) ++k; height[rank[i]]=k; } } ç„¶åæˆ‘ä»¬å†çœ‹åˆ°ï¼Œå¦‚ä½•æ±‚ä»»æ„ä¸¤ä¸ªåç¼€çš„ LCPï¼Œä¹Ÿå¾ˆå®¹æ˜“å‘ç°åç¼€ i,j (rank[i]&lt;rank[j])i,j\\ (rank[i]&lt;rank[j])i,j (rank[i]&lt;rank[j]) çš„ LCP æ˜¯ minâ¡(height[rank[i]+1],height[rank[i]+2],â‹¯ ,height[rank[k]])\\min(height[rank[i]+1],height[rank[i]+2],\\cdots,height[rank[k]])min(height[rank[i]+1],height[rank[i]+2],â‹¯,height[rank[k]])ã€‚ç»™ä¸ªå›¾å°±å¾ˆå®¹æ˜“ç†è§£äº†ï¼š è¿™ç›¸å½“äºå¯¹ heightheightheight æ•°ç»„æ±‚åŒºé—´æœ€å°å€¼ï¼ˆRMQï¼‰ï¼Œå¯ä»¥ç”¨ ST è¡¨å®ç°ï¼Œä¹Ÿå¯ä»¥ç”¨å…¶å®ƒå¥‡å¥‡æ€ªæ€ªçš„æ•°æ®ç»“æ„å®ç°ã€‚ åº”ç”¨ åç¼€æ•°ç»„èƒ½è§£å†³çš„é—®é¢˜è¿˜æ˜¯æ²¡åç¼€æ ‘å¤šï¼Œå¤šæ•°åº”ç”¨æ˜¯ä¾èµ–å…¶ä¼˜ç§€çš„çº¿æ€§ç©ºé—´ã€‚ ç»™å®šæ–‡æœ¬ä¸² SSS å’Œå¤šä¸ªæ¨¡å¼ä¸² {T}\\{T\\}{T}ï¼ŒæŸ¥è¯¢ä¸² TiT_iTiâ€‹ åœ¨ SSS ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚ ç»™å®šä¸² SSSï¼Œæ±‚ SSS ä¸­ä¸åŒè¿ç»­å­ä¸²ä¸ªæ•°ã€‚ æŸ¥è¯¢ä¸² SSS ä¸­æœ€é•¿é‡å¤å­ä¸² æ±‚ä¸¤ä¸² S, TS,\\,TS,T çš„æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰ æ±‚ä¸² SSS çš„æœ€é•¿å›æ–‡å­ä¸² æ±‚ SSS çš„æ‰€æœ‰å­åºåˆ—ä¸­å­—å…¸åºç¬¬ iii å¤§çš„ä¸² # 1 é‡å¤ä¸²ç®—ä¸€ä¸ª # 2 é‡å¤ä¸²ä¸ç®—ä¸€ä¸ª ","link":"https://imzzy1201.github.io/post/tbrptnzGB/"},{"title":"ç¬”è®° - Lucas å®šç†","content":" Never put off the work till tomorrow, you can put off today. Lucas å®šç†ç”¨äºæ±‚ (nm)mod p\\dbinom{n}{m}\\mod p(mnâ€‹)modpï¼ˆppp ä¸ºè´¨æ•°ï¼‰ ä¸€èˆ¬å¤šç”¨äº n,m&gt;pn,m&gt;pn,m&gt;pï¼Œå³æ— æ³•ä½¿ç”¨é˜¶ä¹˜å–æ¨¡æ³•çš„æƒ…å†µã€‚ å½¢å¼ ä¸‹é¢ç»™å‡ºä¸¤ç§ Lucas å®šç†çš„å½¢å¼ï¼Œä¸€èˆ¬ä»£ç ç”¨å½¢å¼ 1 å†™ã€‚ å½¢å¼ 1 ä»¤ n=sp+q, m=tp+r, q,râ‰¤pn=sp+q,\\ m=tp+r,\\ q,r\\le pn=sp+q, m=tp+r, q,râ‰¤p åˆ™æœ‰ (nm)â‰¡(st)(qr)(modp)\\binom{n}{m}\\equiv\\binom s t \\binom q r \\pmod p (mnâ€‹)â‰¡(tsâ€‹)(rqâ€‹)(modp) å½¢å¼ 2 è‹¥å°† nnn å†™æˆ ppp è¿›åˆ¶çš„ aqâ‹¯a2a1a0â€¾\\overline{a_q\\cdots a_2a_1a_0}aqâ€‹â‹¯a2â€‹a1â€‹a0â€‹â€‹ï¼Œmmm å†™æˆ ppp è¿›åˆ¶çš„ bqâ‹¯b2b1b0â€¾\\overline{b_q\\cdots b_2b_1b_0}bqâ€‹â‹¯b2â€‹b1â€‹b0â€‹â€‹ é‚£ä¹ˆ (nm)â‰¡âˆi=0q(aibi)(modp)\\binom{n}{m}\\equiv\\prod_{i=0}^q\\binom{a_i}{b_i}\\pmod p (mnâ€‹)â‰¡i=0âˆqâ€‹(biâ€‹aiâ€‹â€‹)(modp) å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè‹¥ nnn ä¸ mmm çš„ ppp è¿›åˆ¶æ•°ä½æ•°ä¸åŒï¼Œé‚£ä¹ˆ (nm)â‰¡0(modp)\\dbinom{n}{m}\\equiv0\\pmod p(mnâ€‹)â‰¡0(modp) è¯æ˜ ä¸‹é¢æ˜¯å½¢å¼ 111 æ¨å¯¼è¿‡ç¨‹ ä»¤ 0&lt;f&lt;p0&lt;f&lt;p0&lt;f&lt;p åˆ™ (pf)â‰¡pf(pâˆ’1fâˆ’1)â‰¡0(modp)\\dbinom{p}{f}\\equiv\\dfrac{p}{f}\\dbinom{p-1}{f-1}\\equiv 0 \\pmod p(fpâ€‹)â‰¡fpâ€‹(fâˆ’1pâˆ’1â€‹)â‰¡0(modp) æ‰€ä»¥æœ‰ (1+x)nâ‰¡(1+x)sp+qâ‰¡(1+x)spâ‹…(1+x)qâ‰¡((1+x)p)sâ‹…(1+x)qâ‰¡(âˆ‘i=0p(pi)xi(pnâˆ’i))sâ‹…(1+x)qâ‰¡(1+xp)sâ‹…(1+x)qâ‰¡âˆ‘i=0s(si)xipâ‹…âˆ‘j=0q(qj)xj(modp)\\begin{aligned}\\\\ &amp;(1+x)^n\\\\ \\equiv&amp;(1+x)^{sp+q}\\\\ \\equiv&amp;(1+x)^{sp}\\cdot(1+x)^q\\\\ \\equiv&amp;((1+x)^p)^s\\cdot(1+x)^q\\\\ \\equiv&amp;\\left(\\sum_{i=0}^p\\binom p i x^i \\binom p {n-i}\\right)^s\\cdot(1+x)^q\\\\ \\equiv&amp;(1+x^p)^s\\cdot(1+x)^q\\\\ \\equiv&amp;\\sum_{i=0}^s\\binom s i x^{ip}\\cdot\\sum_{j=0}^q\\binom{q}{j}x^j \\pmod p\\\\ \\end{aligned} â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â€‹(1+x)n(1+x)sp+q(1+x)spâ‹…(1+x)q((1+x)p)sâ‹…(1+x)q(i=0âˆ‘pâ€‹(ipâ€‹)xi(nâˆ’ipâ€‹))sâ‹…(1+x)q(1+xp)sâ‹…(1+x)qi=0âˆ‘sâ€‹(isâ€‹)xipâ‹…j=0âˆ‘qâ€‹(jqâ€‹)xj(modp)â€‹ å³æœ‰ (1+x)nâ‰¡âˆ‘i=0sâˆ‘j=0q(si)(qj)xip+j(modp)(1+x)^n\\equiv\\sum_{i=0}^s\\sum_{j=0}^q\\binom{s}{i}\\binom{q}{j}x^{ip+j}\\pmod p (1+x)nâ‰¡i=0âˆ‘sâ€‹j=0âˆ‘qâ€‹(isâ€‹)(jqâ€‹)xip+j(modp) åˆå› ä¸º (1+x)n=âˆ‘i=0n(ni)xi(1+x)^n=\\sum_{i=0}^{n}\\binom{n}{i}x^i (1+x)n=i=0âˆ‘nâ€‹(inâ€‹)xi æ‰€ä»¥ xmx^mxm é¡¹ç³»æ•°ä¸º (nm)\\dbinom{n}{m}(mnâ€‹) åˆ (1+x)nâ‰¡âˆ‘i=0sâˆ‘j=0q(si)(qj)xip+j(modp), m=tp+r(1+x)^n\\equiv\\sum_{i=0}^s\\sum_{j=0}^q\\binom{s}{i}\\binom{q}{j}x^{ip+j}\\pmod p,\\ m=tp+r (1+x)nâ‰¡i=0âˆ‘sâ€‹j=0âˆ‘qâ€‹(isâ€‹)(jqâ€‹)xip+j(modp), m=tp+r æ‰€ä»¥ xmx^mxm é¡¹ç³»æ•°äº¦ä¸º (st)(qr)\\dbinom{s}{t}\\dbinom{q}{r}(tsâ€‹)(rqâ€‹) å³ (nm)â‰¡(st)(qr)(modp)\\dbinom{n}{m}\\equiv\\dbinom s t \\dbinom q r \\pmod p(mnâ€‹)â‰¡(tsâ€‹)(rqâ€‹)(modp) å½¢å¼ 222 ä¸å½¢å¼ 111 æœ¬è´¨ç›¸åŒï¼Œåªä¸è¿‡æŠŠ n=sp+q,m=tp+rn=sp+q,m=tp+rn=sp+q,m=tp+r ç®€åŒ–ä¸º n,mn,mn,m åœ¨ ppp è¿›åˆ¶ä¸‹çš„æ¯ä¸€ä½ Code ä¾ç„¶æ˜¯ä¸€è¡Œ ll Lucas(ll n,ll m,ll p) {return m&lt;=0?1LL:(C(n%p,m%p)*Lucas(n/p,m/p)%p);} æ‰©å±•å®šç† æ‰©å±• Lucas å®šç†ï¼ˆexLucasï¼‰ï¼Œç”¨äºè§£å†³ ppp ä¸æ˜¯è´¨æ•°çš„æƒ…å†µ æ€è·¯å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼Œé¦–å…ˆåˆ†è§£ ppp çš„è´¨å› å­ p=p1Î±1p2Î±2p3Î±3â‹¯pkÎ±k=âˆi=1kpiÎ±ip=p_1^{\\alpha_1}p_2^{\\alpha_2}p_3^{\\alpha_3}\\cdots p_k^{\\alpha_k}=\\prod_{i=1}^kp_i^{\\alpha_i} p=p1Î±1â€‹â€‹p2Î±2â€‹â€‹p3Î±3â€‹â€‹â‹¯pkÎ±kâ€‹â€‹=i=1âˆkâ€‹piÎ±iâ€‹â€‹ åˆ†åˆ«æ±‚å‡º {(nm) mod p1Î±1(nm) mod p2Î±2â‹¯(nm) mod pkÎ±k\\left\\{ \\begin{aligned}\\\\ \\binom{n}{m}&amp;\\bmod p_1^{\\alpha_1}\\\\ \\binom{n}{m}&amp;\\bmod p_2^{\\alpha_2}\\\\ &amp;\\cdots\\\\ \\binom{n}{m}&amp;\\bmod p_k^{\\alpha_k} \\end{aligned} \\right. â©âªâªâªâªâªâªâªâªâªâªâ¨âªâªâªâªâªâªâªâªâªâªâ§â€‹(mnâ€‹)(mnâ€‹)(mnâ€‹)â€‹modp1Î±1â€‹â€‹modp2Î±2â€‹â€‹â‹¯modpkÎ±kâ€‹â€‹â€‹ ç„¶åæ ¹æ®ä¸­å›½å‰©ä½™å®šç†æ±‚è§£ ç°åœ¨è€ƒè™‘æ±‚ (nm) mod qr (qâˆˆprime)\\binom{n}{m}\\bmod q^r\\ (q\\in \\text{prime}) (mnâ€‹)modqr (qâˆˆprime) è€ƒè™‘åˆ° (nm)â‰¡n!m!(nâˆ’m)!â‰¡n!qxm!qyâ‹…(nâˆ’m)!qzâ‹…qxâˆ’yâˆ’z(modqr), (qâˆˆprime)\\binom{n}{m}\\equiv\\frac{n!}{m!(n-m)!}\\equiv\\frac{\\frac{n!}{q^x}}{\\frac{m!}{q^y}\\cdot\\frac{(n-m)!}{q^z}}\\cdot q^{x-y-z} \\pmod{q^r},\\ (q\\in \\text{prime}) (mnâ€‹)â‰¡m!(nâˆ’m)!n!â€‹â‰¡qym!â€‹â‹…qz(nâˆ’m)!â€‹qxn!â€‹â€‹â‹…qxâˆ’yâˆ’z(modqr), (qâˆˆprime) è‹¥ xxx å–æ»¡è¶³ qxâˆ£n!q^x|n!qxâˆ£n! çš„æœ€å¤§éè´Ÿæ•´æ•°ï¼ˆy,zy,zy,z åŒç†ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨é€†å…ƒæ±‚è§£äº† è®¾ g(t)=xmaxâ¡ (qxâˆ£t!), f(t)=t!qg(t) mod qrg(t)=x_{\\max}\\,(q^x|t!),\\ f(t)=\\frac{t!}{q^{g(t)}}\\bmod q^r g(t)=xmaxâ€‹(qxâˆ£t!), f(t)=qg(t)t!â€‹modqr åˆ™ g(t)=âŒŠtqâŒ‹+g(âŒŠtqâŒ‹)f(t)=f(âŒŠtqâŒ‹)â‹…(âˆi=1, iî€ â‰¡0(modq)qri)âŒŠtqrâŒ‹â‹…(âˆi=qrâŒŠtqrâŒ‹+1, iî€ â‰¡0(modq)ti) mod qr\\begin{aligned}\\\\ g(t)&amp;=\\left\\lfloor\\frac{t}{q}\\right\\rfloor+g\\left(\\left\\lfloor\\frac{t}{q}\\right\\rfloor\\right)\\\\ f(t)&amp;=f\\left(\\left\\lfloor\\frac{t}{q}\\right\\rfloor\\right)\\cdot \\left(\\prod_{i=1,\\,i\\not\\equiv0\\pmod q}^{q^r}i\\right)^{\\left\\lfloor\\frac{t}{q^r}\\right\\rfloor} \\cdot\\left(\\prod_{i=q^r\\left\\lfloor\\frac{t}{q^r}\\right\\rfloor+1,\\,i\\not\\equiv0\\pmod q}^{t}i\\right) \\bmod{q^r} \\end{aligned} g(t)f(t)â€‹=âŒŠqtâ€‹âŒ‹+g(âŒŠqtâ€‹âŒ‹)=f(âŒŠqtâ€‹âŒ‹)â‹…ââ›â€‹i=1,iî€ â€‹â‰¡0(modq)âˆqrâ€‹iâ ââ€‹âŒŠqrtâ€‹âŒ‹â‹…ââœâ›â€‹i=qrâŒŠqrtâ€‹âŒ‹+1,iî€ â€‹â‰¡0(modq)âˆtâ€‹iâ âŸââ€‹modqrâ€‹ è¿™ä¸ªä¸œè¥¿ä¸¥æ ¼è¯æ˜è¿‡ç¨‹æ¯”è¾ƒç¹çï¼Œæ„Ÿæ€§ç†è§£ä¸€ä¸‹å°±å¥½ ä¸¾ä¸¤ä¸ªä¾‹å­ å½“ q=3, r=5q=3,\\,r=5q=3,r=5 åˆ™ g(9)=âŒŠ93âŒ‹+g(âŒŠ93âŒ‹)=3+g(3)=3+1=4f(9)=f(âŒŠ93âŒ‹)â‹…(âˆi=1, iî€ â‰¡0(mod3)35i)âŒŠ935âŒ‹â‹…(âˆi=35âŒŠ935âŒ‹+1, iî€ â‰¡0(mod3)9i) mod 35=f(3)Ã—1Ã—(1Ã—2Ã—4Ã—5Ã—7Ã—8) mod 243=2Ã—1Ã—2240 mod 243=4480 mod 243=34\\begin{aligned}\\\\ g(9)&amp;=\\left\\lfloor\\frac{9}{3}\\right\\rfloor+g\\left(\\left\\lfloor\\frac{9}{3}\\right\\rfloor\\right)=3+g(3)=3+1=4\\\\ f(9)&amp;=f\\left(\\left\\lfloor\\frac{9}{3}\\right\\rfloor\\right)\\cdot \\left(\\prod_{i=1,\\,i\\not\\equiv0\\pmod 3}^{3^5}i\\right)^{\\left\\lfloor\\frac{9}{3^5}\\right\\rfloor} \\cdot\\left(\\prod_{i=3^5\\left\\lfloor\\frac{9}{3^5}\\right\\rfloor+1,\\,i\\not\\equiv0\\pmod 3}^{9}i\\right) \\bmod{3^5}\\\\ &amp;=f(3)\\times1\\times(1\\times2\\times4\\times5\\times7\\times8) \\bmod{243}\\\\ &amp;=2\\times1\\times2240\\bmod{243}\\\\ &amp;=4480\\bmod{243}\\\\ &amp;=34 \\end{aligned} g(9)f(9)â€‹=âŒŠ39â€‹âŒ‹+g(âŒŠ39â€‹âŒ‹)=3+g(3)=3+1=4=f(âŒŠ39â€‹âŒ‹)â‹…ââ›â€‹i=1,iî€ â€‹â‰¡0(mod3)âˆ35â€‹iâ ââ€‹âŒŠ359â€‹âŒ‹â‹…ââœâ›â€‹i=35âŒŠ359â€‹âŒ‹+1,iî€ â€‹â‰¡0(mod3)âˆ9â€‹iâ âŸââ€‹mod35=f(3)Ã—1Ã—(1Ã—2Ã—4Ã—5Ã—7Ã—8)mod243=2Ã—1Ã—2240mod243=4480mod243=34â€‹ å½“ q=2, r=3q=2,\\,r=3q=2,r=3 åˆ™ g(15)=âŒŠ152âŒ‹+g(âŒŠ152âŒ‹)=7+g(7)=7+4=11f(15)=f(âŒŠ152âŒ‹)â‹…(âˆi=1, iî€ â‰¡0(mod2)23i)âŒŠ1523âŒ‹â‹…(âˆi=23âŒŠ1523âŒ‹+1, iî€ â‰¡0(mod2)15i) mod 23=f(7)Ã—(1Ã—3Ã—5Ã—7)1Ã—(9Ã—11Ã—13Ã—15) mod 8=3Ã—105Ã—19305 mod 8=6081075 mod 8=3\\begin{aligned}\\\\ g(15)&amp;=\\left\\lfloor\\frac{15}{2}\\right\\rfloor+g\\left(\\left\\lfloor\\frac{15}{2}\\right\\rfloor\\right)=7+g(7)=7+4=11\\\\ f(15)&amp;=f\\left(\\left\\lfloor\\frac{15}{2}\\right\\rfloor\\right)\\cdot \\left(\\prod_{i=1,\\,i\\not\\equiv0\\pmod 2}^{2^3}i\\right)^{\\left\\lfloor\\frac{15}{2^3}\\right\\rfloor} \\cdot\\left(\\prod_{i=2^3\\left\\lfloor\\frac{15}{2^3}\\right\\rfloor+1,\\,i\\not\\equiv0\\pmod 2}^{15}i\\right) \\bmod{2^3}\\\\ &amp;=f(7)\\times(1\\times3\\times5\\times7)^1\\times(9\\times11\\times13\\times15) \\bmod{8}\\\\ &amp;=3\\times105\\times19305\\bmod{8}\\\\ &amp;=6081075\\bmod{8}\\\\ &amp;=3 \\end{aligned} g(15)f(15)â€‹=âŒŠ215â€‹âŒ‹+g(âŒŠ215â€‹âŒ‹)=7+g(7)=7+4=11=f(âŒŠ215â€‹âŒ‹)â‹…ââ›â€‹i=1,iî€ â€‹â‰¡0(mod2)âˆ23â€‹iâ ââ€‹âŒŠ2315â€‹âŒ‹â‹…ââœâ›â€‹i=23âŒŠ2315â€‹âŒ‹+1,iî€ â€‹â‰¡0(mod2)âˆ15â€‹iâ âŸââ€‹mod23=f(7)Ã—(1Ã—3Ã—5Ã—7)1Ã—(9Ã—11Ã—13Ã—15)mod8=3Ã—105Ã—19305mod8=6081075mod8=3â€‹ å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œä¸Šé¢çš„ ggg å‡½æ•°æ±‚å€¼çš„æ—¶é—´å¤æ‚åº¦ä¸º Î˜(logâ¡qt)\\Theta(\\log_qt)Î˜(logqâ€‹t)ï¼Œfff åˆ™ä¸º O(qrlogâ¡qt)\\text{O}(q^r\\log_qt)O(qrlogqâ€‹t) æ‰€ä»¥ï¼Œæˆ‘ä»¬å¾—åˆ° (nm)â‰¡n!qxm!qyâ‹…(nâˆ’m)!qzâ‹…qxâˆ’yâˆ’zâ‰¡f(n)f(m)â‹…f(nâˆ’m)â‹…qg(n)âˆ’g(m)âˆ’g(nâˆ’m)(modqr), (qâˆˆprime)\\binom{n}{m}\\equiv\\frac{\\frac{n!}{q^x}}{\\frac{m!}{q^y}\\cdot\\frac{(n-m)!}{q^z}}\\cdot q^{x-y-z}\\equiv\\frac{f(n)}{f(m)\\cdot f(n-m)}\\cdot q^{g(n)-g(m)-g(n-m)} \\pmod{q^r},\\ (q\\in \\text{prime}) (mnâ€‹)â‰¡qym!â€‹â‹…qz(nâˆ’m)!â€‹qxn!â€‹â€‹â‹…qxâˆ’yâˆ’zâ‰¡f(m)â‹…f(nâˆ’m)f(n)â€‹â‹…qg(n)âˆ’g(m)âˆ’g(nâˆ’m)(modqr), (qâˆˆprime) ç»¼ä¸Šæ–¹æ³•å³ä¸º exLucas çš„å…¨è¿‡ç¨‹ exLucas Code Empty! ","link":"https://imzzy1201.github.io/post/C4R_6YYKI/"},{"title":"ç¬”è®° - Catalan æ•°","content":" To live is to risk it at all. Catalan æ•°æ˜¯ä¸ªå¥‡å¥‡æ€ªæ€ªçš„æ•°åˆ—ï¼Œå®ƒååˆ†å¸¸è§ï¼Œå¥½å¤šä¸œè¥¿çš„ç»“è®ºéƒ½è·Ÿå®ƒç›¸å…³ã€‚ å½¢å¼ æˆ‘ä»¬ç°åœ¨ç”¨ CiC_iCiâ€‹ ä»£è¡¨ Catalan æ•°åˆ—çš„ç¬¬ iii é¡¹ï¼Œæœ‰å¦‚ä¸‹å®šä¹‰ï¼š é€’å½’å®šä¹‰ Cn=âˆ‘i=1nCiâˆ’1Cnâˆ’iC_n=\\sum_{i=1}^n C_{i-1}C_{n-i} Cnâ€‹=i=1âˆ‘nâ€‹Ciâˆ’1â€‹Cnâˆ’iâ€‹ é€’æ¨å…³ç³» Cn=4nâˆ’2n+1Cnâˆ’1C_n=\\frac{4n-2}{n+1}C_{n-1} Cnâ€‹=n+14nâˆ’2â€‹Cnâˆ’1â€‹ é€šå‘å…¬å¼ Cn=1n+1(2nn)=(2nn)âˆ’(2nn+1)C_n=\\frac{1}{n+1}\\binom{2n}{n}=\\binom{2n}{n}-\\binom{2n}{n+1} Cnâ€‹=n+11â€‹(n2nâ€‹)=(n2nâ€‹)âˆ’(n+12nâ€‹) å…¶å‰å‡ é¡¹ä¸ºï¼š 1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900,2674440,9694845,35357670,129644790,477638700,1767263190,â‹¯1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, 208012, 742900, 2674440, 9694845, 35357670, 129644790, 477638700, 1767263190, \\cdots 1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900,2674440,9694845,35357670,129644790,477638700,1767263190,â‹¯ è¯æ˜ ä¸‹é¢ç»™å‡ºä¸Šè¿°å‡ ä¸ªå®šä¹‰ç­‰ä»·çš„è¯æ˜ï¼š 1. é€šé¡¹å…¬å¼ (2nn)âˆ’(2nn+1)=(2n)!(n!)2âˆ’(2n)!(nâˆ’1)!(n+1)!=(n+1)(2n)!âˆ’n(2n)!n!(n+1)!=(2n)!n!(n+1)!=1n+1(2nn)\\begin{aligned} \\binom{2n}{n}-\\binom{2n}{n+1}=&amp;\\frac{(2n)!}{(n!)^2}-\\frac{(2n)!}{(n-1)!(n+1)!}\\\\ =&amp;\\frac{(n+1)(2n)!-n(2n)!}{n!(n+1)!}=\\frac{(2n)!}{n!(n+1)!}\\\\ =&amp;\\frac{1}{n+1}\\binom{2n}{n} \\end{aligned} (n2nâ€‹)âˆ’(n+12nâ€‹)===â€‹(n!)2(2n)!â€‹âˆ’(nâˆ’1)!(n+1)!(2n)!â€‹n!(n+1)!(n+1)(2n)!âˆ’n(2n)!â€‹=n!(n+1)!(2n)!â€‹n+11â€‹(n2nâ€‹)â€‹ 2. é€šé¡¹å…¬å¼ä¸é€’æ¨å…³ç³» Cn=1n+1(2nn)=(2n)!n!(n+1)!=(2n)(2nâˆ’1)(n)(n+1)â‹…(2nâˆ’2)!(nâˆ’1)!n!=4nâˆ’2n+1Cnâˆ’1C_n=\\frac{1}{n+1}\\binom{2n}{n}=\\frac{(2n)!}{n!(n+1)!}=\\frac{(2n)(2n-1)}{(n)(n+1)}\\cdot\\frac{(2n-2)!}{(n-1)!n!}=\\frac{4n-2}{n+1}C_{n-1} Cnâ€‹=n+11â€‹(n2nâ€‹)=n!(n+1)!(2n)!â€‹=(n)(n+1)(2n)(2nâˆ’1)â€‹â‹…(nâˆ’1)!n!(2nâˆ’2)!â€‹=n+14nâˆ’2â€‹Cnâˆ’1â€‹ 3. é€šé¡¹å…¬å¼ä¸é€’å½’å®šä¹‰ ä¸‹é¢è¯æ˜å……åˆ†æ¡ä»¶ï¼ˆå¿…è¦æ¡ä»¶è¯æ³•ç±»ä¼¼ï¼‰ï¼š C0=1,Cn+1=âˆ‘i=0nCiCnâˆ’iâ‡’Cn=1n+1(2nn)C_0=1,C_{n+1}=\\sum_{i=0}^nC_iC_{n-i}\\Rightarrow C_n=\\frac{1}{n+1}\\binom{2n}{n} C0â€‹=1,Cn+1â€‹=i=0âˆ‘nâ€‹Ciâ€‹Cnâˆ’iâ€‹â‡’Cnâ€‹=n+11â€‹(n2nâ€‹) è¯æ˜ï¼š ä»¤ xxx ä¸ºå……åˆ†å°çš„æ­£å®æ•°ï¼Œè®¾æ•°åˆ— {Cn}\\{C_n\\}{Cnâ€‹} çš„æ¯å‡½æ•° G(x)=âˆ‘i=0âˆxiCiG(x)=\\sum_{i=0}^\\infin x^iC_i G(x)=i=0âˆ‘âˆâ€‹xiCiâ€‹ åˆ™æœ‰ G2(x)=(âˆ‘i=0âˆxiCi)2=âˆ‘i=0nxiCiâˆ‘j=0âˆxjCj=âˆ‘i=0âˆâˆ‘j=0âˆxi+jCiCj=âˆ‘i=0âˆâˆ‘k=iâˆxkCiCkâˆ’i=âˆ‘k=0âˆxkâˆ‘i=0kCiCkâˆ’i=âˆ‘k=0âˆxkCk+1G2(x)x=xâˆ‘k=0âˆxkCk+1=âˆ‘k=0âˆxk+1Ck+1=âˆ‘k=1âˆxkCkG2(x)x+1=âˆ‘k=1âˆxkCk+1=âˆ‘k=1âˆxkCk+x0C0=âˆ‘k=0âˆxkCk=G(x)\\begin{aligned} G^2(x)&amp;=\\left(\\sum_{i=0}^\\infin x^iC_i\\right)^2=\\sum_{i=0}^n x^iC_i\\sum_{j=0}^\\infin x^jC_j=\\sum_{i=0}^\\infin\\sum_{j=0}^\\infin x^{i+j}C_iC_j\\\\ &amp;=\\sum_{i=0}^\\infin\\sum_{k=i}^\\infin x^kC_iC_{k-i}=\\sum_{k=0}^\\infin x^k\\sum_{i=0}^kC_iC_{k-i}\\\\ &amp;=\\sum_{k=0}^\\infin x^kC_{k+1}\\\\ G^2(x)x&amp;=x\\sum_{k=0}^\\infin x^kC_{k+1}=\\sum_{k=0}^\\infin x^{k+1}C_{k+1}=\\sum_{k=1}^\\infin x^kC_k\\\\ G^2(x)x+1&amp;=\\sum_{k=1}^\\infin x^kC_k+1=\\sum_{k=1}^\\infin x^kC_k+x^0C_0=\\sum_{k=0}^\\infin x^kC_k=G(x) \\end{aligned} G2(x)G2(x)xG2(x)x+1â€‹=(i=0âˆ‘âˆâ€‹xiCiâ€‹)2=i=0âˆ‘nâ€‹xiCiâ€‹j=0âˆ‘âˆâ€‹xjCjâ€‹=i=0âˆ‘âˆâ€‹j=0âˆ‘âˆâ€‹xi+jCiâ€‹Cjâ€‹=i=0âˆ‘âˆâ€‹k=iâˆ‘âˆâ€‹xkCiâ€‹Ckâˆ’iâ€‹=k=0âˆ‘âˆâ€‹xki=0âˆ‘kâ€‹Ciâ€‹Ckâˆ’iâ€‹=k=0âˆ‘âˆâ€‹xkCk+1â€‹=xk=0âˆ‘âˆâ€‹xkCk+1â€‹=k=0âˆ‘âˆâ€‹xk+1Ck+1â€‹=k=1âˆ‘âˆâ€‹xkCkâ€‹=k=1âˆ‘âˆâ€‹xkCkâ€‹+1=k=1âˆ‘âˆâ€‹xkCkâ€‹+x0C0â€‹=k=0âˆ‘âˆâ€‹xkCkâ€‹=G(x)â€‹ åˆ™ G(x)=G2(x)x+1G(x)=G^2(x)x+1\\\\ G(x)=G2(x)x+1 è§£å¾— G(x)=1Â±1âˆ’4x2xG(x)=\\frac{1\\pm\\sqrt{1-4x}}{2x} G(x)=2x1Â±1âˆ’4xâ€‹â€‹ é‚£ä¹ˆç°åœ¨æˆ‘ä»¬è®¨è®º G1(x)=1âˆ’1âˆ’4x2xG_1(x)=\\dfrac{1-\\sqrt{1-4x}}{2x}G1â€‹(x)=2x1âˆ’1âˆ’4xâ€‹â€‹ å’Œ G2(x)=1+1âˆ’4x2xG_2(x)=\\dfrac{1+\\sqrt{1-4x}}{2x}G2â€‹(x)=2x1+1âˆ’4xâ€‹â€‹ï¼š #1. G(x)=1âˆ’1âˆ’4x2xG(x)=\\dfrac{1-\\sqrt{1-4x}}{2x}G(x)=2x1âˆ’1âˆ’4xâ€‹â€‹ å¼•å…¥å¹¿ä¹‰äºŒé¡¹å¼å®šç† (1+x)Î±=âˆ‘k=0âˆ(Î±k)xk(1+x)^\\alpha=\\sum_{k=0}^\\infin\\binom{\\alpha}{k}x^k (1+x)Î±=k=0âˆ‘âˆâ€‹(kÎ±â€‹)xk å…¶ä¸­ (Î±k)=âˆi=1kÎ±âˆ’i+1i\\binom{\\alpha}{k}=\\prod_{i=1}^k\\frac{\\alpha-i+1}{i}\\\\ (kÎ±â€‹)=i=1âˆkâ€‹iÎ±âˆ’i+1â€‹ åˆ™ G(x)=1âˆ’âˆ‘k=0âˆ(12k)(âˆ’4x)k2x=1âˆ’1âˆ’âˆ‘k=1âˆ(12k)(âˆ’4x)k2x=âˆ’12âˆ‘k=1âˆ(12k)(âˆ’4)kxkâˆ’1=âˆ’12âˆ‘k=0âˆ(12k+1)(âˆ’4)k+1xk=2âˆ‘k=0âˆ(12k+1)(âˆ’4x)kCn=2(12n+1)(âˆ’4)n=2âˆi=1n+112âˆ’iâˆ’1i(âˆ’4)n=2âˆi=0n(12âˆ’i)(n+1)!(âˆ’1)n22n=âˆi=0n(1âˆ’2i)(n+1)!(âˆ’1)n2n=âˆi=1n(âˆ’1)(1âˆ’2i)(n+1)!2n=âˆi=1n(2iâˆ’1)(n+1)!2n=(2nâˆ’1)!!(n+1)!2n\\begin{aligned} G(x)&amp;=\\frac{1-\\sum_{k=0}^\\infin\\binom{\\frac12}{k}(-4x)^k}{2x}=\\frac{1-1-\\sum_{k=1}^\\infin\\binom{\\frac12}{k}(-4x)^k}{2x}\\\\ &amp;=-\\frac{1}{2}\\sum_{k=1}^\\infin\\binom{\\frac12}{k}(-4)^kx^{k-1}=-\\frac{1}{2}\\sum_{k=0}^\\infin\\binom{\\frac12}{k+1}(-4)^{k+1}x^k\\\\ &amp;=2\\sum_{k=0}^\\infin\\binom{\\frac12}{k+1}(-4x)^k\\\\ C_n&amp;=2\\binom{\\frac12}{n+1}(-4)^n=2\\prod_{i=1}^{n+1}\\frac{\\frac12-i-1}{i}(-4)^n=2\\frac{\\prod_{i=0}^{n}(\\frac{1}{2}-i)}{(n+1)!}(-1)^n2^{2n}\\\\ &amp;=\\frac{\\prod_{i=0}^{n}(1-2i)}{(n+1)!}(-1)^n2^n=\\frac{\\prod_{i=1}^{n}(-1)(1-2i)}{(n+1)!}2^n=\\frac{\\prod_{i=1}^{n}(2i-1)}{(n+1)!}2^n\\\\ &amp;=\\frac{(2n-1)!!}{(n+1)!}2^n \\end{aligned}\\\\ G(x)Cnâ€‹â€‹=2x1âˆ’âˆ‘k=0âˆâ€‹(k21â€‹â€‹)(âˆ’4x)kâ€‹=2x1âˆ’1âˆ’âˆ‘k=1âˆâ€‹(k21â€‹â€‹)(âˆ’4x)kâ€‹=âˆ’21â€‹k=1âˆ‘âˆâ€‹(k21â€‹â€‹)(âˆ’4)kxkâˆ’1=âˆ’21â€‹k=0âˆ‘âˆâ€‹(k+121â€‹â€‹)(âˆ’4)k+1xk=2k=0âˆ‘âˆâ€‹(k+121â€‹â€‹)(âˆ’4x)k=2(n+121â€‹â€‹)(âˆ’4)n=2i=1âˆn+1â€‹i21â€‹âˆ’iâˆ’1â€‹(âˆ’4)n=2(n+1)!âˆi=0nâ€‹(21â€‹âˆ’i)â€‹(âˆ’1)n22n=(n+1)!âˆi=0nâ€‹(1âˆ’2i)â€‹(âˆ’1)n2n=(n+1)!âˆi=1nâ€‹(âˆ’1)(1âˆ’2i)â€‹2n=(n+1)!âˆi=1nâ€‹(2iâˆ’1)â€‹2n=(n+1)!(2nâˆ’1)!!â€‹2nâ€‹ åˆ (2n)!=(2n)!!Ã—(2nâˆ’1)!!=(2nâˆ’1)!!Ã—2nn!(2n)!=(2n)!!\\times(2n-1)!!=(2n-1)!!\\times2^nn! (2n)!=(2n)!!Ã—(2nâˆ’1)!!=(2nâˆ’1)!!Ã—2nn! æ‰€ä»¥ Cn=(2nâˆ’1)!!2n(n+1)!=(2n)!n!(n+1)!=1n+1(2n)!(n!)2=1n+1(2nn)\\begin{aligned} C_n&amp;=\\frac{(2n-1)!!2^n}{(n+1)!}=\\frac{(2n)!}{n!(n+1)!}=\\frac{1}{n+1}\\frac{(2n)!}{(n!)^2}=\\frac{1}{n+1}\\binom{2n}{n} \\end{aligned}\\\\ Cnâ€‹â€‹=(n+1)!(2nâˆ’1)!!2nâ€‹=n!(n+1)!(2n)!â€‹=n+11â€‹(n!)2(2n)!â€‹=n+11â€‹(n2nâ€‹)â€‹ #2. G(x)=1âˆ’1âˆ’4x2xG(x)=\\dfrac{1-\\sqrt{1-4x}}{2x}G(x)=2x1âˆ’1âˆ’4xâ€‹â€‹ åŒ #1 å¯å¾— G(x)=1+âˆ‘k=0âˆ(12k)(âˆ’4x)k2x=1xâˆ’2âˆ‘k=0âˆ(12k+1)(âˆ’4x)kG(x)=\\frac{1+\\sum_{k=0}^\\infin\\binom{\\frac12}{k}(-4x)^k}{2x}=\\frac{1}{x}-2\\sum_{k=0}^\\infin\\binom{\\frac12}{k+1}(-4x)^k G(x)=2x1+âˆ‘k=0âˆâ€‹(k21â€‹â€‹)(âˆ’4x)kâ€‹=x1â€‹âˆ’2k=0âˆ‘âˆâ€‹(k+121â€‹â€‹)(âˆ’4x)k ç„¶è€Œï¼Œå¾ˆæ˜æ˜¾æ¯å‡½æ•° G(x)G(x)G(x) æ²¡æœ‰ xâˆ’1x^{-1}xâˆ’1 é¡¹ï¼Œæ‰€ä»¥æ­¤æƒ…å†µä¸æˆç«‹ï¼ˆèˆï¼‰ ç»¼ä¸Šï¼Œ#1 å¾—åˆ° Cn=1n+1(2nn)C_n=\\dfrac{1}{n+1}\\dbinom{2n}{n}Cnâ€‹=n+11â€‹(n2nâ€‹)ï¼Œ#2 èˆå»ï¼Œå³å‘½é¢˜æˆç«‹ è¯æ¯•. å‚è€ƒæ–‡çŒ®ï¼šCatalan numbers Code ä¸€è¡Œ inline ll catalan(int n) {return (C(2*n,n)+mod-C(2*n,n+1))%mod;} åº”ç”¨ å…¶å®è®¸å¤šå…¶åº”ç”¨éƒ½èƒ½å¾ˆæ¸…æ™°å¾—è¯´æ˜ é€šé¡¹å…¬å¼ä¸é€’å½’å®šä¹‰ ä¹‹é—´çš„ç­‰ä»·å…³ç³»ï¼Œä¸‹é¢åœ¨ #1 ä¸¾ä¸ªä¾‹ï¼Œå¾€åç±»ä¼¼ 1. æ‹¬å·åŒ¹é…é—®é¢˜ nnn å¯¹æ‹¬å·èƒ½ç»„æˆå¤šå°‘ä¸ªåˆæ³•æ‹¬å·ä¸²ï¼Ÿ åˆæ³•æ‹¬å·ä¸²çš„å®šä¹‰ï¼š ç©ºä¸²æ˜¯åˆæ³•æ‹¬å·ä¸² è‹¥ AAA æ˜¯åˆæ³•æ‹¬å·ä¸²ï¼Œé‚£ä¹ˆ (A)(A)(A) ä¹Ÿæ˜¯åˆæ³•æ‹¬å·ä¸²ï¼Œç§°è¿™é‡Œçš„å·¦å³ä¸¤æ‹¬å·åŒ¹é… è‹¥ A,BA,BA,B å‡ä¸ºåˆæ³•æ‹¬å·ä¸²ï¼Œé‚£ä¹ˆ ABABAB ä¹Ÿæ˜¯åˆæ³•æ‹¬å·ä¸² å…¶ä½™ä¸²å‡ä¸ä¸ºåˆæ³•æ‹¬å·ä¸² n=3n=3n=3 æ—¶çš„æ‰€æœ‰åˆæ³•æ‹¬å·ä¸²å¦‚ä¸‹ï¼š 1.((())) 2.(()()) 3.(())() 4.()(()) 5.()()() è®¾ç­”æ¡ˆä¸º F(n)F(n)F(n)ï¼Œè€ƒè™‘ä¸‹é¢ä¸¤ç§æ–¹æ³•è¯´æ˜ F(n)=CnF(n)=C_nF(n)=Cnâ€‹ #1. é€’å½’å®šä¹‰æ³• é‡‡ç”¨ç¬¬äºŒæ•°å­¦å½’çº³æ³•è¯æ˜ï¼š å½“ n=0n=0n=0 æ—¶ï¼ŒF(n)=Cn=1F(n)=C_n=1F(n)=Cnâ€‹=1ï¼Œå³å‘½é¢˜æˆç«‹ å‡è®¾å½“ nâ‰¤k (kâˆˆN+)n\\le k\\ (k\\in N_+)nâ‰¤k (kâˆˆN+â€‹) æ—¶ï¼Œå‘½é¢˜æˆç«‹ ä¸‹é¢è¯æ˜ n=k+1n=k+1n=k+1 æ—¶å‘½é¢˜æˆç«‹ï¼š è€ƒè™‘ä¸€ä¸ªåˆæ³•æ‹¬å·ä¸² SSSï¼Œä»¤ SiS_iSiâ€‹ è¡¨ç¤º SSS çš„ç¬¬ iii é¡¹ï¼š å› ä¸º k&gt;1k&gt;1k&gt;1ï¼Œæ‰€ä»¥ SSS ä¸ä¸ºç©ºä¸² è€ƒè™‘ S1S_1S1â€‹ çš„å€¼ï¼Œå› ä¸ºæ‰€æœ‰åˆæ³•æ‹¬å·ä¸²éƒ½ä¸å¯èƒ½ä»¥ ) å¼€å¤´ï¼Œæ‰€ä»¥ S1=S_1=S1â€‹= ( æšä¸¾ S1S_1S1â€‹ çš„åŒ¹é…æ‹¬å·ï¼Œè®¾ S1S_1S1â€‹ ä¸ SiS_iSiâ€‹ åŒ¹é…ï¼Œå› ä¸ºåˆæ³•æ‹¬å·ä¸²å¿…å®šæœ‰å¶æ•°ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾ i=2k+1i=2k+1i=2k+1ï¼Œåˆ™ S1S_1S1â€‹ ä¸ SiS_iSiâ€‹ é—´çš„ 2k2k2k ä¸ªå­—ç¬¦å¿…å®šæ„æˆåˆæ³•æ‹¬å·ä¸²ï¼Œè€Œ SiS_iSiâ€‹ å¾€åçš„ 2(nâˆ’kâˆ’1)2(n-k-1)2(nâˆ’kâˆ’1) ä¹Ÿå¿…å®šæ„æˆåˆæ³•æ‹¬å·ä¸²ã€‚å³è‹¥ S1S_1S1â€‹ ä¸ SiS_iSiâ€‹ åŒ¹é…ï¼Œåˆ™å…± F(k)F(nâˆ’kâˆ’1)=CkCnâˆ’kâˆ’1F(k)F(n-k-1)=C_kC_{n-k-1}F(k)F(nâˆ’kâˆ’1)=Ckâ€‹Cnâˆ’kâˆ’1â€‹ ç§æ„é€ æ–¹æ³• å†è€ƒè™‘ä¸¤ä¸ªåˆæ³•æ‹¬å·ä¸² S1,S2S1,S2S1,S2ï¼Œè‹¥ S11S1_1S11â€‹ çš„åŒ¹é…æ‹¬å·ä¸º S1iS1_iS1iâ€‹ï¼ŒS21S2_1S21â€‹ çš„åŒ¹é…æ‹¬å·ä¸º S2jS2_jS2jâ€‹ï¼Œä¸” iâ‰ ji\\neq jiî€ â€‹=jï¼Œæ˜“å¾— S1â‰ S2S1\\neq S2S1î€ â€‹=S2 å› æ­¤ï¼ŒF(n)=âˆ‘k=0nâˆ’1CkCnâˆ’kâˆ’1=CnF(n)=\\sum\\limits_{k=0}^{n-1}C_kC_{n-k-1}=C_nF(n)=k=0âˆ‘nâˆ’1â€‹Ckâ€‹Cnâˆ’kâˆ’1â€‹=Cnâ€‹ è¯æ¯•. #2. é€šé¡¹å…¬å¼æ³• è€ƒè™‘ç”¨ 111 è¡¨ç¤ºå·¦æ‹¬å·ï¼Œâˆ’1-1âˆ’1 è¡¨ç¤ºå³æ‹¬å·ï¼Œæˆ‘ä»¬å¯ä»¥å°†é—®é¢˜å½’çº¦ä¸ºï¼š ä¸² SSS æ»¡è¶³ âˆ€iâ‰¤2n,(âˆ‘k=1iSk)â‰¥0\\forall i\\le2n,\\left(\\sum\\limits_{k=1}^i S_k\\right)\\ge0 âˆ€iâ‰¤2n,(k=1âˆ‘iâ€‹Skâ€‹)â‰¥0 è€ƒè™‘å…± 2n2n2n ä¸ªä½ç½®ï¼Œæˆ‘ä»¬é€‰å‡ºå…¶ä¸­ nnn ä¸ªä½ç½®æ”¾ 111ï¼Œå‰©ä¸‹æ”¾ âˆ’1-1âˆ’1ï¼Œå³ (2nn)\\dbinom{2n}{n}(n2nâ€‹) ç§æ”¾æ³• ç°åœ¨æˆ‘ä»¬å»æ‰ä¸åˆæ³•çš„æƒ…å†µï¼ˆä¸‹é¢è®¨è®ºçš„æ‰€æœ‰â€œä¸åˆæ³•æƒ…å†µâ€é»˜è®¤ä¸²ä¸­æœ‰å„ nnn ä¸ª 111 å’Œ âˆ’1-1âˆ’1ï¼‰ è‹¥å…¶ä¸åˆæ³•ï¼Œåˆ™å¿…å®šå­˜åœ¨æœ€å°çš„ pppï¼Œä½¿å¾— (âˆ‘k=1pSk)=âˆ’1\\left(\\sum\\limits_{k=1}^p S_k\\right)=-1 (k=1âˆ‘pâ€‹Skâ€‹)=âˆ’1 å³ä¸² S1âˆ¼(pâˆ’1)S_{1\\sim (p-1)}S1âˆ¼(pâˆ’1)â€‹ åˆæ³•ï¼Œè€Œ Sp=âˆ’1S_{p}=-1Spâ€‹=âˆ’1 é‚£ä¹ˆè‹¥æˆ‘ä»¬å°† S(p+1)âˆ¼2nS_{(p+1)\\sim 2n}S(p+1)âˆ¼2nâ€‹ çš„æ‰€æœ‰æ•°å–è´Ÿï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„ç”Ÿæˆä¸² Sâ€²S&#x27;Sâ€²ï¼Œå¯ä»¥å‘ç°æ¯ä¸ª Sâ€²S&#x27;Sâ€² ä¸­éƒ½å«æœ‰ n+1n+1n+1 ä¸ª âˆ’1-1âˆ’1 å’Œ nâˆ’1n-1nâˆ’1 ä¸ª 111ã€‚ è‹¥æˆ‘ä»¬æšä¸¾æ¯ä¸ªå«æœ‰ n+1n+1n+1 ä¸ª âˆ’1-1âˆ’1 å’Œ nâˆ’1n-1nâˆ’1 ä¸ª 111 çš„ç”Ÿæˆä¸² Sâ€²S&#x27;Sâ€²ï¼Œåˆ™å¯ä»¥å¾—åˆ°ä¸€ä¸ªç¥å¥‡çš„ç»“è®ºï¼šæ¯ä¸ª Sâ€²S&#x27;Sâ€² å¿…å®šå¯¹åº”å”¯ä¸€ä¸€ä¸ªä¸åˆæ³•çš„ SSS è€ƒè™‘è¯æ˜ï¼š å­˜åœ¨æ€§ å› ä¸º Sâ€²S&#x27;Sâ€² æœ‰ n+1n+1n+1 ä¸ª âˆ’1-1âˆ’1 å’Œ nâˆ’1n-1nâˆ’1 ä¸ª 111ï¼Œæ‰€ä»¥å¿…å®šå­˜åœ¨ä¸€ä¸ªæœ€å°çš„ pppï¼Œä½¿å¾—(âˆ‘k=1pSkâ€²)=âˆ’1\\left(\\sum\\limits_{k=1}^p S&#x27;_k\\right)=-1 (k=1âˆ‘pâ€‹Skâ€²â€‹)=âˆ’1 æˆ‘ä»¬å†å¯¹ç”Ÿæˆä¸² S(p+1)âˆ¼2nâ€²S&#x27;_{(p+1)\\sim 2n}S(p+1)âˆ¼2nâ€²â€‹ çš„æ‰€æœ‰æ•°å–è´Ÿï¼Œåˆ™å¾—åˆ°åŸä¸² SSS åˆšå¥½å„ nnn ä¸ª 111 å’Œ âˆ’1-1âˆ’1ï¼Œä¸” SSS å¿…å®šæ˜¯ä¸€ä¸ªä¸åˆæ³•ä¸²ï¼Œå› ä¸º(âˆ‘k=1pSk)=âˆ’1\\left(\\sum\\limits_{k=1}^p S_k\\right)=-1 (k=1âˆ‘pâ€‹Skâ€‹)=âˆ’1 å”¯ä¸€æ€§ å› ä¸ºæ¯ä¸ªåŸä¸åˆæ³•ä¸² SSS ç”Ÿæˆå…¶å¯¹åº” Sâ€²S&#x27;Sâ€² ä¸²çš„æ–¹æ³•å”¯ä¸€ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ä¸¤ä¸ªç”Ÿæˆä¸²å¯¹åº”åŒä¸€ä¸ªåŸä¸² è‡³æ­¤ï¼Œæˆ‘ä»¬è¯æ˜äº†æ¯ä¸ªå«æœ‰ n+1n+1n+1 ä¸ª âˆ’1-1âˆ’1 å’Œ nâˆ’1n-1nâˆ’1 ä¸ª 111 çš„ç”Ÿæˆä¸² Sâ€²S&#x27;Sâ€² å¿…å®šå¯¹åº”å”¯ä¸€ä¸€ä¸ªä¸åˆæ³•çš„ SSS å› ä¸ºæˆ‘ä»¬è¦åœ¨ 2n2n2n ä¸ªä½ç½®ä¸­é€‰ n+1n+1n+1 ä¸ªä½ç½®æ”¾ âˆ’1-1âˆ’1ï¼Œå…¶ä½™æ”¾ 111ï¼Œæ‰€ä»¥å¾—åˆ°å…± (2nn+1)\\dbinom{2n}{n+1}(n+12nâ€‹) ç§ç”Ÿæˆä¸²ï¼Œå³å…± (2nn+1)\\dbinom{2n}{n+1}(n+12nâ€‹) ç§ä¸åˆæ³•ä¸² é‚£ä¹ˆåˆæ³•ä¸²çš„æ•°é‡åº”ç­‰äºæ€»æ•°é‡ âˆ’-âˆ’ ä¸åˆæ³•æ•°é‡ï¼Œå³ F(n)=(2nn)âˆ’(2nn+1)=CnF(n)=\\binom{2n}{n}-\\binom{2n}{n+1}=C_n F(n)=(n2nâ€‹)âˆ’(n+12nâ€‹)=Cnâ€‹ è¯æ¯•. 2. è¿›å‡ºæ ˆé—®é¢˜ ä¸€ä¸ªæ— ç©·å¤§çš„æ ˆï¼Œè¿›æ ˆé˜Ÿåˆ—ä¸º 1,2,3,â‹¯ ,n1,2,3,\\cdots,n1,2,3,â‹¯,nï¼Œé—®æœ‰å¤šå°‘ç§ä¸åŒçš„å‡ºæ ˆåºåˆ— å…³äºæ ˆçš„å®šä¹‰å¯å°è¯• æœç´¢å¼•æ“ è¿™é‡Œæˆ‘ä»¬å½’çº¦ä¸ºæ‹¬å·åŒ¹é…é—®é¢˜ï¼š æ¯ä¸ªæ‹¬å·ä¸²è¡¨ç¤ºä¸€æ¡æŒ‡ä»¤ï¼Œ( è¡¨ç¤ºé˜Ÿé¦–å…ƒç´ å…¥æ ˆï¼Œ) è¡¨ç¤ºæ ˆé¡¶å…ƒç´ å‡ºæ ˆ å¯ä»¥å‘ç°ï¼Œæ¯ä¸ªåˆæ³•æ‹¬å·ä¸²éƒ½å¯¹åº”å”¯ä¸€ä¸€ç§è¿›å‡ºæ ˆç­–ç•¥ï¼Œå¹¶ä¸”è¿™ä¸ªè¿›å‡ºæ ˆç­–ç•¥å¿…å®šåˆæ³• å”¯ä¸€æ€§å¾ˆæ˜¾ç„¶ï¼Œåˆæ³•æ€§ä¸‹é¢ç»™å‡ºè¯æ˜ï¼š è€ƒè™‘ä¸åˆæ³•çš„æƒ…å†µæ— é 222 ç§ï¼Œä¸€ç§æ˜¯æ‰€æœ‰å…ƒç´ è¿›æ ˆåè¿˜åœ¨å‘å‡ºâ€œè¿›æ ˆâ€æŒ‡ä»¤ï¼Œå¦ä¸€ç§æ˜¯æ ˆä¸­æ²¡æœ‰å…ƒç´ äº†è¿˜å‘å‡ºâ€œå‡ºæ ˆâ€æŒ‡ä»¤ å¯¹äºæƒ…å†µä¸€ï¼Œå› ä¸ºåˆæ³•æ‹¬å·ä¸²åªæœ‰ nnn ä¸ª (ï¼Œæ‰€ä»¥åªè¿›æ ˆ nnn æ¬¡ï¼Œä¸å¯èƒ½å‡ºç°æ­¤æƒ…å†µ å¯¹äºæƒ…å†µäºŒï¼Œè€ƒè™‘åˆ°æ¯ä¸ª ) ä¹‹å‰éƒ½ä¸ä¸€ä¸ª ( ç›¸åŒ¹é…ï¼Œå³æ¯æ¬¡å‡ºæ ˆæŒ‡ä»¤éƒ½æœ‰ä¸€ä¸ªè¿›æ ˆæŒ‡ä»¤ä¸å…¶åŒ¹é…ï¼Œæ‰€ä»¥ä¹Ÿä¸å¯èƒ½å‡ºç°æ­¤æƒ…å†µ ç»¼ä¸Šï¼Œæˆ‘ä»¬å°†è¿›å‡ºæ ˆé—®é¢˜è§„çº¦ä¸ºäº†æ‹¬å·åŒ¹é…é—®é¢˜ 3. äºŒå‰æ ‘ç§ç±»é—®é¢˜ nnn ä¸ªæ— åºèŠ‚ç‚¹æ„æˆçš„äºŒå‰æ ‘å…±å¤šå°‘ç§ æˆ‘ä»¬è®¾ nnn ä¸ªæ— åºèŠ‚ç‚¹æ„æˆçš„äºŒå‰æ ‘å…± F(n)F(n)F(n) ç§ï¼Œä¸‹é¢è¯æ˜ F(n)=CnF(n)=C_nF(n)=Cnâ€‹ å†æ¬¡è€ƒè™‘ç¬¬äºŒæ•°å­¦å½’çº³æ³•è¯æ˜ï¼š å½“ n=0n=0n=0 æ—¶ï¼Œåªæœ‰ä¸€ç§æƒ…å†µå³ç©ºäºŒå‰æ ‘ï¼Œæ‰€ä»¥ F(n)=Cn=1F(n)=C_n=1F(n)=Cnâ€‹=1ï¼Œå³å‘½é¢˜æˆç«‹ å‡è®¾å½“ nâ‰¤k (kâˆˆN+)n\\le k\\ (k\\in N_+)nâ‰¤k (kâˆˆN+â€‹) æ—¶ï¼Œå‘½é¢˜æˆç«‹ ä¸‹é¢è¯æ˜ n=k+1n=k+1n=k+1 æ—¶å‘½é¢˜æˆç«‹ï¼š æˆ‘ä»¬å…ˆæŒ‰ä¸­åºéå†çš„é¡ºåºç»™æ¯ä¸ªèŠ‚ç‚¹ç¼–å· è€ƒè™‘æšä¸¾æ ‘æ ¹ä¸º 1âˆ¼n1\\sim n1âˆ¼n çš„æƒ…å†µï¼Œè‹¥æ ‘æ ¹ä¸º iiiï¼Œåˆ™ 1âˆ¼(iâˆ’1)1\\sim (i-1)1âˆ¼(iâˆ’1) è¿™ iâˆ’1i-1iâˆ’1 ä¸ªèŠ‚ç‚¹ä¸º iii çš„å·¦å­æ ‘ï¼Œè€Œ (i+1)âˆ¼n(i+1)\\sim n(i+1)âˆ¼n è¿™ nâˆ’in-inâˆ’i ä¸ªèŠ‚ç‚¹ä¸º iii çš„å³å­æ ‘ï¼Œå³ä»¥ iii ä¸ºæ ¹çš„äºŒå‰æ ‘å…± F(iâˆ’1)F(nâˆ’i)=Ciâˆ’1Cnâˆ’iF(i-1)F(n-i)=C_{i-1}C_{n-i}F(iâˆ’1)F(nâˆ’i)=Ciâˆ’1â€‹Cnâˆ’iâ€‹ ç§æƒ…å†µ å› æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°F(n)=âˆ‘i=1nCiâˆ’1Cnâˆ’i=CnF(n)=\\sum_{i=1}^nC_{i-1}C_{n-i}=C_n F(n)=i=1âˆ‘nâ€‹Ciâˆ’1â€‹Cnâˆ’iâ€‹=Cnâ€‹ å³å‘½é¢˜æˆç«‹ è¯æ¯•. é™„ï¼š ä¸­åºéå†ï¼ˆLDRï¼‰æ˜¯äºŒå‰æ ‘éå†çš„ä¸€ç§ï¼Œä¹Ÿå«åšä¸­æ ¹éå†ã€ä¸­åºå‘¨æ¸¸ã€‚åœ¨äºŒå‰æ ‘ä¸­ï¼Œä¸­åºéå†é¦–å…ˆéå†å·¦å­æ ‘ï¼Œç„¶åè®¿é—®æ ¹ç»“ç‚¹ï¼Œæœ€åéå†å³å­æ ‘ã€‚å¦‚ä¸‹å›¾äºŒå‰æ ‘ä¸­åºéå†é¡ºåºä¸º 4 2 8 5 9 1 6 3 7 10 12345896710 4. ç½‘æ ¼è·¯å¾„é—®é¢˜ å¯¹äºä¸€ä¸ª nÃ—nn\\times nnÃ—n çš„æ­£æ–¹å½¢ç½‘æ ¼ï¼Œæ¯æ¬¡æˆ‘ä»¬èƒ½æ²¿ç€ç½‘æ ¼å‘å³æˆ–è€…å‘ä¸Šç§»åŠ¨ä¸€æ ¼ï¼Œé‚£ä¹ˆä»å·¦ä¸‹è§’åˆ°å³ä¸Šè§’çš„æ‰€æœ‰åœ¨å¯¹è§’çº¿ä¸‹æ–¹çš„è·¯å¾„æ€»æ•°ä¸ºå¤šå°‘ï¼Ÿ ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹å›¾åˆ—ä¸¾äº†æ‰€æœ‰ n=4n=4n=4 æ—¶çš„æƒ…å†µï¼š ç»§ç»­è€ƒè™‘è§„çº¦ï¼Œæˆ‘ä»¬å°†å½’çº¦ä¸ºè¿›å‡ºæ ˆé—®é¢˜ï¼Œè¿›æ ˆä¸ºå‘å³èµ°ï¼Œå‡ºæ ˆä¸ºå‘ä¸Šèµ°ï¼Œä¸‹é¢è¯æ˜æ¯ç§è¿›å‡ºæ ˆç­–ç•¥ä¸ç½‘æ ¼è·¯å¾„ä¸€ä¸€å¯¹åº”ï¼š å”¯ä¸€æ€§ä¹Ÿå¾ˆæ˜¾ç„¶ï¼Œåˆæ³•æ€§ä¸‹é¢ç»™å‡ºè¯æ˜ï¼š è€ƒè™‘ç½‘æ ¼è·¯å¾„é—®é¢˜ä¹Ÿå¯ä»¥ç†è§£ä¸ºæ¯ä¸€æ­¥èµ°å®Œåä¿è¯ç«–å‘è·¯å¾„ä¸ªæ•°å°äºç­‰äºæ¨ªå‘è·¯å¾„ä¸ªæ•°ï¼ˆå³åœ¨å¯¹è§’çº¿ä¸‹æ–¹ï¼‰ï¼Œä¸”èµ°åˆ°å³ä¸Šè§’æ—¶ç«–å‘è·¯å¾„ä¸æ¨ªå‘è·¯å¾„å‡ä¸º nnn æ¡ï¼ˆåœ¨ç½‘æ ¼ä¸Šèµ°ï¼‰ è€Œæ¯ç§è¿›å‡ºæ ˆç­–ç•¥ä¹Ÿæ»¡è¶³æ¯ä¸€æ­¥æ ˆä¸­å…ƒç´ ä¸ªæ•°å¤§äºç­‰äº 000ï¼Œå³è¿›æ ˆæ•°å¤§äºç­‰äºå‡ºæ ˆæ•°ï¼›ä¸€å…± nnn ä¸ªå…ƒç´ è¿›å‡ºæ ˆå„ 111 æ¬¡ï¼Œå³è¿›å‡ºæ ˆæ•°å‡ä¸º nnn æ‰€ä»¥æˆ‘ä»¬å‘ç°è¿›å‡ºæ ˆç­–ç•¥çš„æ¡ä»¶ä¸ç½‘æ ¼è·¯å¾„çš„æ¡ä»¶æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥æ¯ç§è¿›å‡ºæ ˆç­–ç•¥å¯¹åº”çš„ç½‘æ ¼è·¯å¾„å‡åˆæ³• 5. å‡¸å¤šè¾¹å½¢åˆ†å‰²é—®é¢˜ æ±‚ä¸€ä¸ªå‡¸ nnn è¾¹å½¢åŒºåŸŸåˆ’åˆ†æˆä¸‰è§’å½¢åŒºåŸŸçš„æ–¹æ³•æ•° ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹å›¾åˆ—ä¸¾äº† n=6n=6n=6 æ—¶çš„æ‰€æœ‰æ–¹æ¡ˆï¼š è®¾å‡¸ n (nâ‰¥2)n\\ (n\\ge2)n (nâ‰¥2) è¾¹å½¢çš„åˆ’åˆ†æ–¹æ³•å…± F(n)F(n)F(n) ç§ï¼Œä¸‹é¢è¯æ˜ F(n)=Cnâˆ’2F(n)=C_{n-2}F(n)=Cnâˆ’2â€‹ åŒæ ·è€ƒè™‘ç¬¬äºŒæ•°å­¦å½’çº³æ³•è¯æ˜ï¼š å½“ n=2n=2n=2 æ—¶ï¼Œä¸å­˜åœ¨è¿™æ ·çš„å‡¸ nnn è¾¹å½¢ï¼Œæ‰€ä»¥æœ‰å”¯ä¸€ä¸€ç§æƒ…å†µå°±æ˜¯ä¸åˆ†ï¼ŒF(n)=Cnâˆ’2=1F(n)=C_{n-2}=1F(n)=Cnâˆ’2â€‹=1ï¼Œå³å‘½é¢˜æˆç«‹ å‡è®¾å½“ nâ‰¤k (k&gt;2)n\\le k\\ (k&gt;2)nâ‰¤k (k&gt;2) æ—¶ï¼Œå‘½é¢˜æˆç«‹ ä¸‹é¢è¯æ˜ n=k+1n=k+1n=k+1 æ—¶å‘½é¢˜æˆç«‹ï¼š æˆ‘ä»¬å…ˆé¡ºæ—¶é’ˆç»™è¿™ä¸ªå‡¸ nnn è¾¹å½¢çš„é¡¶ç‚¹ç¼–å· é€‰å–ä¸€æ¡è¾¹ 1âˆ’21-21âˆ’2ï¼Œæ˜¾ç„¶è¿™æ¡è¾¹å¿…å®šåœ¨å”¯ä¸€ä¸€ä¸ªä¸‰è§’å½¢ä¸­ï¼ˆä¹Ÿå¾ˆæ˜æ˜¾ï¼Œè‹¥ä¸¤ç§æ–¹æ¡ˆä¸­ 1âˆ’21-21âˆ’2 æ‰€åœ¨çš„ä¸‰è§’å½¢ä¸åŒåˆ™ä¸¤æ–¹æ¡ˆä¹Ÿä¸åŒï¼Œå³æšä¸¾å…¶æ‰€åœ¨ä¸‰è§’å½¢å¯ä»¥ä¿è¯ä¸é‡å¤ä¸é—æ¼ï¼‰ è¿™ä¸ªä¸‰è§’å½¢çš„å…¶ä¸­ä¸¤ä¸ªé¡¶ç‚¹å°±æ˜¯ 111 å’Œ 222ï¼Œæ‰€ä»¥æˆ‘ä»¬æšä¸¾ç¬¬ä¸‰ä¸ªé¡¶ç‚¹ è®¾ç¬¬ä¸‰ä¸ªé¡¶ç‚¹ä¸º iiiï¼Œåˆ™æˆ‘ä»¬å‘ç°å¦‚æœæŠŠè¿™ä¸ªä¸‰è§’å½¢åˆ‡æ‰ä¹‹åä¼šå‰©ä¸‹ä¸¤ä¸ªå‡¸å¤šè¾¹å½¢ï¼Œä¸€ä¸ªä¸º iâˆ’1i-1iâˆ’1 è¾¹å½¢ï¼ˆé¡¶ç‚¹åˆ†åˆ«ä¸º 2,3,â‹¯ ,i2,3,\\cdots,i2,3,â‹¯,iï¼‰ï¼Œå¦ä¸€ä¸ªä¸º nâˆ’i+2n-i+2nâˆ’i+2 è¾¹å½¢ï¼ˆé¡¶ç‚¹åˆ†åˆ«ä¸º i,i+1,â‹¯ ,n,1i,i+1,\\cdots,n,1i,i+1,â‹¯,n,1ï¼‰ æ‰€ä»¥å¯å¾—F(n)=âˆ‘i=3nF(iâˆ’1)F(nâˆ’i+2)=âˆ‘i=3nCiâˆ’3Cnâˆ’i=âˆ‘i=0nâˆ’3CiC(nâˆ’3)âˆ’i=Cnâˆ’2F(n)=\\sum_{i=3}^nF(i-1)F(n-i+2)=\\sum_{i=3}^nC_{i-3}C_{n-i}=\\sum_{i=0}^{n-3}C_iC_{(n-3)-i}=C_{n-2} F(n)=i=3âˆ‘nâ€‹F(iâˆ’1)F(nâˆ’i+2)=i=3âˆ‘nâ€‹Ciâˆ’3â€‹Cnâˆ’iâ€‹=i=0âˆ‘nâˆ’3â€‹Ciâ€‹C(nâˆ’3)âˆ’iâ€‹=Cnâˆ’2â€‹ è¯æ¯•. é™„å›¾ï¼š 6. è¿çº¿ä¸ç›¸äº¤é—®é¢˜ åœ¨åœ†ä¸Šé€‰æ‹© 2n2n2n ä¸ªç‚¹ï¼Œè¿™äº›ç‚¹ä¸¤ä¸¤è¿æ¥ä½¿å¾—æ‰€å¾—åˆ°çš„ nnn æ¡çº¿æ®µä¸ç›¸äº¤ï¼Œæ±‚æ–¹æ¡ˆæ•° ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹å›¾åˆ—ä¸¾äº† n=4n=4n=4 çš„æ‰€æœ‰æ–¹æ¡ˆï¼š è®¾åœ†ä¸Š 2n2n2n ä¸ªç‚¹ä¸¤ä¸¤è¿çº¿ä¸ç›¸äº¤æ–¹æ¡ˆæ•°ä¸º F(n)F(n)F(n)ï¼Œä¸‹é¢è¯æ˜ F(n)=CnF(n)=C_nF(n)=Cnâ€‹ ä¾ç„¶æ˜¯ç¬¬äºŒæ•°å­¦å½’çº³æ³•ï¼š å½“ n=0n=0n=0 æ—¶ï¼Œåœ†ä¸Šæ²¡æœ‰ç‚¹ï¼Œæ‰€ä»¥æœ‰å”¯ä¸€ä¸€ç§æƒ…å†µå°±æ˜¯ä¸è¿çº¿ï¼Œå³ F(n)=Cn=1F(n)=C_n=1F(n)=Cnâ€‹=1ï¼Œå‘½é¢˜æˆç«‹ å‡è®¾å½“ nâ‰¤k (kâˆˆN+)n\\le k\\ (k\\in N_+)nâ‰¤k (kâˆˆN+â€‹) æ—¶ï¼Œå‘½é¢˜æˆç«‹ ä¸‹é¢è¯æ˜ n=k+1n=k+1n=k+1 æ—¶å‘½é¢˜æˆç«‹ï¼š æˆ‘ä»¬å…ˆé¡ºæ—¶é’ˆç»™è¿™ nnn ä¸ªç‚¹ç¼–å·ï¼Œæˆ‘ä»¬è®¨è®ºä¸ 111 ç›¸è¿çš„ç‚¹ iii é¦–å…ˆ iii å¿…å®šä¸ºå¶æ•°ã€‚å› ä¸º iii è‹¥ä¸ºå¥‡æ•°ï¼Œåˆ™ 111 è‡³ iii æœ‰å¥‡æ•°ä¸ªç‚¹ï¼Œè¿™äº›ç‚¹çš„è¿çº¿ä¸èƒ½è·¨è¶Š 1âˆ’i1-i1âˆ’i è¿™æ¡çº¿ï¼Œè€Œå¥‡æ•°ä¸ªç‚¹åˆæ˜¯ä¸å¯èƒ½ä¸¤ä¸¤è¿æ¥çš„ï¼Œæ‰€ä»¥ä¸æˆç«‹ é‚£ä¹ˆè®¾ i=2j+1i=2j+1i=2j+1ï¼Œåˆ™ 1âˆ’i1-i1âˆ’i çš„å·¦è¾¹æœ‰ 2j2j2j ä¸ªç‚¹ï¼Œå³è¾¹æœ‰ 2(nâˆ’jâˆ’1)2(n-j-1)2(nâˆ’jâˆ’1) ä¸ªç‚¹ï¼Œå³å…± F(j)F(2(nâˆ’jâˆ’1)F(j)F(2(n-j-1)F(j)F(2(nâˆ’jâˆ’1) ç§æ–¹æ¡ˆ æ‰€ä»¥æœ‰F(n)=âˆ‘j=0nâˆ’1F(j)F(nâˆ’jâˆ’1)=âˆ‘j=0nâˆ’1CjCnâˆ’jâˆ’1=CnF(n)=\\sum_{j=0}^{n-1}F(j)F(n-j-1)=\\sum_{j=0}^{n-1}C_jC_{n-j-1}=C_n F(n)=j=0âˆ‘nâˆ’1â€‹F(j)F(nâˆ’jâˆ’1)=j=0âˆ‘nâˆ’1â€‹Cjâ€‹Cnâˆ’jâˆ’1â€‹=Cnâ€‹ è¯æ¯•. é™„å›¾ï¼š 7. é˜¶æ¢¯åˆ‡å‰²é—®é¢˜ æ±‚ nnn ä¸ªçŸ©å½¢å¡«å……ä¸€ä¸ªé«˜åº¦ä¸º nnn çš„é˜¶æ¢¯çŠ¶å›¾å½¢çš„æ–¹æ¡ˆæ•° ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹å›¾åˆ—ä¸¾äº† n=4n=4n=4 çš„æ‰€æœ‰æ–¹æ¡ˆ è®¾ nnn é˜¶é˜¶æ¢¯å…± F(n)F(n)F(n) ç§æ–¹æ¡ˆï¼Œä¸‹é¢è¯æ˜ F(n)=CnF(n)=C_nF(n)=Cnâ€‹ ç¬¬ äºŒ æ•° å­¦ å½’ çº³ æ³• å½“ n=0n=0n=0 æ—¶ï¼Œæ²¡æœ‰é˜¶æ¢¯ï¼Œæ‰€ä»¥æœ‰å”¯ä¸€ä¸€ç§æƒ…å†µå°±æ˜¯ä¸å¡«çŸ©å½¢ï¼Œå³ F(n)=Cn=1F(n)=C_n=1F(n)=Cnâ€‹=1ï¼Œå‘½é¢˜æˆç«‹ å‡è®¾å½“ nâ‰¤k (kâˆˆN+)n\\le k\\ (k\\in N_+)nâ‰¤k (kâˆˆN+â€‹) æ—¶ï¼Œå‘½é¢˜æˆç«‹ ä¸‹é¢è¯æ˜ n=k+1n=k+1n=k+1 æ—¶å‘½é¢˜æˆç«‹ï¼š è€ƒè™‘å¦‚ä¸‹å›¾ä¸­ç°è‰²çš„ nnn ä¸ªé˜¶æ¢¯é¡¶ç«¯çš„æ ¼å­ å®ƒä»¬ä¸€å®šäº’ä¸åœ¨ä¸€ä¸ªçŸ©å½¢å†…ï¼Œå› ä¸ºè¿™ä¹‹ä¸­ä»»æ„ä¸¤ä¸ªå¦‚æœåœ¨ä¸€ä¸ªçŸ©å½¢å†…é‚£é‚£ä¸ªçŸ©å½¢å¿…å®šä»é˜¶æ¢¯çš„å³ä¸Šæ–¹è¶…å‡ºé˜¶æ¢¯ æˆ‘ä»¬å†æšä¸¾é˜¶æ¢¯å·¦ä¸‹è§’çš„æ ¼å­ï¼ˆå¦‚å›¾ä¸­ç»¿æ ¼ï¼‰æ‰€åœ¨çš„çŸ©å½¢ã€‚è‹¥å®ƒåŒ…å«ä»ä¸Šå¾€ä¸‹æ•°ç¬¬ iii ä¸ªç°æ ¼å­ï¼Œé‚£ä¹ˆå®ƒä¸Šé¢å°±éš”ç¦»å‡ºäº†ä¸€ä¸ª iâˆ’1i-1iâˆ’1 é˜¶çš„é˜¶æ¢¯ï¼Œå³è¾¹éš”ç¦»å‡ºäº†ä¸€ä¸ª nâˆ’in-inâˆ’i é˜¶çš„é˜¶æ¢¯ï¼Œå³å…± F(iâˆ’1)F(nâˆ’i)F(i-1)F(n-i)F(iâˆ’1)F(nâˆ’i) ç§æ–¹æ¡ˆ æ‰€ä»¥æœ‰F(n)=âˆ‘i=1nF(iâˆ’1)F(nâˆ’i)=âˆ‘i=1nCiâˆ’1Cnâˆ’i=CnF(n)=\\sum_{i=1}^nF(i-1)F(n-i)=\\sum_{i=1}^nC_{i-1}C_{n-i}=C_n F(n)=i=1âˆ‘nâ€‹F(iâˆ’1)F(nâˆ’i)=i=1âˆ‘nâ€‹Ciâˆ’1â€‹Cnâˆ’iâ€‹=Cnâ€‹ è¯æ¯•. 8. æ ¼å­å¡«æ•°é—®é¢˜ åœ¨ä¸€ä¸ª 2Ã—n2\\times n2Ã—n çš„æ ¼å­ä¸­å¡«å…¥ 111 åˆ° 2n2n2n è¿™äº›æ•°ï¼Œæ±‚ä½¿å¾—æ¯ä¸ªæ ¼å­å†…çš„æ•°å€¼éƒ½æ¯”å…¶å·¦ä¸Šæ–¹çš„æ‰€æœ‰æ•°å€¼å°çš„æƒ…å†µæ•° ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹è¡¨åˆ—ä¸¾äº†æ‰€æœ‰ n=4n=4n=4 çš„æƒ…å†µ 1 2 3 4 1 2 3 5 1 2 3 6 1 2 3 7 1 2 4 5 1 2 4 6 1 2 4 7 5 6 7 8 4 6 7 8 4 5 7 8 4 5 6 8 3 6 7 8 3 5 7 8 3 5 6 8 1 2 5 6 1 2 5 7 1 3 4 5 1 3 4 6 1 3 4 7 1 3 5 6 1 3 5 7 3 4 7 8 3 4 6 8 2 6 7 8 2 5 7 8 2 5 6 8 2 4 7 8 2 4 6 8 è€ƒè™‘è§„çº¦è‡³æ‹¬å·åŒ¹é…é—®é¢˜ï¼Œæˆ‘ä»¬æšä¸¾æ¯ä¸ªé•¿åº¦ä¸º 2n2n2n çš„åˆæ³•æ‹¬å·ä¸² SSSï¼Œå…¶å¯¹åº”çš„å¡«æ•°æ–¹æ¡ˆï¼šè‹¥ SiS_iSiâ€‹ ä¸º ( åˆ™ iii æ ¼å­æ”¾ç¬¬ä¸€è¡Œï¼Œä¸º ) åˆ™æ”¾ç¬¬äºŒè¡Œï¼ˆå› ä¸ºæ ¼å­é‡Œçš„æ¯è¡Œéƒ½æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬é¡ºç€æ”¾å°±å¥½ï¼‰ æ¯”å¦‚ä¸² ()(()()) å¯¹åº”çš„å¡«æ•°æ–¹æ¡ˆä¸ºï¼š 1 3 4 6 2 5 7 8 æˆ‘ä»¬è¯æ˜åˆæ³•æ‹¬å·ä¸²å’Œå¡«æ•°ç­–ç•¥å¯å¦‚ä¸Šä¸€ä¸€å¯¹åº”ï¼š å”¯ä¸€æ€§äº¦å¾ˆå®¹æ˜“è¯æ˜ï¼Œæˆ‘ä»¬ä¸»è¦çœ‹åˆæ³•æ€§çš„è¯æ˜ é¦–å…ˆï¼Œå¯ä»¥è‚¯å®šæ­¤åˆæ³•æ‹¬å·ä¸²æœ‰å„ nnn ä¸ª ( å’Œ )ï¼Œå³å…¶å¯¹åº”çš„å¡«æ•°ç­–ç•¥å¡«æ»¡äº†ä¸¤è¡Œ ç„¶åæˆ‘ä»¬å‘ç°å¯¹äºæ¯ä¸ªä½ç½® kâ‰¤2nk\\le2nkâ‰¤2n åˆæ³•æ‹¬å·ä¸²å¿…ç„¶æ»¡è¶³ âˆ‘i=1k[Si=( ] â‰¥ âˆ‘i=1k[Si=) ]\\sum_{i=1}^k[S_i=\\texttt{\\color{brown}(}\\ ]\\ \\ge\\ \\sum_{i=1}^k[S_i=\\texttt{\\color{brown})}\\ ] i=1âˆ‘kâ€‹[Siâ€‹=( ] â‰¥ i=1âˆ‘kâ€‹[Siâ€‹=) ] å³å‰ kkk ä¸ªå­—ç¬¦ä¸­ ( çš„ä¸ªæ•°å¤§äºç­‰äº ) çš„ä¸ªæ•°ï¼Œæ”¾åœ¨æ ¼å­å¡«æ•°çš„æ–¹æ¡ˆé‡Œå¯¹åº”çš„å°±æ˜¯å°äºç­‰äº kkk çš„æ•°è‡³å°‘ä¸€åŠåœ¨ç¬¬ä¸€è¡Œ æ‰€ä»¥å¯¹äºæ¯ä¸€ä¸ªåœ¨ç¬¬äºŒè¡Œæ•°éƒ½æœ‰è‡³å°‘ä¸€åŠå°äºç­‰äºå®ƒçš„æ•°åœ¨ç¬¬ä¸€è¡Œæ‰€ä»¥å®ƒçš„å·¦ä¸Šæ–¹çš„æ‰€æœ‰æ•°éƒ½æ¯”å®ƒå°ï¼Œæ»¡è¶³å…¶è¦æ±‚ ç»¼ä¸Šï¼Œæˆ‘ä»¬å·²å°†æ ¼å­å¡«æ•°é—®é¢˜è§„çº¦è‡³æ‹¬å·åŒ¹é…é—®é¢˜ è¯æ¯•. ","link":"https://imzzy1201.github.io/post/QhLY5-IRd/"},{"title":"æ‚é¢˜ - BZOJ2839 é›†åˆè®¡æ•°","content":" S={x:xâˆ‰x}S=\\{x:x\\notin x\\}S={x:xâˆˆ/â€‹x} ğŸ¤” é¢˜é¢ï¼ˆé»‘æš—çˆ†ç‚¸OJï¼‰ å‰ç½®çŸ¥è¯† é›†åˆç›¸å…³å†…å®¹ äºŒé¡¹å¼åæ¼” æ€è·¯ è€ƒè™‘è½¬æ¢ä¸ºè®¡ç®—â€œé’¦å®šâ€çš„å€¼ï¼šå…ˆæ±‚ fif_ifiâ€‹ è¡¨ç¤ºé’¦å®šäº¤é›†æœ‰ iii ä¸ªå…ƒç´ ï¼Œå³é€‰å‡ºçš„å­é›†çš„äº¤é›†åŒ…å«é€‰å®š iii ä¸ªå…ƒç´ çš„æ–¹æ¡ˆæ•°ã€‚ é¦–å…ˆï¼Œnnn ä¸ªå…ƒç´ ä¸­é€‰å‡º iii ä¸ªå…ƒç´ ï¼Œå³æœ‰ CniC_n^iCniâ€‹ ç§é€‰æ³•ã€‚ç„¶åï¼Œæˆ‘ä»¬å›ºå®šæ¯ä¸ªé€‰å–çš„å­é›†éƒ½åŒ…å«è¿™ iii ä¸ªå…ƒç´ ï¼Œå‰©ä¸‹çš„å¯é€‰å¯ä¸é€‰ã€‚å¯¹äºå…¶ä¸­ä¸€ä¸ªå­é›†ï¼Œå› ä¸ºå‰©ä¸‹å…± nâˆ’in-inâˆ’i ä¸ªå…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ éƒ½å¯ä»¥é€‰æˆ–ä¸é€‰ï¼Œæ‰€ä»¥å…± 2nâˆ’i2^{n-i}2nâˆ’i ç§å­é›†å¯ä¾›é€‰æ‹©ã€‚è€Œè¿™ 2nâˆ’i2^{n-i}2nâˆ’i ç§å­é›†ä¸­æ¯ä¸ªå­é›†åˆéƒ½å¯ä»¥é€‰å–æˆ–ä¸é€‰å–ï¼Œæ‰€ä»¥å…± 22nâˆ’12^{2^{n-1}}22nâˆ’1 ç§é€‰å–æ–¹æ¡ˆï¼Œæ’é™¤ä»€ä¹ˆéƒ½ä¸é€‰çš„ä¸€ç§æƒ…å†µï¼Œå³å…± 22nâˆ’1âˆ’12^{2^{n-1}}-122nâˆ’1âˆ’1 ç§æƒ…å†µã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š fi=(ni)(22nâˆ’1âˆ’1)f_i=\\dbinom{n}{i}\\left(2^{2^{n-1}}-1\\right) fiâ€‹=(inâ€‹)(22nâˆ’1âˆ’1) å†å›å¤´æ¥ï¼Œè‹¥å®šä¹‰ gig_igiâ€‹ ä¸ºäº¤é›†å…ƒç´ åˆšå¥½ iii ä¸ªçš„å–æ³•ï¼Œå³é¢˜ç›®æ‰€æ±‚ï¼Œå› ä¸ºæ¯ç§äº¤é›†å…ƒç´ ä¸ªæ•°ä¸º jjj çš„æ–¹æ¡ˆéƒ½è¢«é‡å¤è®¡ç®— CjiC_j^iCjiâ€‹ æ¬¡ï¼Œæ‰€ä»¥ï¼š fi=âˆ‘j=in(ji)gjf_i=\\sum\\limits_{j=i}^n\\dbinom{j}{i}g_j fiâ€‹=j=iâˆ‘nâ€‹(ijâ€‹)gjâ€‹ å¥—ç”¨äºŒé¡¹å¼åæ¼”çš„å…¬å¼ï¼Œå¾—åˆ°ï¼š gk=âˆ‘i=kn(âˆ’1)iâˆ’k(ik)fi=âˆ‘i=kn(âˆ’1)iâˆ’k(ik)(ni)(22nâˆ’iâˆ’1)\\begin{aligned}\\\\ g_k&amp;=\\sum\\limits_{i=k}^n(-1)^{i-k}\\dbinom{i}{k}f_i\\\\ &amp;=\\sum\\limits_{i=k}^n(-1)^{i-k}\\dbinom{i}{k}\\dbinom{n}{i}\\left(2^{2^{n-i}}-1\\right) \\end{aligned} gkâ€‹â€‹=i=kâˆ‘nâ€‹(âˆ’1)iâˆ’k(kiâ€‹)fiâ€‹=i=kâˆ‘nâ€‹(âˆ’1)iâˆ’k(kiâ€‹)(inâ€‹)(22nâˆ’iâˆ’1)â€‹ æ³¨æ„ï¼šè¿™é‡Œçš„ 22nâˆ’i2^{2^{n-i}}22nâˆ’i ä¸å»ºè®®å¿«é€Ÿå¹‚ï¼Œå¯ä»¥å€’åºé€’æ¨ï¼š22x+1=(22x)22^{2^{x+1}}=(2^{2^x})^222x+1=(22x)2 Code #include&lt;bits/stdc++.h&gt; #define ll long long #define rgi register int #define rgl register ll #define mian main struct fastin{ int _ch,_f; inline fastin&amp; operator&gt;&gt;(char&amp;c) {c=getchar(); return *this;} template&lt;typename _Tp&gt; inline fastin&amp; operator&gt;&gt;(_Tp&amp;_x){ _x=0; while(!isdigit(_ch)) _f|=(_ch==45),_ch=getchar(); while(isdigit(_ch)) _x=(_x&lt;&lt;1)+(_x&lt;&lt;3)+(_ch^48),_ch=getchar(); _f&amp;&amp;(_x=-_x,_f=0); return *this;} fastin() {_ch=_f=0;} }fin; struct fastout{ #define endl '\\n' int _num[32],_head; inline fastout&amp; operator&lt;&lt;(char c) {putchar(c); return *this;} template&lt;typename _Tp&gt; inline fastout&amp; operator&lt;&lt;(_Tp _x){ _Tp _k; if(_x==0) {putchar('0'); return *this;} if(_x&lt;0) putchar('-'),_x=-_x; while(_x&gt;0) _k=_x/10,++_head,_num[_head]=(_x-(_k&lt;&lt;1)-(_k&lt;&lt;3))^48,_x=_k; while(_head&gt;0) putchar(_num[_head]),--_head; return *this;} fastout() {_head=0;} }fout; // ---------------------------- // #define int ll // using namespace std; const int maxn=1000004,maxm=1000004; const int mod=1000000007,inf=1000000007; const int debug=0; inline ll powmod(ll a,ll b) { ll res=1; while(b) { if(b&amp;1) (res*=a)%=mod; (a*=a)%=mod,b&gt;&gt;=1; } return res; } inline ll inv(ll a) {return powmod(a,mod-2);} ll fact[maxn],invfact[maxn]; inline void init() { fact[0]=invfact[0]=1; for(rgi i=1;i&lt;maxn;++i) fact[i]=fact[i-1]*i%mod,invfact[i]=inv(fact[i]); } inline ll C(ll n,ll m) {return fact[n]*invfact[m]%mod*invfact[n-m]%mod;} signed main() { int n,k; fin&gt;&gt;n&gt;&gt;k; ll ans=0,tmp=2; init(); for(rgi i=n;i&gt;=k;--i) ans+=((i-k)&amp;1?(mod-1LL):1LL)*C(i,k)%mod*C(n,i)%mod*(tmp-1)%mod, (tmp*=tmp)%=mod,ans%=mod; fout&lt;&lt;ans; return 0; } // ---------------------------- // by imzzy ","link":"https://imzzy1201.github.io/post/qUuCFD8g0/"},{"title":"ç¬”è®° - äºŒé¡¹å¼åæ¼”","content":" You aren't fully capable of deciding your own destiny. äºŒé¡¹å¼åæ¼”ï¼Œå³å¼é¡¹äºŒ ç®—æ˜¯åæ¼”ç³»åˆ—çŸ¥è¯†ç‚¹ä¸­æœ€ç®€å•æœ€å¥½èƒŒçš„ä¹‹ä¸€ ç é‡å°ï¼Œè¯æ˜ç®€å•ï¼Œè¿˜å¾ˆå¥½ç†è§£ å½¢å¼ å…ˆç»™å‡ºæ¥å¼å­ï¼š ä» 000 åˆ° nnn ï¼š â‘ fn=âˆ‘i=0n(âˆ’1)i(ni)giâ‡”gn=âˆ‘i=0n(âˆ’1)i(ni)fi\\tag*{â‘ } \\large \\begin{aligned}\\\\ f_n=\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}g_i&amp;\\Leftrightarrow g_n=\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}f_i\\\\ \\end{aligned} fnâ€‹=i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)giâ€‹â€‹â‡”gnâ€‹=i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)fiâ€‹â€‹â‘  â‘¡äº¦ä½œ fn=âˆ‘i=0n(ni)giâ‡”gn=âˆ‘i=0n(âˆ’1)nâˆ’i(ni)fi\\tag*{â‘¡} \\normalsize\\textsf{äº¦ä½œ}\\ \\large \\begin{aligned}\\\\ f_n=\\sum\\limits_{i=0}^n\\dbinom{n}{i}g_i&amp;\\Leftrightarrow g_n=\\sum\\limits_{i=0}^n (-1)^{n-i} \\dbinom{n}{i} f_i\\\\ \\end{aligned} äº¦ä½œ fnâ€‹=i=0âˆ‘nâ€‹(inâ€‹)giâ€‹â€‹â‡”gnâ€‹=i=0âˆ‘nâ€‹(âˆ’1)nâˆ’i(inâ€‹)fiâ€‹â€‹â‘¡ ä» nnn åˆ° mmm ï¼š â‘¢fn=âˆ‘i=nm(âˆ’1)i(in)giâ‡”gn=âˆ‘i=nm(âˆ’1)i(in)fi\\tag*{â‘¢} \\large \\begin{aligned}\\\\ f_n=\\sum\\limits_{i=n}^m(-1)^i\\dbinom{i}{n}g_i&amp;\\Leftrightarrow g_n=\\sum\\limits_{i=n}^m(-1)^i\\dbinom{i}{n}f_i \\\\ \\end{aligned} fnâ€‹=i=nâˆ‘mâ€‹(âˆ’1)i(niâ€‹)giâ€‹â€‹â‡”gnâ€‹=i=nâˆ‘mâ€‹(âˆ’1)i(niâ€‹)fiâ€‹â€‹â‘¢ â‘£äº¦ä½œ fn=âˆ‘i=nm(in)giâ‡”gn=âˆ‘i=nm(âˆ’1)iâˆ’n(in)fi\\tag*{â‘£} \\normalsize\\textsf{äº¦ä½œ}\\ \\large \\begin{aligned}\\\\ f_n=\\sum\\limits_{i=n}^m\\dbinom{i}{n}g_i&amp;\\Leftrightarrow g_n=\\sum\\limits_{i=n}^m (-1)^{i-n} \\dbinom{i}{n} f_i \\\\ \\end{aligned} äº¦ä½œ fnâ€‹=i=nâˆ‘mâ€‹(niâ€‹)giâ€‹â€‹â‡”gnâ€‹=i=nâˆ‘mâ€‹(âˆ’1)iâˆ’n(niâ€‹)fiâ€‹â€‹â‘£ è¿™äº›å¼å­çœ‹èµ·æ¥åˆå¯¹ç§°åˆå¦™ï¼Œå¦™å¾—éƒ½çœ‹ä¸å‡ºæ¥æœ‰å•¥ç”¨ å¥½å§å…¶å®è¿˜æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œå…·ä½“ç”¨æ³•å‚è§ä¾‹é¢˜ è¯æ˜ ç°åœ¨å…ˆè¯´å®ƒçš„è¯æ˜ æ–¹æ³• 1 æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªç‰¹æ®Šçš„å®¹æ–¥ è¿™é‡Œå¼•ç”¨ä¸€ä¸‹ GXZlegend çš„åšå®¢ ä¸­çš„è¯æ˜ï¼ˆç¨æœ‰ä¿®æ”¹ï¼‰ï¼š æ—¢ç„¶å½¢å¼å’Œå¤šæ­¥å®¹æ–¥ç›¸ä¼¼ï¼Œæˆ‘ä»¬å°±ä»å¤šæ­¥å®¹æ–¥è®²èµ· æˆ‘ä»¬éƒ½çŸ¥é“ï¼šâˆ£AâˆªBâˆ£=âˆ£Aâˆ£+âˆ£Bâˆ£âˆ’âˆ£Aâˆ©Bâˆ£|A\\cup B|=|A|+|B|âˆ’|A\\cap B|âˆ£AâˆªBâˆ£=âˆ£Aâˆ£+âˆ£Bâˆ£âˆ’âˆ£Aâˆ©Bâˆ£ ï¼Œè¿™å…¶å®å°±æ˜¯å®¹æ–¥åŸç† è®°ç”¨æ¥å®¹æ–¥çš„ mmm ä¸ªé›†åˆä¸º A1,A2â‹¯AmA_1,A_2\\cdots A_mA1â€‹,A2â€‹â‹¯Amâ€‹ ä¸­å®ƒçš„ä¸€èˆ¬å½¢å¼ä¸ºï¼š âˆ£A1âˆªA2âˆªâ‹¯âˆªAmâˆ£=âˆ‘1â‰¤iâ‰¤mâˆ£Aiâˆ£âˆ’âˆ‘1â‰¤i&lt;jâ‰¤mâˆ£Aiâˆ©Ajâˆ£+âˆ‘1â‰¤i&lt;j&lt;kâ‰¤mâˆ£Aiâˆ©Ajâˆ©Akâˆ£âˆ’â‹¯+(âˆ’1)nâˆ’1Ã—âˆ£A1âˆ©A2âˆ©â‹¯âˆ©Amâˆ£|A_1\\cup A_2\\cup \\cdots \\cup A_m|=\\sum\\limits_{1\\le i\\le m} |A_i|âˆ’\\sum\\limits_{1\\le i&lt;j\\le m} |A_i\\cap A_j|+\\sum\\limits_{1\\le i&lt;j&lt;k\\le m} |A_i\\cap A_j\\cap A_k|-\\cdots+(âˆ’1)^{nâˆ’1}\\times |A_1\\cap A_2\\cap \\cdots \\cap A_m| âˆ£A1â€‹âˆªA2â€‹âˆªâ‹¯âˆªAmâ€‹âˆ£=1â‰¤iâ‰¤mâˆ‘â€‹âˆ£Aiâ€‹âˆ£âˆ’1â‰¤i&lt;jâ‰¤mâˆ‘â€‹âˆ£Aiâ€‹âˆ©Ajâ€‹âˆ£+1â‰¤i&lt;j&lt;kâ‰¤mâˆ‘â€‹âˆ£Aiâ€‹âˆ©Ajâ€‹âˆ©Akâ€‹âˆ£âˆ’â‹¯+(âˆ’1)nâˆ’1Ã—âˆ£A1â€‹âˆ©A2â€‹âˆ©â‹¯âˆ©Amâ€‹âˆ£ æˆ–ä½œ âˆ£â‹ƒi=1mAiâˆ£=âˆ‘k=1m(âˆ’1)kâˆ’1âˆ‘1â‰¤i1&lt;i2&lt;â‹¯&lt;ikâ‰¤mâˆ£Ai1âˆ©Ai2âˆ©â‹¯âˆ©Aikâˆ£\\left|\\bigcup\\limits_{i=1}^m A_i\\right|=\\sum\\limits_{k=1}^m (-1)^{k-1} \\sum\\limits_{1\\le i_1&lt;i_2&lt;\\cdots&lt;i_k\\le m}|A_{i_1}\\cap A_{i_2}\\cap\\cdots\\cap A_{i_k}| âˆ£âˆ£âˆ£âˆ£âˆ£â€‹i=1â‹ƒmâ€‹Aiâ€‹âˆ£âˆ£âˆ£âˆ£âˆ£â€‹=k=1âˆ‘mâ€‹(âˆ’1)kâˆ’11â‰¤i1â€‹&lt;i2â€‹&lt;â‹¯&lt;ikâ€‹â‰¤mâˆ‘â€‹âˆ£Ai1â€‹â€‹âˆ©Ai2â€‹â€‹âˆ©â‹¯âˆ©Aikâ€‹â€‹âˆ£ è¯æ˜ï¼š è®¾æŸä¸€å…ƒç´ è¢« mmm ä¸ªé›†åˆæ‰€åŒ…å«ï¼Œåˆ™å…¶å¯¹å·¦ä¾§çš„è´¡çŒ®ä¸º 111 å¯¹å³ä¾§çš„è´¡çŒ®ä¸º âˆ‘i=1m(âˆ’1)iâˆ’1(mi)=âˆ’âˆ‘i=1m(âˆ’1)i(mi)=1âˆ’âˆ‘i=0m(âˆ’1)i(mi)=1âˆ’(1âˆ’1)m=1\\sum\\limits_{i=1}^m (âˆ’1)^{iâˆ’1}\\dbinom{m}{i}=âˆ’\\sum\\limits_{i=1}^m (âˆ’1)^i\\dbinom{m}{i}=1âˆ’\\sum\\limits_{i=0}^m (âˆ’1)^i \\dbinom{m}{i}=1âˆ’(1âˆ’1)^m=1i=1âˆ‘mâ€‹(âˆ’1)iâˆ’1(imâ€‹)=âˆ’i=1âˆ‘mâ€‹(âˆ’1)i(imâ€‹)=1âˆ’i=0âˆ‘mâ€‹(âˆ’1)i(imâ€‹)=1âˆ’(1âˆ’1)m=1 æ•…å·¦ä¾§ç­‰äºå³ä¾§ ï¼Œè¯æ¯• æ²¿ç”¨åˆšåˆšå¤šæ­¥å®¹æ–¥çš„å…¬å¼ï¼Œè®° Aiâ€¾\\overline{A_i}Aiâ€‹â€‹ è¡¨ç¤º AiA_iAiâ€‹ çš„è¡¥é›†ï¼ŒUUU ä¸ºå…¨é›†ï¼Œåˆ™å°†ä¸€èˆ¬å½¢å¼è¾¹å½¢å¾—ï¼š âˆ£A1â€¾âˆ©A2â€¾âˆ©â‹¯âˆ©Amâ€¾âˆ£=âˆ£Uâˆ£âˆ’âˆ£A1âˆªA2âˆªâ‹¯âˆªAmâ€¾âˆ£=âˆ£Uâˆ£âˆ’âˆ‘1â‰¤iâ‰¤mâˆ£Aiâˆ£+âˆ‘1â‰¤i&lt;jâ‰¤mâˆ£Aiâˆ©Ajâˆ£âˆ’â‹¯+(âˆ’1)mÃ—âˆ£A1âˆ©A2âˆ©â‹¯âˆ©Amâˆ£\\left|\\overline{A_1}\\cap \\overline{A_2} \\cap\\cdots\\cap \\overline{A_m}\\right|=|U|-\\left|\\overline{A_1\\cup A_2 \\cup\\cdots\\cup A_m}\\right|=|U|-\\sum\\limits_{1\\le i\\le m}|A_i|+\\sum\\limits_{1\\le i&lt;j\\le m}|A_i\\cap A_j|-\\cdots+(-1)^m\\times |A_1\\cap A_2\\cap\\cdots\\cap A_m| âˆ£âˆ£â€‹A1â€‹â€‹âˆ©A2â€‹â€‹âˆ©â‹¯âˆ©Amâ€‹â€‹âˆ£âˆ£â€‹=âˆ£Uâˆ£âˆ’âˆ£âˆ£â€‹A1â€‹âˆªA2â€‹âˆªâ‹¯âˆªAmâ€‹â€‹âˆ£âˆ£â€‹=âˆ£Uâˆ£âˆ’1â‰¤iâ‰¤mâˆ‘â€‹âˆ£Aiâ€‹âˆ£+1â‰¤i&lt;jâ‰¤mâˆ‘â€‹âˆ£Aiâ€‹âˆ©Ajâ€‹âˆ£âˆ’â‹¯+(âˆ’1)mÃ—âˆ£A1â€‹âˆ©A2â€‹âˆ©â‹¯âˆ©Amâ€‹âˆ£ åŒæ—¶ï¼Œç”±äºè¡¥é›†çš„è¡¥é›†å°±æ˜¯åŸé›†ï¼Œå› æ­¤åˆæœ‰ï¼š âˆ£A1âˆ©A2âˆ©â‹¯âˆ©Amâˆ£=âˆ£Uâˆ£âˆ’âˆ‘1â‰¤iâ‰¤mâˆ£Aiâ€¾âˆ£+âˆ‘1â‰¤i&lt;jâ‰¤mâˆ£Aiâ€¾âˆ©Ajâ€¾âˆ£âˆ’â‹¯+(âˆ’1)mÃ—âˆ£A1â€¾âˆ©A2â€¾âˆ©â‹¯âˆ©Amâ€¾âˆ£|A_1\\cap A_2\\cap\\cdots\\cap A_m|=|U|-\\sum\\limits_{1\\le i\\le m}\\left|\\overline{A_i}\\right|+\\sum\\limits_{1\\le i&lt;j\\le m}\\left|\\overline{A_i}\\cap\\overline{A_j}\\right|-\\cdots+(-1)^m\\times\\left|\\overline{A_1}\\cap\\overline{A_2}\\cap\\cdots\\cap\\overline{A_m}\\right| âˆ£A1â€‹âˆ©A2â€‹âˆ©â‹¯âˆ©Amâ€‹âˆ£=âˆ£Uâˆ£âˆ’1â‰¤iâ‰¤mâˆ‘â€‹âˆ£âˆ£â€‹Aiâ€‹â€‹âˆ£âˆ£â€‹+1â‰¤i&lt;jâ‰¤mâˆ‘â€‹âˆ£âˆ£â€‹Aiâ€‹â€‹âˆ©Ajâ€‹â€‹âˆ£âˆ£â€‹âˆ’â‹¯+(âˆ’1)mÃ—âˆ£âˆ£â€‹A1â€‹â€‹âˆ©A2â€‹â€‹âˆ©â‹¯âˆ©Amâ€‹â€‹âˆ£âˆ£â€‹ è€ƒè™‘ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼šå¤šä¸ªé›†åˆçš„äº¤é›†å¤§å°åªå’Œé›†åˆçš„æ•°ç›®æœ‰å…³ è®° f(n)f(n)f(n) è¡¨ç¤º nnn ä¸ªè¡¥é›†çš„äº¤é›†çš„åŸºæ•°ï¼Œg(n)g(n)g(n) è¡¨ç¤º nnn ä¸ªåŸé›†çš„äº¤é›†çš„åŸºæ•° å½¢å¼åŒ–çš„è¡¨ç¤ºï¼š âˆ€1â‰¤i1&lt;i2&lt;â‹¯&lt;inâ‰¤m âˆ£â‹‚j=1nAijâ€¾âˆ£=f(n),âˆ£â‹‚j=1nAijâˆ£=g(n)\\large \\forall _{1\\le i_1&lt;i_2&lt;\\cdots&lt;i_n\\le m}\\ \\normalsize\\left|\\bigcap\\limits_{j=1}^n \\overline{A_{i_j}}\\right|=f(n),\\left|\\bigcap\\limits_{j=1}^n A_{i_j}\\right|=g(n) âˆ€1â‰¤i1â€‹&lt;i2â€‹&lt;â‹¯&lt;inâ€‹â‰¤mâ€‹ âˆ£âˆ£âˆ£âˆ£âˆ£â€‹j=1â‹‚nâ€‹Aijâ€‹â€‹â€‹âˆ£âˆ£âˆ£âˆ£âˆ£â€‹=f(n),âˆ£âˆ£âˆ£âˆ£âˆ£â€‹j=1â‹‚nâ€‹Aijâ€‹â€‹âˆ£âˆ£âˆ£âˆ£âˆ£â€‹=g(n) åˆ™ä¸Šé¢ä¸¤ä¸ªå…¬å¼å¯ä»¥åˆ†åˆ«è¡¨ç¤ºä¸º f(n)=âˆ‘i=0n(âˆ’1)i(ni)g(i)g(n)=âˆ‘i=0n(âˆ’1)i(ni)f(i)f(n)=\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}g(i)\\\\g(n)=\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}f(i) f(n)=i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)g(i)g(n)=i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)f(i) æ˜¾ç„¶è¿™ä¸¤ä¸ªå…¬å¼æ˜¯ç­‰ä»·å…³ç³»ï¼Œæ›´æ˜¯ç›¸äº’æ¨å¯¼çš„å…³ç³»ï¼Œäºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†åŸ â‘ â‘ â‘  å¼ï¼š fn=âˆ‘i=0n(âˆ’1)i(ni)giâ‡”gn=âˆ‘i=0n(âˆ’1)i(ni)fif_n=\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}g_i\\Leftrightarrow g_n=\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}f_i fnâ€‹=i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)giâ€‹â‡”gnâ€‹=i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)fiâ€‹ æ–¹æ³• 2 æ¨å¼å­ï¼ğŸ¤” æˆ‘ä»¬å°è¯•ç”± fn=âˆ‘i=0n(âˆ’1)i(ni)gif_n=\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}g_ifnâ€‹=i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)giâ€‹ æ¨å¯¼è‡³ gn=âˆ‘i=0n(âˆ’1)i(ni)fig_n=\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}f_ignâ€‹=i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)fiâ€‹ï¼ˆå¾ˆæ˜æ˜¾è¿™ä¸¤ä¸ªå¼å­å®Œå…¨å¯¹ç§°ï¼Œè¯æ˜äº†ä¸€ä¸ªæ–¹å‘å°±å¯ä»¥è¯æ˜å……è¦æ€§äº†ï¼‰ï¼š âˆµ fn=âˆ‘i=0n(âˆ’1)i(ni)giâˆ´âˆ‘i=0n(âˆ’1)i(ni)fi=âˆ‘i=0n(âˆ’1)i(ni)âˆ‘j=0i(âˆ’1)j(ij)gj=âˆ‘i=0nâˆ‘j=0i(âˆ’1)i+j(ni)(ij)gj=âˆ‘j=0ngjâˆ‘i=jn(âˆ’1)i+j(ni)(ij)=âˆ‘j=0ngjâˆ‘i=jn(âˆ’1)i+jn!i!(nâˆ’i)!Ã—i!j!(iâˆ’j)!=âˆ‘j=0ngjâˆ‘i=jn(âˆ’1)i+jn!j!(nâˆ’j)!Ã—(nâˆ’j)!(nâˆ’i)!(iâˆ’j)!=âˆ‘j=0ngjâˆ‘i=jn(âˆ’1)i+j(nj)(nâˆ’jnâˆ’i)=âˆ‘j=0n(nj)gjâˆ‘i=jn(âˆ’1)i+j(nâˆ’jnâˆ’i)åˆâˆµ âˆ€xâˆˆZ+âˆ‘i=0x(âˆ’1)i(xi)=0âˆ´ âˆ€jâˆˆNâˆ§j&lt;nâˆ‘i=jn(âˆ’1)i+j(nâˆ’jnâˆ’i)=0âˆ´âˆ‘i=0n(âˆ’1)i(ni)fi=âˆ‘j=0n(nj)gjâˆ‘i=jn(âˆ’1)i+j(nâˆ’jnâˆ’i)=(nn)gnâˆ‘i=nn(âˆ’1)i+j(nâˆ’jnâˆ’i)=gnç»¼ä¸Šå¾—åˆ°ï¼Œfn=âˆ‘i=0n(âˆ’1)i(ni)giâ‡”gn=âˆ‘i=0n(âˆ’1)i(ni)fiè¯æ¯•.\\begin{aligned}\\\\ \\because &amp;\\ f_n=\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}g_i\\\\ \\therefore&amp;\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}f_i\\\\ =&amp;\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}\\sum\\limits_{j=0}^i(-1)^j\\dbinom{i}{j}g_j\\\\ =&amp;\\sum\\limits_{i=0}^n\\sum\\limits_{j=0}^i(-1)^{i+j}\\dbinom{n}{i}\\dbinom{i}{j}g_j\\\\ =&amp;\\sum\\limits_{j=0}^ng_j\\sum\\limits_{i=j}^n(-1)^{i+j}\\dbinom{n}{i}\\dbinom{i}{j}\\\\ =&amp;\\sum\\limits_{j=0}^ng_j\\sum\\limits_{i=j}^n(-1)^{i+j}\\dfrac{n!}{i!(n-i)!}\\times\\dfrac{i!}{j!(i-j)!}\\\\ =&amp;\\sum\\limits_{j=0}^ng_j\\sum\\limits_{i=j}^n(-1)^{i+j}\\dfrac{n!}{j!(n-j)!}\\times\\dfrac{(n-j)!}{(n-i)!(i-j)!}\\\\ =&amp;\\sum\\limits_{j=0}^ng_j\\sum\\limits_{i=j}^n(-1)^{i+j}\\dbinom{n}{j}\\dbinom{n-j}{n-i}\\\\ =&amp;\\sum\\limits_{j=0}^n\\dbinom{n}{j}g_j\\sum\\limits_{i=j}^n(-1)^{i+j}\\dbinom{n-j}{n-i}\\\\ åˆ&amp;\\because\\ \\large\\forall _{x\\in \\text{Z}^+} \\normalsize\\sum\\limits_{i=0}^{x}(-1)^i\\dbinom{x}{i}=0\\\\ \\therefore&amp;\\ \\large\\forall _{j\\in \\text{N}\\wedge j&lt;n} \\normalsize \\sum\\limits_{i=j}^n(-1)^{i+j}\\dbinom{n-j}{n-i}=0\\\\ \\therefore&amp;\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}f_i\\\\ =&amp;\\sum\\limits_{j=0}^n\\dbinom{n}{j}g_j\\sum\\limits_{i=j}^n(-1)^{i+j}\\dbinom{n-j}{n-i}\\\\ =&amp;\\dbinom{n}{n}g_n\\sum\\limits_{i=n}^n(-1)^{i+j}\\dbinom{n-j}{n-i}\\\\ =&amp;g_n\\\\ ç»¼&amp;ä¸Šå¾—åˆ°ï¼Œf_n=\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}g_i\\Leftrightarrow g_n=\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}f_i\\\\ è¯&amp;æ¯•. \\end{aligned} âˆµâˆ´=======åˆâˆ´âˆ´===ç»¼è¯â€‹ fnâ€‹=i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)giâ€‹i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)fiâ€‹i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)j=0âˆ‘iâ€‹(âˆ’1)j(jiâ€‹)gjâ€‹i=0âˆ‘nâ€‹j=0âˆ‘iâ€‹(âˆ’1)i+j(inâ€‹)(jiâ€‹)gjâ€‹j=0âˆ‘nâ€‹gjâ€‹i=jâˆ‘nâ€‹(âˆ’1)i+j(inâ€‹)(jiâ€‹)j=0âˆ‘nâ€‹gjâ€‹i=jâˆ‘nâ€‹(âˆ’1)i+ji!(nâˆ’i)!n!â€‹Ã—j!(iâˆ’j)!i!â€‹j=0âˆ‘nâ€‹gjâ€‹i=jâˆ‘nâ€‹(âˆ’1)i+jj!(nâˆ’j)!n!â€‹Ã—(nâˆ’i)!(iâˆ’j)!(nâˆ’j)!â€‹j=0âˆ‘nâ€‹gjâ€‹i=jâˆ‘nâ€‹(âˆ’1)i+j(jnâ€‹)(nâˆ’inâˆ’jâ€‹)j=0âˆ‘nâ€‹(jnâ€‹)gjâ€‹i=jâˆ‘nâ€‹(âˆ’1)i+j(nâˆ’inâˆ’jâ€‹)âˆµ âˆ€xâˆˆZ+â€‹i=0âˆ‘xâ€‹(âˆ’1)i(ixâ€‹)=0 âˆ€jâˆˆNâˆ§j&lt;nâ€‹i=jâˆ‘nâ€‹(âˆ’1)i+j(nâˆ’inâˆ’jâ€‹)=0i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)fiâ€‹j=0âˆ‘nâ€‹(jnâ€‹)gjâ€‹i=jâˆ‘nâ€‹(âˆ’1)i+j(nâˆ’inâˆ’jâ€‹)(nnâ€‹)gnâ€‹i=nâˆ‘nâ€‹(âˆ’1)i+j(nâˆ’inâˆ’jâ€‹)gnâ€‹ä¸Šå¾—åˆ°ï¼Œfnâ€‹=i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)giâ€‹â‡”gnâ€‹=i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)fiâ€‹æ¯•.â€‹ å…¶å®ƒ ä¸Šé¢çš„ä¸¤ä¸ªæ–¹æ³•åªè¯´æ˜äº† â‘ â‘ â‘  å¼çš„è¯æ˜ï¼Œè€Œäº‹å®ä¸Šå‰©ä¸‹çš„ä¸‰ä¸ªå¼å­å¯ä»¥å¾ˆå®¹æ˜“ä» â‘ â‘ â‘  å¼è¾¹å½¢å¾—åˆ°ï¼Œæˆ–ä¹Ÿå¯ç”¨æ–¹æ³• 2 ç±»ä¼¼çš„åšæ³•å¾—åˆ° æ‰©å±• äºŒé¡¹å¼åæ¼”å¯ä»¥ç”¨ NTT ä¼˜åŒ–ï¼ˆè¿˜æ²¡å­¦ï¼Œå­¦äº†é©¬ä¸Šå†™ Code Empty! ( åº”ç”¨ å¥—è·¯ æ±‚â€œæ°å¥½ nnn ä¸ªâ€çš„ç­”æ¡ˆå›°éš¾ï¼Œä½†æ±‚â€œé€‰å‡º nnn ä¸ªâ€å®¹æ˜“ï¼Œç„¶åé€šè¿‡â€œé€‰å‡º nnn ä¸ªâ€å†å¾—åˆ°â€œé’¦å®š nnn ä¸ªâ€ï¼ˆå³é€‰å‡º nnn ä¸ªä¹‹åï¼Œå‰©ä¸‹çš„éšä¾¿æçš„æ–¹æ¡ˆæ•°ï¼‰ï¼Œè€Œâ€œé’¦å®š nnn ä¸ªâ€ä¸â€œæ°å¥½ nnn ä¸ªâ€åˆšå¥½æœ‰äºŒé¡¹å¼åæ¼”çš„å½¢å¼ï¼ˆä¸€èˆ¬æ˜¯ â‘¡â‘¡â‘¡ æˆ– â‘£â‘£â‘£ å¼ï¼‰ ä¾‹é¢˜ BZOJ2839 - é›†åˆè®¡æ•° NOI Online R2 TG - T3 æ¸¸æˆ ä¹ é¢˜ BZOJ4710 / Luogu P5505 - ã€ŒJSOI2011ã€åˆ†ç‰¹äº§ BZOJ3622 / Luogu P4859 - å·²ç»æ²¡æœ‰ä»€ä¹ˆå¥½å®³æ€•çš„äº† ","link":"https://imzzy1201.github.io/post/sdj9zeaTV/"},{"title":"NOI Online R2 TG è®¢æ­£","content":" If you don't try, how can you know what it feels like to be desperate? 1. æ¦‚å†µ æ‚² T1 80pts è¯¥æ­»åœ°ç”¨äº†æŸ __gcdã€‚è¿˜å¥½è¿‡äº†ç¼–ï¼Œå¤§æ¦‚ä¸¢äº† 10 åˆ†ï¼Ÿ T2 90pts è¯¥æ­»åœ°è¢«å¡äº†å¸¸ï¼Œä¸¢ 10 åˆ†ã€‚ T3 20pts å‰©ä¸‹çš„åˆ†æˆ‘ä¹Ÿä¸ä¼šã€‚ æ€»åˆ† 190ptsï¼Œä¸€èˆ¬ã€‚ 2. é¢˜è§£ é¢˜è§£åŒæœŸå‘å¸ƒäºæˆ‘çš„ luogu åšå®¢ T1 æ¶‚è‰²æ¸¸æˆ é¢˜é¢ï¼ˆluoguï¼‰ å‰ç½®çŸ¥è¯† æ¬§å‡ é‡Œå¾—ç®—æ³• æ€è·¯ å› ä¸º p1,p2â‰¤109p_1,p_2\\le10^9p1â€‹,p2â€‹â‰¤109ï¼Œè€Œæˆ‘ä»¬æœ‰ 102010^{20}1020 ä¸ªæ ¼å­ï¼Œ æ‰€ä»¥ [p1,p2]â‰¤p1p2&lt;1020[p_1,p_2]\\le p_1p_2&lt;10^{20}[p1â€‹,p2â€‹]â‰¤p1â€‹p2â€‹&lt;1020ï¼Œè€Œæ¯ [p1,p2][p_1,p_2][p1â€‹,p2â€‹] ä¸ªæ ¼å­éƒ½æ˜¯ä¸ªå¾ªç¯èŠ‚ï¼Œå³è‹¥ç¬¬ä¸€ä¸ªå¾ªç¯èŠ‚èŒƒå›´å†…å­˜åœ¨åˆæ³•è§£ï¼Œåˆ™åé¢çš„æ¯ä¸ªå¾ªç¯èŠ‚éƒ½èƒ½æŒ‰ç…§æ­¤è§£æ¥æŸ“è‰²ã€‚ æ‰€ä»¥ 102010^{20}1020 å¯ä»¥æ‰”æ‰ï¼ˆåœ¨ä¸€ä¸ªå‘¨æœŸé‡Œå­˜åœ¨åˆæ³•è§£å³å¯å¾—æ— è®ºå¤šå°‘æ ¼å­éƒ½å­˜åœ¨åˆæ³•è§£ï¼‰ã€‚ æˆ‘ä»¬å…ˆä»¤ f(a,b,c)f(a,b,c)f(a,b,c) è¡¨ç¤º p1=a,p2=b,k=cp_1=a,p_2=b,k=cp1â€‹=a,p2â€‹=b,k=c å¯¹åº”çš„ç­”æ¡ˆã€‚ é‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè‹¥ p1=q1g, p2=q2gp_1=q_1g,\\ p_2=q_2gp1â€‹=q1â€‹g, p2â€‹=q2â€‹gï¼Œåˆ™ f(p1,p2,k)=f(q1,q2,k)f(p_1,p_2,k)=f(q_1,q_2,k)f(p1â€‹,p2â€‹,k)=f(q1â€‹,q2â€‹,k)ã€‚å› ä¸ºè‹¥ p1=q1g, p2=q2gp_1=q_1g,\\ p_2=q_2gp1â€‹=q1â€‹g, p2â€‹=q2â€‹gï¼Œåˆ™å¿…å®šæ‰€æœ‰ç¼–å·ä¸ä¸º ggg çš„å€æ•°çš„æ ¼å­éƒ½ä¸ä¼šè¢«æŸ“è‰²ï¼Œå¯ä»¥å¿½ç•¥æ‰ã€‚ æ‰€ä»¥ä¸å¦¨ä»¤ q1â‰¥q2, (q1,q2)=1q_1\\ge q_2,\\ (q_1,q_2)=1q1â€‹â‰¥q2â€‹, (q1â€‹,q2â€‹)=1 æ±‚ f(q1,q2,k)f(q_1,q_2,k)f(q1â€‹,q2â€‹,k)ã€‚ å› ä¸º q1&gt;q2q_1&gt;q_2q1â€‹&gt;q2â€‹ï¼Œæ‰€ä»¥é¦–ä¸ªæ ¼å­å¡«çº¢è‰²æ¯”å¡«è“è‰²æ›´ä¼˜ï¼ˆè“è‰²æ–¹å—å¯†åº¦æ›´å¤§ï¼‰ã€‚ åˆå› ä¸º (q1,q2)=1(q_1,q_2)=1(q1â€‹,q2â€‹)=1ï¼Œ æ‰€ä»¥æ ¹æ®è£´èœ€å®šç†æ˜“å¾—å¯¹äºæ‰€æœ‰æ•´æ•° nnn éƒ½å­˜åœ¨ä¸€ä¸ª mmm ä½¿ q1âˆ£m, q2âˆ£m+nq_1|m,\\ q_2|m+nq1â€‹âˆ£m, q2â€‹âˆ£m+nã€‚ å³å¯¹äºæ¯ä¸ª nnn ï¼Œéƒ½èƒ½åœ¨æ ¼ä¸­æ‰¾åˆ°ç¼–å· mmm ï¼Œä½¿å¾— mmm ä¸ºçº¢ï¼Œm+nm+nm+n ä¸ºè“ã€‚ æ‰€ä»¥æˆ‘ä»¬ç°åœ¨åªéœ€è¦å¤„ç†æœ€åæƒ…å†µï¼Œå³ mmm ä¸ºçº¢ï¼Œm+1m+1m+1 ä¸ºè“ã€‚ è§‚å¯Ÿä¸‹é¢å‡ ä¸ªä¾‹å­ï¼š æˆ‘ä»¬å¯ä»¥æ¨å‡ºï¼ŒæŸ“ xxx ä¸ªè“æ ¼å­è‡³å°‘éœ€è¦ q2(xâˆ’1)+1q_2(x-1)+1q2â€‹(xâˆ’1)+1 ä¸ªè¿ç»­éçº¢æ ¼å­ã€‚ æ‰€ä»¥æœ€åæƒ…å†µä¸‹ï¼Œæœ€å¤šæœ‰ âŒŠq1âˆ’2q2âŒ‹+1\\Large\\lfloor\\normalsize\\dfrac{q_1-2}{q_2}\\Large\\rfloor\\normalsize+1âŒŠq2â€‹q1â€‹âˆ’2â€‹âŒ‹+1 ä¸ªè¿ç»­çš„è“æ ¼å­ã€‚ æ³¨æ„ï¼šç‰¹åˆ¤ k=1k=1k=1 çš„æƒ…å†µä¸º NOã€‚ Code #include&lt;bits/stdc++.h&gt; #define rgi register int #define ll long long class fastin{ private: int _ch,_f; public: inline fastin&amp; operator&gt;&gt;(char&amp;c) {c=getchar(); return *this;} template&lt;typename _Tp&gt; inline fastin&amp; operator&gt;&gt;(_Tp&amp;_x){ _x=0; while(!isdigit(_ch)) _f|=(_ch==45),_ch=getchar(); while(isdigit(_ch)) _x=(_x&lt;&lt;1)+(_x&lt;&lt;3)+(_ch^48),_ch=getchar(); _f&amp;&amp;(_x=-_x,_f=0); return *this;} fastin() {_ch=_f=0;} }fin; class fastout{ #define endl '\\n' private: int _num[32],_head; public: inline fastout&amp; operator&lt;&lt;(char c) {putchar(c); return *this;} template&lt;typename _Tp&gt; inline fastout&amp; operator&lt;&lt;(_Tp _x){ _Tp _k; if(_x==0) {putchar('0'); return *this;} if(_x&lt;0) putchar('-'),_x=-_x; while(_x&gt;0) _k=_x/10,++_head,_num[_head]=(_x-(_k&lt;&lt;1)-(_k&lt;&lt;3))^48,_x=_k; while(_head&gt;0) putchar(_num[_head]),--_head; return *this;} fastout() {_head=0;} }fout; // ---------------------------- // #define int ll // using namespace std; const int maxn=200004; const int mod=998244353,inf=1000000007; ll gcd(ll a,ll b) {return a==0?b:gcd(b%a,a);} // gcd, æœ€å¤§å…¬çº¦æ•° signed main() { // freopen(&quot;color.in&quot;,&quot;r&quot;,stdin); // freopen(&quot;color.out&quot;,&quot;w&quot;,stdout); ll T,p1,p2,k; fin&gt;&gt;T; while(T--) { fin&gt;&gt;p1&gt;&gt;p2&gt;&gt;k; if(k==1) {puts(&quot;NO&quot;); continue;} // ç‰¹åˆ¤ ll g=gcd(p1,p2); p1/=g,p2/=g; if(p1&lt;p2) std::swap(p1,p2); puts(((p1-2LL)/p2+1&lt;k)?&quot;YES&quot;:&quot;NO&quot;); } return 0; } // ---------------------------- // by imzzy T2 å­åºåˆ—é—®é¢˜ é¢˜é¢ï¼ˆluoguï¼‰ å‰ç½®çŸ¥è¯† æ™®é€šçº¿æ®µæ ‘ æ€è·¯ è€ƒè™‘ç¦»æ•£åŒ– AAA æ•°ç»„ï¼Œä»¥ä¾¿äºå¯¹æ¯ä¸ªä½ç½®çš„æ•°è®°å½•ä¸€ä¸ª pre[i]pre[i]pre[i] è¡¨ç¤ºä¸€ä¸ªæœ€å¤§çš„æ•° jjj æ»¡è¶³ j&lt;ij&lt;ij&lt;i ä¸” Aj=AiA_j=A_iAjâ€‹=Aiâ€‹ï¼ˆè‹¥ä¸å­˜åœ¨è¿™æ ·çš„ jjj åˆ™ä»¤å…¶ä¸º 000ï¼‰ã€‚ å»ºç«‹ä¸€é¢—çº¿æ®µæ ‘ï¼Œæ”¯æŒä¸€ä¸‹æ“ä½œï¼šåŒºé—´åŠ  1ï¼Œå…¨å±€æŸ¥è¯¢æ¯ä¸ªæ•°çš„å¹³æ–¹çš„å’Œã€‚å…·ä½“å®ç°æ–¹æ³•è§ä»£ç ã€‚ è€ƒè™‘é€’æ¨è®¡ç®—ä»¥æ¯ä¸ªä½ç½®ä¸ºç»“å°¾çš„åŒºé—´çš„è´¡çŒ®ï¼› å³å¯¹äºæ¯ä¸ª iiiï¼Œè®¡ç®— gi=âˆ‘j=1if(j,i)2g_i=\\sum\\limits_{j=1}^i f(j,i)^2giâ€‹=j=1âˆ‘iâ€‹f(j,i)2ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥å¾—åˆ°ï¼Œâˆ€jâ‰¤pre[i+1]\\forall j\\le pre[i+1]âˆ€jâ‰¤pre[i+1]ï¼Œæœ‰ f(j,i)=f(j,i+1)f(j,i)=f(j,i+1)f(j,i)=f(j,i+1)ï¼Œå› ä¸ºæ­¤åŒºé—´ (j,i)(j,i)(j,i) ä¸­å¿…å®šåŒ…å« Apre[i+1]=Ai+1A_{pre[i+1]}=A_{i+1}Apre[i+1]â€‹=Ai+1â€‹ï¼Œå³ç¬¬ i+1i+1i+1 ä¸ªæ•°å¯¹æ­¤åŒºé—´çš„ fff å€¼æ— è´¡çŒ®ã€‚ åŒç†å¾—ï¼Œâˆ€j&gt;pre[i+1]\\forall j&gt;pre[i+1]âˆ€j&gt;pre[i+1]ï¼Œæœ‰ f(j,i)+1=f(j,i+1)f(j,i)+1=f(j,i+1)f(j,i)+1=f(j,i+1)ã€‚ è®° hi,j=f(j,i)h_{i,j}=f(j,i)hi,jâ€‹=f(j,i) é‚£ä¹ˆæˆ‘ä»¬ç»´æŠ¤ hih_ihiâ€‹ è¿™ä¸ªåºåˆ—ï¼Œè€ƒè™‘åˆ° hih_ihiâ€‹ è½¬ç§»åˆ° hi+1h_{i+1}hi+1â€‹ ä»…éœ€å°† (pre[i+1]+1,i+1)(pre[i+1]+1,i+1)(pre[i+1]+1,i+1) è¿™ä¸ªåŒºé—´çš„æ¯ä¸ªæ•°åŠ  111ï¼Œæ±‚ gig_igiâ€‹ åˆ™æ­£æ˜¯å…¨å±€æŸ¥è¯¢æ¯ä¸ªæ•°çš„å¹³æ–¹çš„å’Œï¼Œæ‰€ä»¥æ­£å¯ä»¥ä¸Šè¿°çº¿æ®µæ ‘æ¥ç»´æŠ¤ã€‚ æ³¨æ„ï¼šè·‘ luogu æ°‘é—´æ•°æ®å¦‚æœä¸å¼€ O2ï¼Œå¯èƒ½éœ€è¦å¸¸æ•°ä¼˜åŒ–ã€‚ Code #include&lt;bits/stdc++.h&gt; #define rgi register int #define ll long long class fastin{ private: int _ch,_f; public: inline fastin&amp; operator&gt;&gt;(char&amp;c) {c=getchar(); return *this;} template&lt;typename _Tp&gt; inline fastin&amp; operator&gt;&gt;(_Tp&amp;_x){ _x=0; while(!isdigit(_ch)) _f|=(_ch==45),_ch=getchar(); while(isdigit(_ch)) _x=(_x&lt;&lt;1)+(_x&lt;&lt;3)+(_ch^48),_ch=getchar(); _f&amp;&amp;(_x=-_x,_f=0); return *this;} fastin() {_ch=_f=0;} }fin; class fastout{ #define endl '\\n' private: int _num[32],_head; public: inline fastout&amp; operator&lt;&lt;(char c) {putchar(c); return *this;} template&lt;typename _Tp&gt; inline fastout&amp; operator&lt;&lt;(_Tp _x){ _Tp _k; if(_x==0) {putchar('0'); return *this;} if(_x&lt;0) putchar('-'),_x=-_x; while(_x&gt;0) _k=_x/10,++_head,_num[_head]=(_x-(_k&lt;&lt;1)-(_k&lt;&lt;3))^48,_x=_k; while(_head&gt;0) putchar(_num[_head]),--_head; return *this;} fastout() {_head=0;} }fout; // ---------------------------- // #define int ll // using namespace std; const int maxn=1000004; const int mod=1000000007,inf=1000000007; int a[maxn]; int val[maxn],last[maxn],pre[maxn]; class segment_tree{ #define mid ((l+r)&gt;&gt;1) private: int size,ql,qr; int sum[2097154],sqrsum[2097154],tag[2097154]; // çº¿æ®µæ ‘ç»´æŠ¤ 3 ä¸ªå€¼ï¼Œsum å³åŒºé—´å’Œï¼Œsqrsum å³åŒºé—´å¹³æ–¹å’Œï¼Œtag å³åŒºé—´åŠ çš„æ ‡è®° inline void pushdown(int p,int l,int r) { if(tag[p]) { tag[p&lt;&lt;1]+=tag[p],tag[p&lt;&lt;1|1]+=tag[p]; sqrsum[p&lt;&lt;1]=(1LL*sqrsum[p&lt;&lt;1] + 1LL*(mid-l+1)*tag[p]%mod*tag[p]%mod + 2LL*tag[p]*sum[p&lt;&lt;1]%mod)%mod; sqrsum[p&lt;&lt;1|1]=(1LL*sqrsum[p&lt;&lt;1|1] + 1LL*(r-mid)*tag[p]%mod*tag[p]%mod + 2LL*tag[p]*sum[p&lt;&lt;1|1]%mod)%mod; // è€ƒè™‘ (a+b)Â²=aÂ²+bÂ²+2abï¼Œæ‰€ä»¥åŒºé—´åŠ  b åï¼Œæ¯ä¸ªæ•°çš„å¹³æ–¹å€¼+=bÂ²+2ab // å³åŒºé—´å¹³æ–¹å’Œ += åŒºé—´é•¿åº¦Ã—bÂ²+2Ã—åŒºé—´å’ŒÃ—b sum[p&lt;&lt;1]=(1LL*sum[p&lt;&lt;1] + 1LL*tag[p]*(mid-l+1))%mod; sum[p&lt;&lt;1|1]=(1LL*sum[p&lt;&lt;1|1] + 1LL*tag[p]*(r-mid))%mod; tag[p]=0; } } void update(int p,int l,int r) { if(l&gt;=ql&amp;&amp;r&lt;=qr) { sqrsum[p]=(1LL*sqrsum[p]+sum[p]*2LL+(r-l+1))%mod; // åŒç†ï¼Œ(a+1)Â²=aÂ²+2a+1 // å³åŒºé—´å¹³æ–¹å’Œ+=2Ã—åŒºé—´å’Œ+åŒºé—´é•¿åº¦ if((sum[p]+=r-l+1)&gt;=mod) sum[p]-=mod; ++tag[p]; return; } pushdown(p,l,r); if(mid&gt;=ql) update(p&lt;&lt;1,l,mid); if(mid&lt;qr) update(p&lt;&lt;1|1,mid+1,r); if((sum[p]=sum[p&lt;&lt;1]+sum[p&lt;&lt;1|1])&gt;=mod) sum[p]-=mod; if((sqrsum[p]=sqrsum[p&lt;&lt;1]+sqrsum[p&lt;&lt;1|1])&gt;=mod) sqrsum[p]-=mod; } public: inline void build(int siz) {size=siz;} inline void update(int l,int r) {ql=l,qr=r,update(1,1,size);} inline int query() {return sqrsum[1];} #undef mid }sgt; signed main() { // freopen(&quot;sequence.in&quot;,&quot;r&quot;,stdin); // freopen(&quot;sequence.out&quot;,&quot;w&quot;,stdout); rgi n,cnt; fin&gt;&gt;n; for(rgi i=1;i&lt;=n;++i) fin&gt;&gt;a[i]; memcpy(val,a,sizeof(int)*(n+1)); std::sort(val+1,val+1+n),cnt=std::unique(val+1,val+1+n)-val; for(rgi i=1;i&lt;=n;++i) { a[i]=std::lower_bound(val+1,val+cnt,a[i])-val; pre[i]=last[a[i]],last[a[i]]=i; // last[i] å½“å‰æœ€å¤§çš„ j æ»¡è¶³ A[j]=i } sgt.build(n); rgi ans=0; for(rgi i=1;i&lt;=n;++i) { sgt.update(pre[i]+1,i); if((ans+=sgt.query())&gt;=mod) ans-=mod; } fout&lt;&lt;ans; return 0; } // ---------------------------- // by imzzy T3 æ¸¸æˆ é¢˜é¢ï¼ˆluoguï¼‰ å‰ç½®çŸ¥è¯† äºŒé¡¹å¼åæ¼” æ ‘ä¸ŠèƒŒåŒ…* æ€è·¯ å®šä¹‰ g[i][j]g[i][j]g[i][j] ä»£è¡¨åœ¨ä»¥èŠ‚ç‚¹ iii ä¸ºæ ¹çš„å­æ ‘ä¸­é€‰å‡º jjj å¯¹éå¹³å±€çš„æ–¹æ¡ˆæ•°ï¼ŒD[i]D[i]D[i] ä»£è¡¨ iii ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œä¸ºèŠ‚ç‚¹ iii çš„å¯¹æ‰‹çš„èŠ‚ç‚¹çš„ä¸ªæ•°ã€‚ ç”¨æ ·ä¾‹ä¸¾ä¸ªæ —å­ï¼š 12348756 è¿™é‡ŒåŠ ç²—çš„èŠ‚ç‚¹æ˜¯å° A çš„ï¼Œå…¶ä½™ä¸ºå° B çš„ã€‚ ggg çš„å€¼å¦‚ä¸‹è¡¨ èŠ‚ç‚¹ç¼–å· iii g[i][0]g[i][0]g[i][0] g[i][1]g[i][1]g[i][1] g[i][2]g[i][2]g[i][2] g[i][3]g[i][3]g[i][3] g[i][4]g[i][4]g[i][4] 1 1 7 11 4 0 2 1 1 0 0 0 3 1 2 0 0 0 4 1 0 0 0 0 5 1 0 0 0 0 6 1 0 0 0 0 7 1 0 0 0 0 8 1 0 0 0 0 è€ƒè™‘æ ‘ä¸ŠåŠ¨æ€è§„åˆ’è®¡ç®— ggg çš„å€¼ï¼š å¯¹äº g[i][j]g[i][j]g[i][j] çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æœ‰ 222 ç§æ¥æºæƒ…å†µï¼šä¸€ç§é€‰ä¸­äº†èŠ‚ç‚¹ iiiï¼Œä¸€ç§æ²¡é€‰ä¸­ï¼ˆæ˜¾ç„¶å•Šï¼‰ã€‚ ç°åœ¨å…ˆå®šä¹‰ä¸€ä¸ª gâ€²[i][j]g&#x27;[i][j]gâ€²[i][j] ä»£è¡¨æ²¡é€‰ä¸­èŠ‚ç‚¹ iii æ—¶ï¼Œä»¥èŠ‚ç‚¹ iii ä¸ºæ ¹çš„å­æ ‘ä¸­é€‰å‡º jjj å¯¹éå¹³å±€çš„æ–¹æ¡ˆæ•°ã€‚ ä¸‹è¡¨ä¸º gâ€²g&#x27;gâ€² çš„å€¼è¡¨ èŠ‚ç‚¹ç¼–å· iii gâ€²[i][0]g&#x27;[i][0]gâ€²[i][0] gâ€²[i][1]g&#x27;[i][1]gâ€²[i][1] gâ€²[i][2]g&#x27;[i][2]gâ€²[i][2] gâ€²[i][3]g&#x27;[i][3]gâ€²[i][3] gâ€²[i][4]g&#x27;[i][4]gâ€²[i][4] 1 1 3 2 0 0 2 1 0 0 0 0 3 1 0 0 0 0 4 1 0 0 0 0 5 1 0 0 0 0 6 1 0 0 0 0 7 1 0 0 0 0 8 1 0 0 0 0 åˆ™å¾ˆå®¹æ˜“å¾—åˆ° g[i][j]=gâ€²[i][j]+gâ€²[i][jâˆ’1]Ã—(D[i]âˆ’j+1)g[i][j]=g&#x27;[i][j]+g&#x27;[i][j-1]\\times (D[i]-j+1)g[i][j]=gâ€²[i][j]+gâ€²[i][jâˆ’1]Ã—(D[i]âˆ’j+1)ï¼Œå› ä¸ºä¸é€‰ä¸­èŠ‚ç‚¹ iii çš„æ–¹æ¡ˆæ•°å°±æ˜¯ gâ€²[i][j]g&#x27;[i][j]gâ€²[i][j]ï¼›è€Œé€‰ä¸­èŠ‚ç‚¹ iii åå¿…ç„¶æœ‰ä¸ªå¯¹æ‰‹çš„ç‚¹ä¸å…¶å‡‘æˆä¸€éå¹³å±€ï¼Œè¿™ä¸ªå¯¹æ‰‹çš„ç‚¹å…± D[i]âˆ’j+1D[i]-j+1D[i]âˆ’j+1 ä¸ªå¯é€‰ã€‚ ç°åœ¨è€ƒè™‘å¦‚ä½•è®¡ç®— gâ€²[i][j]g&#x27;[i][j]gâ€²[i][j]ã€‚æ˜“å¾—ï¼Œå¯ä» iii çš„å„ä¸ªå­æ ‘ä¸­å„é€‰å–å‡ å¯¹éå¹³å±€ï¼Œä½¿å¾—é€‰å‡ºæ¥çš„æ€»æ•°ä¸º jjjï¼Œå³ gâ€²[i][j]=âˆ‘k1+k2+â‹¯+ktg[soni,1][k1]Ã—g[soni,2][k2]Ã—â‹¯Ã—g[soni,t][kt]g&#x27;[i][j]=\\sum_{k_1+k_2+\\cdots+k_t} g[son_{i,1}][k_1]\\times g[son_{i,2}][k_2]\\times\\cdots\\times g[son_{i,t}][k_t]gâ€²[i][j]=âˆ‘k1â€‹+k2â€‹+â‹¯+ktâ€‹â€‹g[soni,1â€‹][k1â€‹]Ã—g[soni,2â€‹][k2â€‹]Ã—â‹¯Ã—g[soni,tâ€‹][ktâ€‹]ï¼ˆè¿™é‡Œ soni,tson_{i,t}soni,tâ€‹ è¡¨ç¤º iii çš„ç¬¬ ttt ä¸ªå­èŠ‚ç‚¹ï¼‰ã€‚ å‘ç°è¿™ä¸ªå¤æ‚åº¦å¾ˆä¸æ­£ç¡®ï¼Œè‚¯å®šè¿‡ä¸äº†ï¼Œæ‰€ä»¥è¦æ”¹è¿›ã€‚ å¯ä»¥è€ƒè™‘è¿™æ ·ï¼šå…ˆæŠŠ iii çš„æ‰€æœ‰å­æ ‘ç æ‰ï¼Œæ¯æ¬¡æ’å…¥ä¸€é¢—å­æ ‘ï¼Œå¹¶è®¡ç®—å…¶å¯¹ gâ€²g&#x27;gâ€² çš„æ–°è´¡çŒ®ã€‚ åˆ™å¯ä»¥çœ‹å‡ºè‹¥å®šä¹‰ gâ€²â€²[i][k]g&#x27;&#x27;[i][k]gâ€²â€²[i][k] è¡¨ç¤ºä»¥ iii ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œå‰ kkk ä¸ª iii çš„å­æ ‘å¯¹ gâ€²g&#x27;gâ€² çš„è´¡çŒ®ï¼Œ é‚£ä¹ˆ gâ€²â€²[i][k][a+b]=âˆ‘gâ€²â€²[i][kâˆ’1][a]Ã—gâ€²[soni,k][b]g&#x27;&#x27;[i][k][a+b]=\\sum g&#x27;&#x27;[i][k-1][a]\\times g&#x27;[son_{i,k}][b]gâ€²â€²[i][k][a+b]=âˆ‘gâ€²â€²[i][kâˆ’1][a]Ã—gâ€²[soni,kâ€‹][b]ï¼Œå³å‰ kâˆ’1k-1kâˆ’1 ä¸ªå­æ ‘ä¸­é€‰ aaa å¯¹ï¼Œç¬¬ kkk ä¸ªå­æ ‘ä¸­é€‰ bbb å¯¹ã€‚ è¿™æ ·ç®—ï¼Œä¹ä¸€çœ‹æ˜¯ O(n3)O(n^3)O(n3) çš„ï¼Œä½†å…¶å®ä¸ç„¶ã€‚ å¦‚æœ gâ€²â€²[i][kâˆ’1][a]=0g&#x27;&#x27;[i][k-1][a]=0gâ€²â€²[i][kâˆ’1][a]=0ï¼Œåˆ™æ˜¾ç„¶ gâ€²â€²[i][kâˆ’1][a+1]=0g&#x27;&#x27;[i][k-1][a+1]=0gâ€²â€²[i][kâˆ’1][a+1]=0ï¼›åŒç†ï¼Œè‹¥ gâ€²[soni,k][b]=0g&#x27;[son_{i,k}][b]=0gâ€²[soni,kâ€‹][b]=0ï¼Œåˆ™æ˜¾ç„¶ gâ€²[soni,k][b+1]=0g&#x27;[son_{i,k}][b+1]=0gâ€²[soni,kâ€‹][b+1]=0ã€‚ æ‰€ä»¥å¦‚æœæˆ‘ä»¬å¡ a,ba,ba,b çš„ä¸Šç•Œï¼Œä½¿å¾—å‚ä¸è®¡ç®—çš„ gâ€²â€²[i][kâˆ’1][a]Ã—gâ€²[soni,k][b]â‰ 0g&#x27;&#x27;[i][k-1][a]\\times g&#x27;[son_{i,k}][b]\\neq 0gâ€²â€²[i][kâˆ’1][a]Ã—gâ€²[soni,kâ€‹][b]î€ â€‹=0ï¼Œåˆ™å¯è¯æ˜å¤æ‚åº¦ä¸º O(n2)O(n^2)O(n2)ã€‚ è¿™å…¶å®æ˜¯ä¸€ä¸ªæ ‘ä¸ŠèƒŒåŒ…ï¼Œå…·ä½“å¤æ‚åº¦è¯æ˜å¯ä»¥çœ‹ ouuan çš„åšå®¢ï¼Œè¿™é‡Œä¸èµ˜è¿°ã€‚ è¯´æ˜ï¼šè¿™é‡Œçš„ gâ€²g&#x27;gâ€² å’Œ gâ€²â€²g&#x27;&#x27;gâ€²â€² ä»…ä¸ºäº†æ–¹ä¾¿æè¿°ï¼Œå…¶å®åœ¨ä»£ç ä¸­ä¸éœ€è¦ä¸“é—¨å­˜å‚¨ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬ç”¨ O(n2)O(n^2)O(n2) çš„å¤æ‚åº¦å†…å¾—å‡ºäº† ggg çš„å€¼è¡¨ã€‚ ç°åœ¨å®šä¹‰ f[i]f[i]f[i] ä¸ºæ­£å¥½ iii å¯¹éå¹³å±€çš„æ–¹æ¡ˆæ€»æ•°ï¼Œh[i]h[i]h[i] ä¸ºé’¦å®š iii å¯¹éå¹³å±€çš„æ–¹æ¡ˆæ€»æ•°ã€‚ è¿™å¯èƒ½ä¸å¤ªå¥½ç†è§£ï¼Œæ¢å¥è¯è¯´ï¼Œå°±æ˜¯ âˆ‘ä»»æ„é€‰å®š j å¯¹éå¹³å±€åå‰©ä¸‹çš„èŠ‚ç‚¹è‡ªç”±é…å¯¹çš„æ–¹æ¡ˆæ•°\\sum_{ä»»æ„é€‰å®š\\ j\\ å¯¹éå¹³å±€å} å‰©ä¸‹çš„èŠ‚ç‚¹è‡ªç”±é…å¯¹çš„æ–¹æ¡ˆæ•°âˆ‘ä»»æ„é€‰å®š j å¯¹éå¹³å±€åâ€‹å‰©ä¸‹çš„èŠ‚ç‚¹è‡ªç”±é…å¯¹çš„æ–¹æ¡ˆæ•°ã€‚ æ ·ä¾‹ä¸­ï¼Œh[0]=24, h[1]=42, h[2]=22, h[3]=4, h[4]=0h[0]=24,\\ h[1]=42,\\ h[2]=22,\\ h[3]=4,\\ h[4]=0h[0]=24, h[1]=42, h[2]=22, h[3]=4, h[4]=0ã€‚ å¾ˆæ˜æ˜¾ï¼Œæ ¹æ®å®šä¹‰ï¼Œh[i]=g[1][i]Ã—(mâˆ’i)!h[i]=g[1][i]\\times (m-i)!h[i]=g[1][i]Ã—(mâˆ’i)!ï¼Œå› ä¸º iii å¯¹èŠ‚ç‚¹è¢«é€‰ä¸­åå…±å¯åŒ¹é… mâˆ’im-imâˆ’i å¯¹å±€é¢ã€‚ ä½ å¯èƒ½èƒ½æ„Ÿè§‰å‡º hhh ä¸ fff é—´æœ‰æŸç§å…³ç³»ï¼Œç„¶è€Œ hhh ä¸ fff çš„å…³ç³»å¹¶ä¸åªæ˜¯ç®€ç®€å•å•çš„åç¼€å’Œï¼Œè€ƒè™‘ h[i]h[i]h[i] äº‹å®ä¸Šå°†æ¯ä¸ª jjj å¯¹éå¹³å±€çš„æƒ…å†µéƒ½ç®—äº† (ji)\\dbinom{j}{i}(ijâ€‹) æ¬¡ï¼Œå› ä¸ºé’¦å®šå…¶ä¸­æ¯ iii ä¸ªèŠ‚ç‚¹æ—¶ï¼Œéƒ½ä¼šç®—ä¸Šä¸€æ¬¡è¿™ä¸ªçŠ¶æ€ï¼› å³ h[i]=âˆ‘j=im(ji)f[j]h[i]=\\sum\\limits_{j=i}^m\\dbinom{j}{i}f[j]h[i]=j=iâˆ‘mâ€‹(ijâ€‹)f[j]ã€‚ æˆ‘ä»¬ä¾¿å‘ç°ï¼Œè¿™æ˜¯ä¸€ä¸ª äºŒé¡¹å¼åæ¼” çš„å½¢å¼ï¼Œ å¯å¾— h[i]=âˆ‘j=im(ji)f[j]â‡”f[i]=âˆ‘j=im(âˆ’1)jâˆ’i(ji)h[j]h[i]=\\sum\\limits_{j=i}^m\\dbinom{j}{i}f[j]\\Leftrightarrow f[i]=\\sum\\limits_{j=i}^m(-1)^{j-i}\\dbinom{j}{i}h[j]h[i]=j=iâˆ‘mâ€‹(ijâ€‹)f[j]â‡”f[i]=j=iâˆ‘mâ€‹(âˆ’1)jâˆ’i(ijâ€‹)h[j]ã€‚ é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¿™ä¸ªå…¬å¼ï¼Œé€šè¿‡ hhh å€¼è¡¨åœ¨ O(n2)O(n^2)O(n2) ä»¥å†…è®¡ç®—å‡º fff å€¼è¡¨äº†ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬åœ¨ O(n2)O(n^2)O(n2) çš„å¤æ‚åº¦å†…è®¡ç®—å‡ºäº†ç­”æ¡ˆã€‚ Code #include&lt;bits/stdc++.h&gt; #define rgi register int #define ll long long class fastin{ private: int _ch,_f; public: inline fastin&amp; operator&gt;&gt;(char&amp;c) {c=getchar(); return *this;} template&lt;typename _Tp&gt; inline fastin&amp; operator&gt;&gt;(_Tp&amp;_x){ _x=0; while(!isdigit(_ch)) _f|=(_ch==45),_ch=getchar(); while(isdigit(_ch)) _x=(_x&lt;&lt;1)+(_x&lt;&lt;3)+(_ch^48),_ch=getchar(); _f&amp;&amp;(_x=-_x,_f=0); return *this;} fastin() {_ch=_f=0;} }fin; class fastout{ #define endl '\\n' private: int _num[32],_head; public: inline fastout&amp; operator&lt;&lt;(char c) {putchar(c); return *this;} template&lt;typename _Tp&gt; inline fastout&amp; operator&lt;&lt;(_Tp _x){ _Tp _k; if(_x==0) {putchar('0'); return *this;} if(_x&lt;0) putchar('-'),_x=-_x; while(_x&gt;0) _k=_x/10,++_head,_num[_head]=(_x-(_k&lt;&lt;1)-(_k&lt;&lt;3))^48,_x=_k; while(_head&gt;0) putchar(_num[_head]),--_head; return *this;} fastout() {_head=0;} }fout; // ---------------------------- // #define int ll // using namespace std; const int maxn=5004; const int mod=998244353,inf=1000000007; int n,m; struct EDGE{int v,nxt;}e[maxn&lt;&lt;1]; int first[maxn],cnte; inline void addedge(int u,int v) { e[++cnte].v=v, e[cnte].nxt=first[u], first[u]=cnte; } char s[maxn]; int cnt[maxn][2],siz[maxn]; // cnt[i][j] è¡¨ç¤º i çš„å­æ ‘ä¸­ï¼Œéš¶å±äº j çš„èŠ‚ç‚¹çš„ä¸ªæ•°ï¼›siz[i] ä»£è¡¨ i çš„å­æ ‘èŠ‚ç‚¹æ•° ll tmp[maxn],g[maxn][maxn],h[maxn]; void dfs(int fa,int now) { cnt[now][s[now]=='1']=siz[now]=1,g[now][0]=1; for(rgi i=first[now],to=e[i].v;i;i=e[i].nxt,to=e[i].v) { if(to==fa) continue; dfs(now,to); for(rgi j=0;j&lt;=siz[now]+siz[to];++j) tmp[j]=0; for(rgi j=0;g[now][j];++j) for(rgi k=0;g[to][k];++k) (tmp[j+k]+=g[now][j]*g[to][k])%=mod; for(rgi j=0;j&lt;=siz[now]+siz[to];++j) g[now][j]=tmp[j]; siz[now]+=siz[to],cnt[now][0]+=cnt[to][0],cnt[now][1]+=cnt[to][1]; } // ä¸Šé¢è¿™æ®µç›¸å½“äºè®¡ç®— g' for(rgi i=m;i&gt;0;--i) (g[now][i]+=g[now][i-1]*std::max(0,cnt[now][s[now]=='0']-i+1))%=mod; // ä¸Šé¢è¿™æ®µåˆ™ç›¸å½“äºè®¡ç®—çœŸå®çš„ g å€¼ } ll ans[maxn]; ll fact[maxn],invfact[maxn]; inline ll inv(ll a) { ll b=mod-2,res=1; while(b) {if(b&amp;1) (res*=a)%=mod; (a*=a)%=mod,b&gt;&gt;=1;} return res; } inline ll C(ll a,ll b) {return fact[a]*invfact[b]%mod*invfact[a-b]%mod;} inline void solve() { fact[0]=invfact[0]=1; for(rgi i=1;i&lt;=m;++i) fact[i]=fact[i-1]*i%mod,invfact[i]=inv(fact[i]); for(rgi i=0;i&lt;=m;++i) h[i]=g[1][i]*fact[m-i]%mod/*,fout&lt;&lt;h[i]&lt;&lt;' '*/; for(rgi i=0;i&lt;=m;++i) for(rgi j=i;j&lt;=m;++j) (ans[i]+=h[j]*(((j-i)&amp;1)?(mod-1):1)%mod*C(j,i))%=mod; } signed main() { // freopen(&quot;match.in&quot;,&quot;r&quot;,stdin); // freopen(&quot;match.out&quot;,&quot;w&quot;,stdout); int x,y; fin&gt;&gt;n; scanf(&quot;%s&quot;,s+1); for(rgi i=1;i&lt;n;++i) fin&gt;&gt;x&gt;&gt;y,addedge(x,y),addedge(y,x); m=n&gt;&gt;1,dfs(0,1),solve(); // for(rgi i=1;i&lt;=n;++i) // { // for(rgi j=0;j&lt;=m;++j) fout&lt;&lt;g[i][j]&lt;&lt;' '; // fout&lt;&lt;endl; // } for(rgi i=0;i&lt;=m;++i) fout&lt;&lt;ans[i]&lt;&lt;endl; return 0; } // ---------------------------- // by imzzy 3. æ€»ç»“ Never use __gcd! ","link":"https://imzzy1201.github.io/post/-5pBeF37l/"},{"title":"å¤‡å¿˜å½•","content":" The more you learn, the more you know; the more you know, the more you forget; the more you forget, the less you know. So why bother to learn? æ¿å­ #include&lt;bits/stdc++.h&gt; #define rgi register int #define ll long long class fastin{ private: int _ch,_f; public: inline fastin&amp; operator&gt;&gt;(char&amp;c) {c=getchar(); return *this;} template&lt;typename _Tp&gt; inline fastin&amp; operator&gt;&gt;(_Tp&amp;_x){ _x=0; while(!isdigit(_ch)) _f|=(_ch==45),_ch=getchar(); while(isdigit(_ch)) _x=(_x&lt;&lt;1)+(_x&lt;&lt;3)+(_ch^48),_ch=getchar(); _f&amp;&amp;(_x=-_x,_f=0); return *this;} fastin() {_ch=_f=0;} }fin; class fastout{ #define endl '\\n' private: int _num[32],_head; public: inline fastout&amp; operator&lt;&lt;(char c) {putchar(c); return *this;} template&lt;typename _Tp&gt; inline fastout&amp; operator&lt;&lt;(_Tp _x){ _Tp _k; if(_x==0) {putchar('0'); return *this;} if(_x&lt;0) putchar('-'),_x=-_x; while(_x&gt;0) _k=_x/10,++_head,_num[_head]=(_x-(_k&lt;&lt;1)-(_k&lt;&lt;3))^48,_x=_k; while(_head&gt;0) putchar(_num[_head]),--_head; return *this;} fastout() {_head=0;} }fout; // ---------------------------- // #define int ll // using namespace std; const int maxn=200004; const int mod=998244353,inf=1000000007; signed main() { return 0; } // ---------------------------- // by imzzy æ•°å­¦ç›¸å…³ æ’åˆ—ç»„åˆ Pnm=Anm=n!(nâˆ’m)!Cnm=(nm)=Pnmm!=n!m!(nâˆ’m)!\\large \\begin{aligned} \\\\ &amp; P_n^m=A_n^m=\\dfrac{n!}{(n-m)!} \\\\ &amp; C_n^m=\\dbinom{n}{m}=\\dfrac{P_n^m}{m!}=\\dfrac{n!}{m!(n-m)!} \\\\ \\end{aligned} â€‹Pnmâ€‹=Anmâ€‹=(nâˆ’m)!n!â€‹Cnmâ€‹=(mnâ€‹)=m!Pnmâ€‹â€‹=m!(nâˆ’m)!n!â€‹â€‹ exgcd void exgcd(ll a,ll b,ll &amp;x,ll &amp;y,ll &amp;d) {if(!b) x=1,y=0,d=a; else exgcd(b,a%b,y,x,d),y-=x*(a/b);} Miller-Rabin ç´ æ€§æ£€æµ‹ æ¥è‡ª Wikipedia çš„æ•°æ® if n &lt; 2,047, it is enough to test a = 2; if n &lt; 1,373,653, it is enough to test a = 2 and 3; if n &lt; 9,080,191, it is enough to test a = 31 and 73; if n &lt; 25,326,001, it is enough to test a = 2, 3, and 5; if n &lt; 3,215,031,751, it is enough to test a = 2, 3, 5, and 7; if n &lt; 4,759,123,141, it is enough to test a = 2, 7, and 61; if n &lt; 1,122,004,669,633, it is enough to test a = 2, 13, 23, and 1662803; if n &lt; 2,152,302,898,747, it is enough to test a = 2, 3, 5, 7, and 11; if n &lt; 3,474,749,660,383, it is enough to test a = 2, 3, 5, 7, 11, and 13; if n &lt; 341,550,071,728,321, it is enough to test a = 2, 3, 5, 7, 11, 13, and 17. if n &lt; 3,825,123,056,546,413,051, it is enough to test a = 2, 3, 5, 7, 11, 13, 17, 19, and 23. if n &lt; 18,446,744,073,709,551,616 = 264, it is enough to test a = 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, and 37. if n &lt; 318,665,857,834,031,151,167,461, it is enough to test a = 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, and 37. if n &lt; 3,317,044,064,679,887,385,961,981, it is enough to test a = 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, and 41. inline ll mulmod(ll a,ll b,ll m) { ll res=0; while(b) { if(b&amp;1) if((res+=a)&gt;=m) res-=m; if((a+=a)&gt;=m) a-=m; b&gt;&gt;=1; } return res; } inline ll powmod(ll a,ll b,ll m) { ll res=1; while(b) { if(b&amp;1) res=mulmod(res,a,m); a=mulmod(a,a,m); b&gt;&gt;=1; } return res; } inline bool Miller_Rabin(ll n) // true ä¸ºè´¨æ•°ï¼Œfalse ä¸ºéè´¨æ•° { if(n&lt;2) return false; const ll tests[]={2,3,5,7,11,13,17,19,23,29,31,37}; ll tmp=n-1,d,a,t; while(!(tmp&amp;1)) tmp&gt;&gt;=1; for(rgi i=0;i&lt;12&amp;&amp;tests[i]&lt;n;++i) { a=tests[i],t=powmod(a,d=tmp,n); while(d!=n-1&amp;&amp;t!=1&amp;&amp;t!=n-1) t=mulmod(t,t,n),d&lt;&lt;=1; if(t!=n-1&amp;&amp;!(t==1&amp;&amp;d&amp;1)) return false; } return true; } äºŒé¡¹å¼åæ¼” å››ç§å¸¸ç”¨å½¢å¼ï¼š ä» 000 åˆ° nnn ï¼š fn=âˆ‘i=0n(âˆ’1)i(ni)giâ‡”gn=âˆ‘i=0n(âˆ’1)i(ni)fiäº¦ä½œ fn=âˆ‘i=0n(ni)giâ‡”gn=âˆ‘i=0n(âˆ’1)nâˆ’i(ni)fi\\large \\begin{aligned}\\\\ f_n=\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}g_i&amp;\\Leftrightarrow g_n=\\sum\\limits_{i=0}^n(-1)^i\\dbinom{n}{i}f_i \\\\ \\normalsize\\textsf{äº¦ä½œ}\\ \\large f_n=\\sum\\limits_{i=0}^n\\dbinom{n}{i}g_i&amp;\\Leftrightarrow g_n=\\sum\\limits_{i=0}^n (-1)^{n-i} \\dbinom{n}{i} f_i \\\\ \\end{aligned} fnâ€‹=i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)giâ€‹äº¦ä½œ fnâ€‹=i=0âˆ‘nâ€‹(inâ€‹)giâ€‹â€‹â‡”gnâ€‹=i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)fiâ€‹â‡”gnâ€‹=i=0âˆ‘nâ€‹(âˆ’1)nâˆ’i(inâ€‹)fiâ€‹â€‹ ä» nnn åˆ° mmm ï¼š fn=âˆ‘i=nm(âˆ’1)i(in)giâ‡”gn=âˆ‘i=nm(âˆ’1)i(in)fiäº¦ä½œ fn=âˆ‘i=nm(in)giâ‡”gn=âˆ‘i=nm(âˆ’1)iâˆ’n(in)fi\\large \\begin{aligned}\\\\ f_n=\\sum\\limits_{i=n}^m(-1)^i\\dbinom{i}{n}g_i&amp;\\Leftrightarrow g_n=\\sum\\limits_{i=n}^m(-1)^i\\dbinom{i}{n}f_i \\\\ \\normalsize\\textsf{äº¦ä½œ}\\ \\large f_n=\\sum\\limits_{i=n}^m\\dbinom{i}{n}g_i&amp;\\Leftrightarrow g_n=\\sum\\limits_{i=n}^m (-1)^{i-n} \\dbinom{i}{n} f_i \\\\ \\end{aligned} fnâ€‹=i=nâˆ‘mâ€‹(âˆ’1)i(niâ€‹)giâ€‹äº¦ä½œ fnâ€‹=i=nâˆ‘mâ€‹(niâ€‹)giâ€‹â€‹â‡”gnâ€‹=i=nâˆ‘mâ€‹(âˆ’1)i(niâ€‹)fiâ€‹â‡”gnâ€‹=i=nâˆ‘mâ€‹(âˆ’1)iâˆ’n(niâ€‹)fiâ€‹â€‹ è«æ¯”ä¹Œæ–¯åæ¼” è«æ¯”ä¹Œæ–¯å‡½æ•° Î¼(d)={1d=1(âˆ’1)kd=p1p2p3...pk, piä¸º d çš„è´¨å› å­ä¸”ä¸¤ä¸¤äº’ç´ 0otherwise\\mu(d)= \\begin{cases} 1 &amp; d=1\\\\ (-1)^k &amp; d=p_1p_2p_3...p_k,\\ p_i \\text{ä¸º } d \\text{ çš„è´¨å› å­ä¸”ä¸¤ä¸¤äº’ç´ } \\\\ 0 &amp; \\text{otherwise} \\end{cases} Î¼(d)=â©âªâ¨âªâ§â€‹1(âˆ’1)k0â€‹d=1d=p1â€‹p2â€‹p3â€‹...pkâ€‹, piâ€‹ä¸º d çš„è´¨å› å­ä¸”ä¸¤ä¸¤äº’ç´ otherwiseâ€‹ æ€§è´¨ï¼š 1.âˆ‘dâˆ£nÎ¼(d)={1n=10n&gt;12.âˆ‘dâˆ£nÎ¼(d)d=Ï•(n)n\\begin{aligned}\\\\ 1. &amp;\\sum_{d|n}\\mu(d)= \\begin{cases} 1&amp;n=1\\\\ 0&amp;n&gt;1 \\end{cases}\\\\ 2. &amp;\\sum_{d|n}\\frac{\\mu(d)}{d}=\\frac{\\phi(n)}{n} \\end{aligned}\\\\ 1.2.â€‹dâˆ£nâˆ‘â€‹Î¼(d)={10â€‹n=1n&gt;1â€‹dâˆ£nâˆ‘â€‹dÎ¼(d)â€‹=nÏ•(n)â€‹â€‹ è«æ¯”ä¹Œæ–¯åæ¼” F(n)=âˆ‘dâˆ£nf(d)â‡”f(d)=âˆ‘dâˆ£nÎ¼(d)F(nd)\\large F(n)=\\sum_{d|n}f(d)\\Leftrightarrow f(d)=\\sum_{d|n}\\mu(d)F\\left(\\frac{n}{d}\\right) F(n)=dâˆ£nâˆ‘â€‹f(d)â‡”f(d)=dâˆ£nâˆ‘â€‹Î¼(d)F(dnâ€‹) å›¾è®º ç½‘ç»œç˜¤ Dinic åŸç†æˆ‘æƒ³æ˜¯ä¸ä¼šå¿˜äº†çš„ã€‚ MCMF æˆ‘ä»¬å†™çš„æ–¹æ³•åŸºæœ¬éƒ½æ˜¯æŒ‡æ•°çº§åˆ«çš„ï¼Œå¾ˆå®¹æ˜“è¢«å‰ï¼Œå‚è€ƒ ouuan's Blog ä¸‹é¢æ˜¯æˆ‘å·¨å¤§çš„ Dinic å½“å‰å¼§ä¼˜åŒ– + å²ä¸Šæœ€æ…¢æŒ‡æ•°çº§ MCMF æ¿å­ï¼š namespace FLOWS{ struct EDGE{int to,w,nxt;} e[maxm&lt;&lt;1|1]; int n,cnte,first[maxn+1]; inline void init(int _n) {n=_n,cnte=-1,memset(first,-1,(n+1)*sizeof(int));} inline void addedge(int from,int to,int w) {e[++cnte]=(EDGE){to,w,first[from]},first[from]=cnte;} } namespace MAXFLOW{ using namespace FLOWS; int n,s,t,ans; inline void init(int _n,int _s,int _t) {s=_s,t=_t,ans=0,n=_n,FLOWS::init(n);} inline void addedge(int from,int to,int w) { if(debug&amp;1) std::cout&lt;&lt;&quot;MAXFLOW::addedge &quot;&lt;&lt;from&lt;&lt;' '&lt;&lt;to&lt;&lt;' '&lt;&lt;w&lt;&lt;endl; FLOWS::addedge(from,to,w),FLOWS::addedge(to,from,0); } int dep[maxn+1],cur[maxn+1],q[maxn+1]; inline bool bfs() { memcpy(cur,first,(n+1)*sizeof(int)); memset(dep,0,(n+1)*sizeof(int)); rgi l=1,r=1,u,i; q[1]=s,dep[s]=1; while(l&lt;=r) for(u=q[l++],i=first[u];~i;i=e[i].nxt) if(e[i].w&gt;0&amp;&amp;!dep[e[i].to]) dep[e[i].to]=dep[u]+1,q[++r]=e[i].to; return dep[t]; } int dfs(int now,int flow) { if(now==t) return flow; int res=0; for(rgi i=cur[now],to;~i;i=e[i].nxt) { cur[now]=i,to=e[i].to; if(dep[to]==dep[now]+1&amp;&amp;e[i].w&gt;0) if((res=dfs(to,std::min(flow,e[i].w)))&gt;0) {e[i].w-=res,e[i^1].w+=res; return res;} } return 0; } inline int work() { int now; while(bfs()) while((now=dfs(s,inf))&gt;0) { ans+=now; if((debug&gt;&gt;1)&amp;1) std::cout&lt;&lt;&quot;MAXFLOW::work &quot;&lt;&lt;ans&lt;&lt;'\\n'; } return ans; } } namespace MCMF{ using namespace FLOWS; int n,s,t,maxflow,mincost; int cost[maxm&lt;&lt;1|1]; inline void init(int _n,int _s,int _t) {n=_n,s=_s,t=_t,maxflow=mincost=0,FLOWS::init(n);} inline void addedge(int from,int to,int w,int c) { if(debug&amp;1) std::cout&lt;&lt;&quot;MCMF::addedge &quot;&lt;&lt;from&lt;&lt;' '&lt;&lt;to&lt;&lt;' '&lt;&lt;w&lt;&lt;' '&lt;&lt;c&lt;&lt;'\\n'; FLOWS::addedge(from,to,w),cost[cnte]=c; FLOWS::addedge(to,from,0),cost[cnte]=-c; } int dist[maxn+1],flow[maxn+1]; int pre[maxn+1]; bool vis[maxn+1]; std::queue&lt;int&gt; q; inline bool SPFA() { memset(vis,0,(n+1)*sizeof(bool)); memset(flow,0,(n+1)*sizeof(int)); memset(dist,0x3f,(n+1)*sizeof(int)); rgi u,i,to; q.push(s),dist[s]=0,flow[s]=inf; while(!q.empty()) { vis[u=q.front()]=0; q.pop(); for(i=first[u];~i;i=e[i].nxt) { to=e[i].to; if(e[i].w&gt;0&amp;&amp;dist[to]&gt;dist[u]+cost[i]) { dist[to]=dist[u]+cost[i],pre[to]=i; flow[to]=std::min(flow[u],e[i].w); if(!vis[to]) q.push(to),vis[to]=1; } } } return dist[t]&lt;inf; } inline std::pair&lt;int,int&gt; work() { rgi i; while(SPFA()) { maxflow+=flow[t],mincost+=flow[t]*dist[t]; for(i=t;i!=s;i=e[pre[i]^1].to) e[pre[i]].w-=flow[t],e[pre[i]^1].w+=flow[t]; if((debug&gt;&gt;1)&amp;1) std::cout&lt;&lt;&quot;MCMF::work &quot;&lt;&lt;maxflow&lt;&lt;' '&lt;&lt;mincost&lt;&lt;'\\n'; } return std::make_pair(maxflow,mincost); } } DS æ™®é€šå¹³è¡¡æ ‘ SPLAY æˆ‘çš„æœªå‹è¡Œçš„æ¿å­ class SPLAY { private: int sum,root,inf_; struct NODE{int son[2],fa,val,cnt,siz;} node[maxn]; inline bool son(int x) {return x==node[node[x].fa].son[1];} inline void connect(int x,int f,int d) {node[x].fa=f,node[f].son[d]=x;} inline int make(int f,int v) { node[++sum].fa=f; node[sum].val=v; node[sum].son[0]=node[sum].son[1]=0; node[sum].siz=node[sum].cnt=1; return sum; } inline void update(int x) {node[x].siz=node[node[x].son[0]].siz+node[node[x].son[1]].siz+node[x].cnt;} inline void rotate(int x) { int f=node[x].fa,g=node[f].fa; int s1=son(x),s2=son(f); connect(x,g,s2); connect(node[x].son[s1^1],f,s1); connect(f,x,s1^1); update(f),update(x); } inline void splay(int x,int tmp) { int t=node[tmp].fa; while(node[x].fa!=t) { int f=node[x].fa,g=node[f].fa; if(t!=g) son(f)^son(x)?rotate(x):rotate(f); rotate(x); } if(root==tmp) root=x; } inline int near(int x,int d) { int p=root; int res=d?-inf_:inf_; while(p) { if((d?x:node[p].val)&lt;(d?node[p].val:x)) res=node[p].val,p=node[p].son[d^1]; else p=node[p].son[d]; } return res; } public: SPLAY() {sum=root=0,inf_=1000000007;} inline int find(int x) { int p=root; while(p) { if(node[p].val==x) {splay(p,root);return p;} p=node[p].son[x&gt;node[p].val]; } return 0; } inline void ins(int x) { int p=root; if(!p) {root=make(0,x);return;} while(true) { ++node[p].siz; if(node[p].val==x) { ++node[p].cnt; splay(p,root); return; } int nxt=(x&gt;node[p].val); if(!node[p].son[nxt]) { node[p].son[nxt]=make(p,x); splay(node[p].son[nxt],root); return; } p=node[p].son[nxt]; } } inline void del(int x) { int p=find(x); if(!p) return; if(node[p].cnt&gt;1) {--node[p].cnt,--node[p].siz;return;} if(!node[p].son[0]||!node[p].son[1]) { root=node[p].son[0]+node[p].son[1]; node[root].fa=0; return; } int tmp=node[p].son[1]; while(node[tmp].son[0]) tmp=node[tmp].son[0]; splay(tmp,root); connect(node[p].son[0],tmp,0); node[tmp].fa=0; update(tmp); } inline int rank(int x) { int p=root,res=0; while(p) { if(node[p].val==x) { res+=node[node[p].son[0]].siz+1; splay(p,root); return res; } if(x&lt;node[p].val) p=node[p].son[0]; else { res+=node[node[p].son[0]].siz+node[p].cnt; p=node[p].son[1]; } } return 0; } inline int kth(int x) { int p=root; while(p) { int d=node[p].siz-node[node[p].son[1]].siz; if(node[node[p].son[0]].siz&lt;x&amp;&amp;d&gt;=x) {splay(p,root);return node[p].val;} if(d&gt;x) p=node[p].son[0]; else x-=d,p=node[p].son[1]; } return x&gt;0?inf_:-inf_; } inline int pre(int x) {return near(x,0);} inline int suc(int x) {return near(x,1);} inline void debug() { cout&lt;&lt;endl&lt;&lt;&quot;--------splay--------&quot;&lt;&lt;endl; cout&lt;&lt;sum&lt;&lt;&quot; &quot;&lt;&lt;root&lt;&lt;endl; for(rgi i=1;i&lt;=sum;++i) cout&lt;&lt;node[i].son[0]&lt;&lt;&quot; &quot;&lt;&lt;node[i].son[1]&lt;&lt;&quot; &quot;&lt;&lt;node[i].fa&lt;&lt;&quot; &quot;&lt;&lt;node[i].val&lt;&lt;&quot; &quot;&lt;&lt;node[i].cnt&lt;&lt;&quot; &quot;&lt;&lt;node[i].siz&lt;&lt;endl; cout&lt;&lt;&quot;---------------------&quot;&lt;&lt;endl; } }splay; treap æˆ‘çš„æœªå‹è¡Œçš„æ¿å­ class treap { #define lson_ son[0] #define rson_ son[1] private: int inf_; int sum,root; struct NODE {int son[2],val,pri,cnt,siz;} node[maxn]; inline void pushup(int p) {node[p].siz=node[node[p].lson_].siz+node[node[p].rson_].siz+node[p].cnt;} inline void rotate(int &amp; p,int d) { int k=node[p].son[d^1]; node[p].son[d^1]=node[k].son[d]; node[k].son[d]=p; pushup(p),pushup(k); p=k; } void ins_(int &amp; p,int k) { if(!p) { p=++sum; node[p].siz=node[p].cnt=1; node[p].val=k,node[p].pri=rand(); node[p].lson_=node[p].rson_=0; return; } if(node[p].val==k) { ++node[p].cnt,++node[p].siz; return; } int d=(k&gt;node[p].val); ins_(node[p].son[d],k); if(node[p].pri&lt;node[node[p].son[d]].pri) rotate(p,d^1); pushup(p); } void del_(int &amp; p,int k) { if(!p) return; if(k!=node[p].val) del_(node[p].son[k&gt;node[p].val],k); else if(!node[p].lson_&amp;&amp;!node[p].rson_) { --node[p].cnt,--node[p].siz; if(node[p].cnt==0)p=0; } else if(node[p].lson_^node[p].rson_) { int d=(node[p].rson_==0); rotate(p,d); del_(node[p].son[d],k); } else if(node[p].lson_&amp;&amp;node[p].rson_) { int d=(node[node[p].lson_].pri&gt;node[node[p].rson_].pri); rotate(p,d); del_(node[p].son[d],k); } pushup(p); } inline int near(int k,int d) { int x=root; int tmp=-inf_; while(x) { if((d?k:node[x].val)&lt;(d?node[x].val:k)) tmp=node[x].val,x=node[x].son[d^1]; else x=node[x].son[d]; } return tmp; } public: inline void debug() { cout&lt;&lt;endl&lt;&lt;&quot;--------treap--------&quot;&lt;&lt;endl; cout&lt;&lt;sum&lt;&lt;&quot; &quot;&lt;&lt;root&lt;&lt;endl; for(rgi i=1;i&lt;=sum;++i) cout&lt;&lt;node[i].son[0]&lt;&lt;&quot; &quot;&lt;&lt;node[i].son[1]&lt;&lt;&quot; &quot;&lt;&lt;node[i].val&lt;&lt;&quot; &quot;&lt;&lt;node[i].pri&lt;&lt;&quot; &quot;&lt;&lt;node[i].cnt&lt;&lt;&quot; &quot;&lt;&lt;node[i].siz&lt;&lt;endl; cout&lt;&lt;&quot;---------------------&quot;&lt;&lt;endl; } inline void ins(int k) {ins_(root,k);} inline void del(int k) {del_(root,k);} inline int rank(int k) { int x=root; int tmp=0; while(x) { if(k==node[x].val) return tmp+node[node[x].lson_].siz+1; else if(k&lt;node[x].val) x=node[x].lson_; else tmp+=node[node[x].lson_].siz+node[x].cnt,x=node[x].rson_; } return tmp; } inline int kth(int k) { int x=root; while(x) { if(node[node[x].lson_].siz&lt;k&amp;&amp;node[node[x].lson_].siz+node[x].cnt&gt;=k) return node[x].val; if(node[node[x].lson_].siz&gt;=k) x=node[x].lson_; else k-=node[node[x].lson_].siz+node[x].cnt,x=node[x].rson_; } return 0; } inline int pre(int k) {return near(k,0);} inline int suc(int k) {return near(k,1);} treap() {inf_=1000000007,sum=root=0;} #undef lson_ #undef rson_ }trp; ","link":"https://imzzy1201.github.io/post/1y_vHr2_t/"},{"title":"å‹æƒ…é“¾æ¥","content":" Some people come to you in your life, to make you know that you are such an easy target. dalao ä»¬ Clever_Jimmy\\textsf\\color{black}C\\color{red}lever\\_JimmyClever_Jimmy FZzzz\\textsf\\color{black}F\\color{red}ZzzzFZzzz xiong_6\\textsf\\color{black}x\\color{red}iong\\_6xiong_6 lzc\\textsf\\color{black}l\\color{red}zclzc xzx\\textsf\\color{black}x\\color{red}zxxzx Polaris_Dane\\textsf\\color{black}P\\color{red}olaris\\_DanePolaris_Dane å¥½ç”¨çš„ç½‘å€ä»¬ OEISï¼ˆæ•°åˆ—æ‰¾è§„å¾‹ï¼‰ NumberEmpireï¼ˆæ•°å­—æ€§è´¨ï¼‰ WolframAlphaï¼ˆæ•°å­¦å·¥å…·ï¼‰ LaTeX\\LaTeXLATEâ€‹X ç´¢å¼• tool.luï¼ˆåœ¨çº¿å·¥å…·ï¼‰ Chrome Extension CRX Downloaderï¼ˆChrome Web Store æ’ä»¶ä¸‹è½½å™¨ï¼‰ ","link":"https://imzzy1201.github.io/post/friends/"},{"title":"åšå®¢æ­å»ºè¯´æ˜","content":" All roads lead to Rome. Yet, some people have been living there ever since they were born. Gridea ğŸ‘ æ¬¢è¿ä½¿ç”¨ Gridea ï¼ âœï¸ Gridea ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ... Github Gridea ä¸»é¡µ ç¤ºä¾‹ç½‘ç«™ ç‰¹æ€§ğŸ‘‡ ğŸ“ ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ Markdown è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ ğŸŒ‰ ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡ ğŸ·ï¸ ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„ ğŸ“‹ ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå• ğŸ’» ä½ å¯ä»¥åœ¨ Windowsï¼ŒMacOS æˆ– Linux è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯ ğŸŒ ä½ å¯ä»¥ä½¿ç”¨ ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ æˆ– Coding Pages å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å° ğŸ’¬ ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ Gitalk æˆ– DisqusJS è¯„è®ºç³»ç»Ÿ ğŸ‡¬ğŸ‡§ ä½ å¯ä»¥ä½¿ç”¨ä¸­æ–‡ç®€ä½“æˆ–è‹±è¯­ ğŸŒ ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ› ğŸ–¥ ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥ ğŸŒ± å½“ç„¶ Gridea è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´ å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼ ğŸ˜˜ Enjoy~ å¼ºçƒˆå®‰åˆ© Grideaï¼ç¡®å®ååˆ†å¥½ç”¨ï¼ŒåŸå› å¦‚ä¸‹ï¼š é¦–å…ˆï¼ŒGridea å¼€æºã€å®‰å…¨ã€å…è´¹ã€æ— æ†ç»‘å¹¿å‘Šï¼Œæœ‰æ¸…æ–°çš„å›¾å½¢ç•Œé¢å’Œç®€æ˜“çš„å®‰è£…æ–¹å¼ï¼Œéƒ¨ç½²åˆ° GitHub Pages ä¸Šåªé¡»è¦è¿›è¡Œç®€å•çš„å‡ æ­¥é…ç½®ï¼Œæ¯”èµ· Hexo ç­‰çš„å‘½ä»¤è¡Œæ“ä½œåŠç¹æ‚çš„å®‰è£…è¿‡ç¨‹å’Œéƒ¨ç½²è¿‡ç¨‹ï¼Œæ˜¾å¾—å®¹æ˜“ä¸Šæ‰‹è®¸å¤šã€‚åœ¨éƒ¨ç½²ä¸Šï¼ŒGridea ä»…é¡»ç”¨æˆ· GitHub è´¦æˆ·åŠå¯†ç ï¼Œå³å¯éƒ¨ç½²è‡³ GitHub Pagesï¼Œæ¯”é…ç½® SSH æ›´ä¸ºæ–¹ä¾¿ï¼›ä»…é¡»ç®€å•çš„å‡ æ­¥å°±å¯ä»¥å®Œæˆ Gitalk çš„é…ç½®ï¼›å¯å®ç°éšèº«æºå¸¦ã€ç¼–è¾‘å’ŒåŒæ­¥ Gridea è¿˜è‡ªå¸¦ markdown + tex å…¬å¼ç¼–è¾‘å™¨ï¼Œæ— é¡»ä½¿ç”¨å…¶å®ƒç¼–è¾‘å™¨å³å¯å®Œæˆå¤§éƒ¨åˆ†ç¼–è¾‘å·¥ä½œ Gridea äº¦å¯è·¨å¹³å°æ“ä½œï¼Œå¯¹äºæˆ‘è¿™ç§åŒç³»ç»Ÿå…šè¾ƒä¸ºä¾¿æ· Gridea çš„ç¼ºç‚¹ï¼š ç›®å‰ç°æœ‰çš„ä¸»é¢˜è¿˜æ˜¯è¾ƒå°‘ï¼Œä¸ Hexo å’Œ Jekyll ç­‰è¿˜æ˜¯ä¸å¯åŒæ—¥è€Œè¯­ åŒæ­¥çš„é€Ÿåº¦æœ‰å¾…æé«˜ ä¸»é¢˜ æœ¬ç«™é‡‡ç”¨äº† ITJoker233 å¤§ç‰›ä» Hexo ä¸­ç§»æ¤åˆ° Gridea çš„ Chic ä¸»é¢˜ï¼Œåšäº†ä¸€äº›å°ä¿®æ”¹ åšå®¢æ­å»ºæ•™ç¨‹ æ³¨å†Œä¸€ä¸ª GitHub è´¦å·ï¼ˆä¸è¯¦è®²ï¼‰ æ¥åˆ° New Repository ç•Œé¢ åœ¨ &quot;Repository name&quot; ä¸‹å¡«å†™ [ä½ çš„ç”¨æˆ·å].github.io æ¯”å¦‚æˆ‘çš„ç”¨æˆ·åä¸º imzzy1201ï¼Œåˆ™æˆ‘åº”å¡«å†™ imzzy1201.github.io æ³¨æ„è¿™è®²æˆä¸ºå°†æ¥ä½ çš„ GitHub Pages çš„åœ°å€ ç„¶å &quot;Create repository&quot; ç°åœ¨è½¬åˆ° https://github.com/[ä½ çš„ç”¨æˆ·å]/[ä½ çš„ç”¨æˆ·å].github.io/settings ä¸‹æ‹‰åˆ° &quot;GitHub Pages&quot; ä¸€æ ï¼Œä½ ä¼šçœ‹åˆ°ï¼š âœ”ï¸ Your site is published at https://[ä½ çš„ç”¨æˆ·å].github.io/\\small\\textsf{\\color{green}Your site is published at \\color{blue}https://[ä½ çš„ç”¨æˆ·å].github.io/}Your site is published at https://[ä½ çš„ç”¨æˆ·å].github.io/ è¿™å°±è¯´æ˜ä½ çš„ &quot;GitHub Pages&quot; è®¾ç½®æˆåŠŸäº†ã€‚ ç°åœ¨ä¸‹è½½æŸ Gridea å¹¶å®‰è£…ï¼ˆå®‰è£…é»˜è®¤é€‰é¡¹å®‰è£…å³å¯ï¼‰ æ‰“å¼€å®ƒï¼Œå†é¡µé¢å·¦ä¸‹è§’æœ‰ä¸ªé€‰é¡¹æ ï¼Œé‡Œé¢å¯ä»¥è‡ªå·±è®¾ç½®è¯­è¨€å’Œç«™ç‚¹æºæ–‡ä»¶ä½ç½®ï¼Œå»ºè®®è®°ä¸‹æ¥ä½ çš„ç«™ç‚¹æºæ–‡ä»¶ä½ç½®ï¼Œä»¥ä¾¿æŠ˜è…¾ä¸»é¢˜ä¹‹ç±»çš„ä¸œè¥¿ ç°åœ¨å¼€å§‹é…ç½®åŒæ­¥æœåŠ¡ åœ¨åŸŸåä¸­é€‰æ‹© &quot;https://&quot;ï¼Œç„¶åå¡«å…¥ [ä½ çš„ç”¨æˆ·å].github.io/ ä»“åº“åç§°å¡« [ä½ çš„ç”¨æˆ·å].github.io åˆ†æ”¯å¡« master ä»“åº“ç”¨æˆ·åå¡« [ä½ çš„ç”¨æˆ·å] é‚®ç®±å¡«ä½ ç”¨æ¥æ³¨å†Œ GitHub çš„é‚£ä¸ªé‚®ç®± ä»¤ç‰Œå¡«ä½  GitHub çš„å¯†ç  ä¿å­˜åï¼Œç‚¹æ£€æµ‹è¿œç¨‹è¿æ¥ï¼Œå¦‚æœä¸Šæ–¹å‡ºç°ï¼š âœ”ï¸ è¿œç¨‹è¿æ¥æˆåŠŸ åˆ™è¯´æ˜ä½ çš„åšå®¢å·²ç»é…ç½®å¥½äº† ç°åœ¨ç‚¹å·¦ä¸‹è§’çš„ &quot;åŒæ­¥&quot;ï¼Œç­‰å¾…å®ƒæç¤º &quot;åŒæ­¥æˆåŠŸ&quot; åï¼Œå†åœ¨æµè§ˆå™¨æ‰“å¼€ [ä½ çš„ç”¨æˆ·å].github.ioï¼Œå°±ä¼šå‘ç° Gridea é¢„ç½®çš„ä¸»é¢˜å’Œæ–‡ç« å·²ç»ä¸Šä¼ åˆ°äº†ä½ çš„ GitHub Pages ä¸Šäº† å¦‚æœéœ€è¦æ”¹ä¸»é¢˜å¯ä»¥å°†ä½ çš„ä¸»é¢˜æ”¾åœ¨ [ä½ çš„ç«™ç‚¹æºæ–‡ä»¶è·¯å¾„]/themes/ï¼Œç„¶åé‡å¯ Gridea å³å¯åœ¨â€œä¸»é¢˜â€ä¸€æ æ‰¾åˆ°ä½ çš„æ–°ä¸»é¢˜äº†ã€‚ ","link":"https://imzzy1201.github.io/post/myblog/"},{"title":"æ¿å­","content":" ä¸€ä¸ªå‹è¡Œç‹‚äººæ˜¯ä»ä¸å—é™äºç é£çš„ #include&lt;bits/stdc++.h&gt; namespace P_TEMPLATE{ #define endl '\\n' #define ccf std::cout&lt;&lt;&quot;f**k&quot;&lt;&lt;endl #define rgi register int #define ll long long class fastin{private:int _ch,_f; public:inline fastin&amp;operator&gt;&gt;(char&amp;c){c=getchar();return*this;} template&lt;typename _Tp&gt;inline fastin&amp;operator&gt;&gt;(_Tp&amp;_x){ _x=0;while(!isdigit(_ch))_f|=(_ch==45),_ch=getchar(); while(isdigit(_ch))_x=(_x&lt;&lt;1)+(_x&lt;&lt;3)+(_ch^48),_ch=getchar(); _f&amp;&amp;(_x=-_x,_f=0);return*this;}fastin(){_ch=_f=0;} }fin;class fastout{private:int _num[32],_head; public:inline fastout&amp;operator&lt;&lt;(char c){putchar(c);return*this;} template&lt;typename _Tp&gt; inline fastout&amp;operator&lt;&lt;(_Tp _x){ _Tp _k;if(_x==0){putchar('0');return *this;}if(_x&lt;0)putchar('-'),_x=-_x; while(_x&gt;0)_k=_x/10,++_head,_num[_head]=(_x-(_k&lt;&lt;1)-(_k&lt;&lt;3))^48,_x=_k; while(_head&gt;0)putchar(_num[_head]),--_head;return*this;}fastout(){_head=0;} }fout;inline void P_INIT(){ #ifdef D_STDOUT_UNBUFFERED setbuf(stdout,NULL); #endif }}using namespace P_TEMPLATE; // ---------------------------- // #define int ll // using namespace std; const int maxn=1000004; const int mod=1000000007,inf=1201201201; signed main() {P_INIT(); return 0; } // ---------------------------- // by imzzy ","link":"https://imzzy1201.github.io/post/bNfwKgoRt/"}]}